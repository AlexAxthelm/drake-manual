<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>The drake R Package User Manual</title>
  <meta name="description" content="The drake R Package User Manual">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="The drake R Package User Manual" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="The drake R Package User Manual" />
  
  
  

<meta name="author" content="Will Landau, Kirill Müller, Alex Axthelm, Jasper Clarkberg, Lorenz Walthert">
<meta name="author" content="Copyright Eli Lilly and Company">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="store.html">
<link rel="next" href="triggers.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.4/visNetwork.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/sankey-1/sankey.js"></script>
<script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-drake-r-package"><i class="fa fa-check"></i><b>1.1</b> The drake R package</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#why-drake"><i class="fa fa-check"></i><b>1.3</b> Why drake?</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#what-gets-done-stays-done."><i class="fa fa-check"></i><b>1.3.1</b> What gets done stays done.</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#reproducibility-with-confidence"><i class="fa fa-check"></i><b>1.3.2</b> Reproducibility with confidence</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#aggressively-scale-up."><i class="fa fa-check"></i><b>1.3.3</b> Aggressively scale up.</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#documentation"><i class="fa fa-check"></i><b>1.4</b> Documentation</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#cheat-sheet"><i class="fa fa-check"></i><b>1.4.1</b> Cheat sheet</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#frequently-asked-questions"><i class="fa fa-check"></i><b>1.4.2</b> Frequently asked questions</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#function-reference"><i class="fa fa-check"></i><b>1.4.3</b> Function reference</a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#tutorials"><i class="fa fa-check"></i><b>1.4.4</b> Tutorials</a></li>
<li class="chapter" data-level="1.4.5" data-path="index.html"><a href="index.html#examples"><i class="fa fa-check"></i><b>1.4.5</b> Examples</a></li>
<li class="chapter" data-level="1.4.6" data-path="index.html"><a href="index.html#presentations"><i class="fa fa-check"></i><b>1.4.6</b> Presentations</a></li>
<li class="chapter" data-level="1.4.7" data-path="index.html"><a href="index.html#real-example-projects"><i class="fa fa-check"></i><b>1.4.7</b> Real example projects</a></li>
<li class="chapter" data-level="1.4.8" data-path="index.html"><a href="index.html#context-and-history"><i class="fa fa-check"></i><b>1.4.8</b> Context and history</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#help-and-troubleshooting"><i class="fa fa-check"></i><b>1.5</b> Help and troubleshooting</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#similar-work"><i class="fa fa-check"></i><b>1.6</b> Similar work</a><ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#gnu-make"><i class="fa fa-check"></i><b>1.6.1</b> GNU Make</a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#remake"><i class="fa fa-check"></i><b>1.6.2</b> Remake</a></li>
<li class="chapter" data-level="1.6.3" data-path="index.html"><a href="index.html#memoise"><i class="fa fa-check"></i><b>1.6.3</b> Memoise</a></li>
<li class="chapter" data-level="1.6.4" data-path="index.html"><a href="index.html#knitr-and-r-markdown"><i class="fa fa-check"></i><b>1.6.4</b> Knitr and R Markdown</a></li>
<li class="chapter" data-level="1.6.5" data-path="index.html"><a href="index.html#factuals-drake"><i class="fa fa-check"></i><b>1.6.5</b> Factual’s Drake</a></li>
<li class="chapter" data-level="1.6.6" data-path="index.html"><a href="index.html#other-pipeline-toolkits"><i class="fa fa-check"></i><b>1.6.6</b> Other pipeline toolkits</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.7</b> Acknowledgements</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="caution.html"><a href="caution.html"><i class="fa fa-check"></i><b>A</b> Cautionary notes</a><ul>
<li class="chapter" data-level="A.1" data-path="caution.html"><a href="caution.html#projects-built-with-drake-4.4.0-are-not-back-compatible-with-drake-4.4.0."><i class="fa fa-check"></i><b>A.1</b> Projects built with drake &lt;= 4.4.0 are not back compatible with drake &gt; 4.4.0.</a></li>
<li class="chapter" data-level="A.2" data-path="caution.html"><a href="caution.html#workflow-plans"><i class="fa fa-check"></i><b>A.2</b> Workflow plans</a><ul>
<li class="chapter" data-level="A.2.1" data-path="caution.html"><a href="caution.html#externalizing-commands-in-r-script-files"><i class="fa fa-check"></i><b>A.2.1</b> Externalizing commands in R script files</a></li>
<li class="chapter" data-level="A.2.2" data-path="caution.html"><a href="caution.html#commands-are-not-perfectly-flexible."><i class="fa fa-check"></i><b>A.2.2</b> Commands are NOT perfectly flexible.</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="caution.html"><a href="caution.html#execution"><i class="fa fa-check"></i><b>A.3</b> Execution</a><ul>
<li class="chapter" data-level="A.3.1" data-path="caution.html"><a href="caution.html#install-drake-properly."><i class="fa fa-check"></i><b>A.3.1</b> Install <code>drake</code> properly.</a></li>
<li class="chapter" data-level="A.3.2" data-path="caution.html"><a href="caution.html#install-all-your-packages."><i class="fa fa-check"></i><b>A.3.2</b> Install all your packages.</a></li>
<li class="chapter" data-level="A.3.3" data-path="caution.html"><a href="caution.html#a-note-on-tidy-evaluation"><i class="fa fa-check"></i><b>A.3.3</b> A note on tidy evaluation</a></li>
<li class="chapter" data-level="A.3.4" data-path="caution.html"><a href="caution.html#find-and-diagnose-your-errors."><i class="fa fa-check"></i><b>A.3.4</b> Find and diagnose your errors.</a></li>
<li class="chapter" data-level="A.3.5" data-path="caution.html"><a href="caution.html#refresh-the-drake_config-list-early-and-often."><i class="fa fa-check"></i><b>A.3.5</b> Refresh the <code>drake_config()</code> list early and often.</a></li>
<li class="chapter" data-level="A.3.6" data-path="caution.html"><a href="caution.html#workflows-as-r-packages."><i class="fa fa-check"></i><b>A.3.6</b> Workflows as R packages.</a></li>
<li class="chapter" data-level="A.3.7" data-path="caution.html"><a href="caution.html#the-lazy_load-flag-does-not-work-with-parlapply-parallelism."><i class="fa fa-check"></i><b>A.3.7</b> The <code>lazy_load</code> flag does not work with <code>&quot;parLapply&quot;</code> parallelism.</a></li>
<li class="chapter" data-level="A.3.8" data-path="caution.html"><a href="caution.html#timeouts-may-be-unreliable."><i class="fa fa-check"></i><b>A.3.8</b> Timeouts may be unreliable.</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="caution.html"><a href="caution.html#dependencies"><i class="fa fa-check"></i><b>A.4</b> Dependencies</a><ul>
<li class="chapter" data-level="A.4.1" data-path="caution.html"><a href="caution.html#objects-that-contain-functions-may-rebuild-too-often"><i class="fa fa-check"></i><b>A.4.1</b> Objects that contain functions may rebuild too often</a></li>
<li class="chapter" data-level="A.4.2" data-path="caution.html"><a href="caution.html#the-magrittr-dot-.-is-always-ignored."><i class="fa fa-check"></i><b>A.4.2</b> The <code>magrittr</code> dot (<code>.</code>) is always ignored.</a></li>
<li class="chapter" data-level="A.4.3" data-path="caution.html"><a href="caution.html#dependencies-are-not-tracked-in-some-edge-cases."><i class="fa fa-check"></i><b>A.4.3</b> Dependencies are not tracked in some edge cases.</a></li>
<li class="chapter" data-level="A.4.4" data-path="caution.html"><a href="caution.html#dependencies-of-knitr-reports"><i class="fa fa-check"></i><b>A.4.4</b> Dependencies of <code>knitr</code> reports</a></li>
<li class="chapter" data-level="A.4.5" data-path="caution.html"><a href="caution.html#file-outputs-in-imported-functions."><i class="fa fa-check"></i><b>A.4.5</b> File outputs in imported functions.</a></li>
<li class="chapter" data-level="A.4.6" data-path="caution.html"><a href="caution.html#functions-produced-by-vectorize"><i class="fa fa-check"></i><b>A.4.6</b> Functions produced by <code>Vectorize()</code></a></li>
<li class="chapter" data-level="A.4.7" data-path="caution.html"><a href="caution.html#compiled-code-is-not-reproducibly-tracked."><i class="fa fa-check"></i><b>A.4.7</b> Compiled code is not reproducibly tracked.</a></li>
<li class="chapter" data-level="A.4.8" data-path="caution.html"><a href="caution.html#directories-folders-are-not-reproducibly-tracked."><i class="fa fa-check"></i><b>A.4.8</b> Directories (folders) are not reproducibly tracked.</a></li>
<li class="chapter" data-level="A.4.9" data-path="caution.html"><a href="caution.html#packages-are-not-tracked-as-dependencies."><i class="fa fa-check"></i><b>A.4.9</b> Packages are not tracked as dependencies.</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="caution.html"><a href="caution.html#high-performance-computing"><i class="fa fa-check"></i><b>A.5</b> High-performance computing</a><ul>
<li class="chapter" data-level="A.5.1" data-path="caution.html"><a href="caution.html#the-practical-utility-of-parallel-computing"><i class="fa fa-check"></i><b>A.5.1</b> The practical utility of parallel computing</a></li>
<li class="chapter" data-level="A.5.2" data-path="caution.html"><a href="caution.html#maximum-number-of-simultaneous-jobs"><i class="fa fa-check"></i><b>A.5.2</b> Maximum number of simultaneous jobs</a></li>
<li class="chapter" data-level="A.5.3" data-path="caution.html"><a href="caution.html#parallel-computing-on-windows"><i class="fa fa-check"></i><b>A.5.3</b> Parallel computing on Windows</a></li>
<li class="chapter" data-level="A.5.4" data-path="caution.html"><a href="caution.html#configuring-futurebatchtools-parallelism-for-clusters"><i class="fa fa-check"></i><b>A.5.4</b> Configuring <a href="https://github.com/HenrikBengtsson/future">future</a>/<a href="https://github.com/mllg/batchtools">batchtools</a> parallelism for clusters</a></li>
<li class="chapter" data-level="A.5.5" data-path="caution.html"><a href="caution.html#proper-makefiles-are-not-standalone."><i class="fa fa-check"></i><b>A.5.5</b> Proper Makefiles are not standalone.</a></li>
<li class="chapter" data-level="A.5.6" data-path="caution.html"><a href="caution.html#makefile-level-parallelism-for-imported-objects-and-files"><i class="fa fa-check"></i><b>A.5.6</b> Makefile-level parallelism for imported objects and files</a></li>
<li class="chapter" data-level="A.5.7" data-path="caution.html"><a href="caution.html#zombie-processes"><i class="fa fa-check"></i><b>A.5.7</b> Zombie processes</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="caution.html"><a href="caution.html#storage"><i class="fa fa-check"></i><b>A.6</b> Storage</a><ul>
<li class="chapter" data-level="A.6.1" data-path="caution.html"><a href="caution.html#projects-hosted-on-dropbox-and-similar-platforms"><i class="fa fa-check"></i><b>A.6.1</b> Projects hosted on Dropbox and similar platforms</a></li>
<li class="chapter" data-level="A.6.2" data-path="caution.html"><a href="caution.html#cache-customization-is-limited"><i class="fa fa-check"></i><b>A.6.2</b> Cache customization is limited</a></li>
<li class="chapter" data-level="A.6.3" data-path="caution.html"><a href="caution.html#runtime-predictions"><i class="fa fa-check"></i><b>A.6.3</b> Runtime predictions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="debug.html"><a href="debug.html"><i class="fa fa-check"></i><b>B</b> Debugging and testing drake projects</a><ul>
<li class="chapter" data-level="B.1" data-path="debug.html"><a href="debug.html#dependencies-1"><i class="fa fa-check"></i><b>B.1</b> Dependencies</a><ul>
<li class="chapter" data-level="B.1.1" data-path="debug.html"><a href="debug.html#visualize-your-dependency-graph."><i class="fa fa-check"></i><b>B.1.1</b> Visualize your dependency graph.</a></li>
<li class="chapter" data-level="B.1.2" data-path="debug.html"><a href="debug.html#check-specific-dependency-information."><i class="fa fa-check"></i><b>B.1.2</b> Check specific dependency information.</a></li>
<li class="chapter" data-level="B.1.3" data-path="debug.html"><a href="debug.html#outdated-targets-and-missing-dependencies"><i class="fa fa-check"></i><b>B.1.3</b> Outdated targets and missing dependencies</a></li>
<li class="chapter" data-level="B.1.4" data-path="debug.html"><a href="debug.html#but-why-are-my-targets-out-of-date"><i class="fa fa-check"></i><b>B.1.4</b> But <em>why</em> are my targets out of date?</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="debug.html"><a href="debug.html#diagnose-failures."><i class="fa fa-check"></i><b>B.2</b> Diagnose failures.</a></li>
<li class="chapter" data-level="B.3" data-path="debug.html"><a href="debug.html#timeouts-and-retries"><i class="fa fa-check"></i><b>B.3</b> Timeouts and retries</a></li>
<li class="chapter" data-level="B.4" data-path="debug.html"><a href="debug.html#consider-hasty-mode"><i class="fa fa-check"></i><b>B.4</b> Consider hasty mode</a></li>
<li class="chapter" data-level="B.5" data-path="debug.html"><a href="debug.html#more-help"><i class="fa fa-check"></i><b>B.5</b> More help</a></li>
</ul></li>
<li class="part"><span><b>I Examples</b></span></li>
<li class="chapter" data-level="C" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>C</b> Frequently-asked questions</a></li>
<li class="part"><span><b>II Functionality</b></span></li>
<li class="chapter" data-level="D" data-path="gsp.html"><a href="gsp.html"><i class="fa fa-check"></i><b>D</b> Finding the best model of gross state product</a><ul>
<li class="chapter" data-level="D.1" data-path="gsp.html"><a href="gsp.html#get-the-code."><i class="fa fa-check"></i><b>D.1</b> Get the code.</a></li>
<li class="chapter" data-level="D.2" data-path="gsp.html"><a href="gsp.html#objective-and-methods"><i class="fa fa-check"></i><b>D.2</b> Objective and methods</a></li>
<li class="chapter" data-level="D.3" data-path="gsp.html"><a href="gsp.html#data"><i class="fa fa-check"></i><b>D.3</b> Data</a></li>
<li class="chapter" data-level="D.4" data-path="gsp.html"><a href="gsp.html#analysis"><i class="fa fa-check"></i><b>D.4</b> Analysis</a></li>
<li class="chapter" data-level="D.5" data-path="gsp.html"><a href="gsp.html#results"><i class="fa fa-check"></i><b>D.5</b> Results</a></li>
<li class="chapter" data-level="D.6" data-path="gsp.html"><a href="gsp.html#comparison-with-gnu-make"><i class="fa fa-check"></i><b>D.6</b> Comparison with GNU Make</a></li>
<li class="chapter" data-level="D.7" data-path="gsp.html"><a href="gsp.html#references"><i class="fa fa-check"></i><b>D.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="hpc.html"><a href="hpc.html"><i class="fa fa-check"></i><b>E</b> High-performance computing with drake</a><ul>
<li class="chapter" data-level="E.1" data-path="hpc.html"><a href="hpc.html#batch-mode-for-long-workflows"><i class="fa fa-check"></i><b>E.1</b> Batch mode for long workflows</a></li>
<li class="chapter" data-level="E.2" data-path="hpc.html"><a href="hpc.html#let-drake-schedule-your-targets."><i class="fa fa-check"></i><b>E.2</b> Let drake schedule your targets.</a></li>
<li class="chapter" data-level="E.3" data-path="hpc.html"><a href="hpc.html#parallel-backends"><i class="fa fa-check"></i><b>E.3</b> Parallel backends</a></li>
<li class="chapter" data-level="E.4" data-path="hpc.html"><a href="hpc.html#local-workers"><i class="fa fa-check"></i><b>E.4</b> Local workers</a></li>
<li class="chapter" data-level="E.5" data-path="hpc.html"><a href="hpc.html#remote-workers"><i class="fa fa-check"></i><b>E.5</b> Remote workers</a><ul>
<li class="chapter" data-level="E.5.1" data-path="hpc.html"><a href="hpc.html#clustermq-clustermq_staged-and-hasty"><i class="fa fa-check"></i><b>E.5.1</b> <code>&quot;clustermq&quot;</code>, <code>&quot;clustermq_staged&quot;</code>, and <code>&quot;hasty&quot;</code></a></li>
<li class="chapter" data-level="E.5.2" data-path="hpc.html"><a href="hpc.html#future-future_lapply-and-future_lapply_staged"><i class="fa fa-check"></i><b>E.5.2</b> <code>&quot;future&quot;</code>, <code>&quot;future_lapply&quot;</code>, and <code>&quot;future_lapply_staged&quot;</code></a></li>
<li class="chapter" data-level="E.5.3" data-path="hpc.html"><a href="hpc.html#makefile"><i class="fa fa-check"></i><b>E.5.3</b> <code>&quot;Makefile&quot;</code></a></li>
</ul></li>
<li class="chapter" data-level="E.6" data-path="hpc.html"><a href="hpc.html#scheduling-algorithms"><i class="fa fa-check"></i><b>E.6</b> Scheduling algorithms</a><ul>
<li class="chapter" data-level="E.6.1" data-path="hpc.html"><a href="hpc.html#persistent-scheduling"><i class="fa fa-check"></i><b>E.6.1</b> Persistent scheduling</a></li>
<li class="chapter" data-level="E.6.2" data-path="hpc.html"><a href="hpc.html#transient-scheduling"><i class="fa fa-check"></i><b>E.6.2</b> Transient scheduling</a></li>
<li class="chapter" data-level="E.6.3" data-path="hpc.html"><a href="hpc.html#staged-scheduling"><i class="fa fa-check"></i><b>E.6.3</b> Staged scheduling</a></li>
</ul></li>
<li class="chapter" data-level="E.7" data-path="hpc.html"><a href="hpc.html#final-thoughts"><i class="fa fa-check"></i><b>E.7</b> Final thoughts</a><ul>
<li class="chapter" data-level="E.7.1" data-path="hpc.html"><a href="hpc.html#debugging"><i class="fa fa-check"></i><b>E.7.1</b> Debugging</a></li>
<li class="chapter" data-level="E.7.2" data-path="hpc.html"><a href="hpc.html#drake-as-an-ordinary-job-scheduler"><i class="fa fa-check"></i><b>E.7.2</b> Drake as an ordinary job scheduler</a></li>
<li class="chapter" data-level="E.7.3" data-path="hpc.html"><a href="hpc.html#more-resources"><i class="fa fa-check"></i><b>E.7.3</b> More resources</a></li>
</ul></li>
<li class="chapter" data-level="E.8" data-path="hpc.html"><a href="hpc.html#footnotes"><i class="fa fa-check"></i><b>E.8</b> Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="main.html"><a href="main.html"><i class="fa fa-check"></i><b>F</b> The main example</a><ul>
<li class="chapter" data-level="F.1" data-path="main.html"><a href="main.html#set-the-stage."><i class="fa fa-check"></i><b>F.1</b> Set the stage.</a></li>
<li class="chapter" data-level="F.2" data-path="main.html"><a href="main.html#make-your-results."><i class="fa fa-check"></i><b>F.2</b> Make your results.</a></li>
<li class="chapter" data-level="F.3" data-path="main.html"><a href="main.html#go-back-and-fix-things."><i class="fa fa-check"></i><b>F.3</b> Go back and fix things.</a></li>
<li class="chapter" data-level="F.4" data-path="main.html"><a href="main.html#try-it-yourself"><i class="fa fa-check"></i><b>F.4</b> Try it yourself!</a></li>
</ul></li>
<li class="chapter" data-level="G" data-path="mtcars.html"><a href="mtcars.html"><i class="fa fa-check"></i><b>G</b> The mtcars example and workflow plan generation</a><ul>
<li class="chapter" data-level="G.1" data-path="mtcars.html"><a href="mtcars.html#get-the-code.-1"><i class="fa fa-check"></i><b>G.1</b> Get the code.</a></li>
<li class="chapter" data-level="G.2" data-path="mtcars.html"><a href="mtcars.html#quick-examples"><i class="fa fa-check"></i><b>G.2</b> Quick examples</a></li>
<li class="chapter" data-level="G.3" data-path="mtcars.html"><a href="mtcars.html#the-motivation-of-the-mtcars-example"><i class="fa fa-check"></i><b>G.3</b> The motivation of the mtcars example</a></li>
<li class="chapter" data-level="G.4" data-path="mtcars.html"><a href="mtcars.html#set-up-the-mtcars-example"><i class="fa fa-check"></i><b>G.4</b> Set up the mtcars example</a></li>
<li class="chapter" data-level="G.5" data-path="mtcars.html"><a href="mtcars.html#the-workflow-plan-data-frame"><i class="fa fa-check"></i><b>G.5</b> The workflow plan data frame</a></li>
<li class="chapter" data-level="G.6" data-path="mtcars.html"><a href="mtcars.html#generate-the-workflow-plan"><i class="fa fa-check"></i><b>G.6</b> Generate the workflow plan</a></li>
<li class="chapter" data-level="G.7" data-path="mtcars.html"><a href="mtcars.html#run-the-workflow"><i class="fa fa-check"></i><b>G.7</b> Run the workflow</a></li>
</ul></li>
<li class="chapter" data-level="H" data-path="organize.html"><a href="organize.html"><i class="fa fa-check"></i><b>H</b> How to organize the files of drake projects</a><ul>
<li class="chapter" data-level="H.1" data-path="organize.html"><a href="organize.html#examples-1"><i class="fa fa-check"></i><b>H.1</b> Examples</a></li>
<li class="chapter" data-level="H.2" data-path="organize.html"><a href="organize.html#where-do-you-put-your-code"><i class="fa fa-check"></i><b>H.2</b> Where do you put your code?</a></li>
<li class="chapter" data-level="H.3" data-path="organize.html"><a href="organize.html#your-commands-are-code-chunks-not-r-scripts"><i class="fa fa-check"></i><b>H.3</b> Your commands are code chunks, not R scripts</a></li>
<li class="chapter" data-level="H.4" data-path="organize.html"><a href="organize.html#workflows-as-r-packages"><i class="fa fa-check"></i><b>H.4</b> Workflows as R packages</a><ul>
<li class="chapter" data-level="H.4.1" data-path="organize.html"><a href="organize.html#advantages-of-putting-workflows-in-r-packages"><i class="fa fa-check"></i><b>H.4.1</b> Advantages of putting workflows in R packages</a></li>
<li class="chapter" data-level="H.4.2" data-path="organize.html"><a href="organize.html#the-problem"><i class="fa fa-check"></i><b>H.4.2</b> The problem</a></li>
<li class="chapter" data-level="H.4.3" data-path="organize.html"><a href="organize.html#the-solution"><i class="fa fa-check"></i><b>H.4.3</b> The solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="I" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>I</b> An analysis of R package download trends</a><ul>
<li class="chapter" data-level="I.1" data-path="packages.html"><a href="packages.html#get-the-code.-2"><i class="fa fa-check"></i><b>I.1</b> Get the code.</a></li>
<li class="chapter" data-level="I.2" data-path="packages.html"><a href="packages.html#overview"><i class="fa fa-check"></i><b>I.2</b> Overview</a></li>
<li class="chapter" data-level="I.3" data-path="packages.html"><a href="packages.html#analysis-1"><i class="fa fa-check"></i><b>I.3</b> Analysis</a></li>
<li class="chapter" data-level="I.4" data-path="packages.html"><a href="packages.html#other-ways-to-trigger-downloads"><i class="fa fa-check"></i><b>I.4</b> Other ways to trigger downloads</a></li>
</ul></li>
<li class="chapter" data-level="J" data-path="plans.html"><a href="plans.html"><i class="fa fa-check"></i><b>J</b> Workflow plan data frames</a><ul>
<li class="chapter" data-level="J.1" data-path="plans.html"><a href="plans.html#what-is-a-workflow-plan-data-frame"><i class="fa fa-check"></i><b>J.1</b> What is a workflow plan data frame?</a></li>
<li class="chapter" data-level="J.2" data-path="plans.html"><a href="plans.html#plans-are-like-r-scripts."><i class="fa fa-check"></i><b>J.2</b> Plans are like R scripts.</a></li>
<li class="chapter" data-level="J.3" data-path="plans.html"><a href="plans.html#so-why-do-we-use-plans"><i class="fa fa-check"></i><b>J.3</b> So why do we use plans?</a><ul>
<li class="chapter" data-level="J.3.1" data-path="plans.html"><a href="plans.html#you-can-skip-up-to-date-work."><i class="fa fa-check"></i><b>J.3.1</b> You can skip up-to-date work.</a></li>
<li class="chapter" data-level="J.3.2" data-path="plans.html"><a href="plans.html#data-frames-scale-well."><i class="fa fa-check"></i><b>J.3.2</b> Data frames scale well.</a></li>
<li class="chapter" data-level="J.3.3" data-path="plans.html"><a href="plans.html#you-do-not-need-to-worry-about-which-targets-run-first."><i class="fa fa-check"></i><b>J.3.3</b> You do not need to worry about which targets run first.</a></li>
</ul></li>
<li class="chapter" data-level="J.4" data-path="plans.html"><a href="plans.html#automatic-dependency-detection"><i class="fa fa-check"></i><b>J.4</b> Automatic dependency detection</a></li>
<li class="chapter" data-level="J.5" data-path="plans.html"><a href="plans.html#automatically-generating-workflow-plans"><i class="fa fa-check"></i><b>J.5</b> Automatically generating workflow plans</a><ul>
<li class="chapter" data-level="J.5.1" data-path="plans.html"><a href="plans.html#map_plan"><i class="fa fa-check"></i><b>J.5.1</b> <code>map_plan()</code></a></li>
<li class="chapter" data-level="J.5.2" data-path="plans.html"><a href="plans.html#wildcard-templating"><i class="fa fa-check"></i><b>J.5.2</b> Wildcard templating</a></li>
<li class="chapter" data-level="J.5.3" data-path="plans.html"><a href="plans.html#wildcard-clusters"><i class="fa fa-check"></i><b>J.5.3</b> Wildcard clusters</a></li>
<li class="chapter" data-level="J.5.4" data-path="plans.html"><a href="plans.html#specialized-wildcard-functionality"><i class="fa fa-check"></i><b>J.5.4</b> Specialized wildcard functionality</a></li>
<li class="chapter" data-level="J.5.5" data-path="plans.html"><a href="plans.html#non-wildcard-functions"><i class="fa fa-check"></i><b>J.5.5</b> Non-wildcard functions</a></li>
<li class="chapter" data-level="J.5.6" data-path="plans.html"><a href="plans.html#custom-metaprogramming"><i class="fa fa-check"></i><b>J.5.6</b> Custom metaprogramming</a></li>
</ul></li>
<li class="chapter" data-level="J.6" data-path="plans.html"><a href="plans.html#optional-columns-in-your-plan."><i class="fa fa-check"></i><b>J.6</b> Optional columns in your plan.</a></li>
</ul></li>
<li class="chapter" data-level="K" data-path="store.html"><a href="store.html"><i class="fa fa-check"></i><b>K</b> Storage</a><ul>
<li class="chapter" data-level="K.1" data-path="store.html"><a href="store.html#caches"><i class="fa fa-check"></i><b>K.1</b> Caches</a></li>
<li class="chapter" data-level="K.2" data-path="store.html"><a href="store.html#hash-algorithms"><i class="fa fa-check"></i><b>K.2</b> Hash algorithms</a></li>
<li class="chapter" data-level="K.3" data-path="store.html"><a href="store.html#which-hash-algorithm-should-you-choose"><i class="fa fa-check"></i><b>K.3</b> Which hash algorithm should you choose?</a></li>
<li class="chapter" data-level="K.4" data-path="store.html"><a href="store.html#select-the-hash-algorithms-of-the-cache"><i class="fa fa-check"></i><b>K.4</b> Select the hash algorithms of the cache</a></li>
<li class="chapter" data-level="K.5" data-path="store.html"><a href="store.html#using-storr-directly"><i class="fa fa-check"></i><b>K.5</b> Using <code>storr</code> directly</a></li>
<li class="chapter" data-level="K.6" data-path="store.html"><a href="store.html#cleaning-up"><i class="fa fa-check"></i><b>K.6</b> Cleaning up</a></li>
</ul></li>
<li class="chapter" data-level="L" data-path="time.html"><a href="time.html"><i class="fa fa-check"></i><b>L</b> Time: logging, prediction, and strategy</a><ul>
<li class="chapter" data-level="L.1" data-path="time.html"><a href="time.html#predict-total-runtime"><i class="fa fa-check"></i><b>L.1</b> Predict total runtime</a></li>
<li class="chapter" data-level="L.2" data-path="time.html"><a href="time.html#strategize-your-high-performance-computing"><i class="fa fa-check"></i><b>L.2</b> Strategize your high-performance computing</a></li>
</ul></li>
<li class="chapter" data-level="M" data-path="triggers.html"><a href="triggers.html"><i class="fa fa-check"></i><b>M</b> Triggers: decision rules for building targets</a><ul>
<li class="chapter" data-level="M.1" data-path="triggers.html"><a href="triggers.html#what-are-triggers"><i class="fa fa-check"></i><b>M.1</b> What are triggers?</a></li>
<li class="chapter" data-level="M.2" data-path="triggers.html"><a href="triggers.html#customization"><i class="fa fa-check"></i><b>M.2</b> Customization</a></li>
<li class="chapter" data-level="M.3" data-path="triggers.html"><a href="triggers.html#alternative-trigger-modes"><i class="fa fa-check"></i><b>M.3</b> Alternative trigger modes</a></li>
<li class="chapter" data-level="M.4" data-path="triggers.html"><a href="triggers.html#consider-hasty-mode-1"><i class="fa fa-check"></i><b>M.4</b> Consider hasty mode</a></li>
<li class="chapter" data-level="M.5" data-path="triggers.html"><a href="triggers.html#a-more-practical-example"><i class="fa fa-check"></i><b>M.5</b> A more practical example</a></li>
</ul></li>
<li class="chapter" data-level="N" data-path="vis.html"><a href="vis.html"><i class="fa fa-check"></i><b>N</b> Visualization with drake</a><ul>
<li class="chapter" data-level="N.0.1" data-path="vis.html"><a href="vis.html#vis_drake_graph"><i class="fa fa-check"></i><b>N.0.1</b> <code>vis_drake_graph()</code></a></li>
<li class="chapter" data-level="N.0.2" data-path="vis.html"><a href="vis.html#sankey_drake_graph"><i class="fa fa-check"></i><b>N.0.2</b> <code>sankey_drake_graph()</code></a></li>
<li class="chapter" data-level="N.0.3" data-path="vis.html"><a href="vis.html#drake_ggraph"><i class="fa fa-check"></i><b>N.0.3</b> <code>drake_ggraph()</code></a></li>
<li class="chapter" data-level="N.1" data-path="vis.html"><a href="vis.html#underlying-graph-data-node-and-edge-data-frames"><i class="fa fa-check"></i><b>N.1</b> Underlying graph data: node and edge data frames</a></li>
<li class="chapter" data-level="N.2" data-path="vis.html"><a href="vis.html#visualizing-target-status"><i class="fa fa-check"></i><b>N.2</b> Visualizing target status</a></li>
<li class="chapter" data-level="N.3" data-path="vis.html"><a href="vis.html#subgraphs"><i class="fa fa-check"></i><b>N.3</b> Subgraphs</a></li>
<li class="chapter" data-level="N.4" data-path="vis.html"><a href="vis.html#control-the-vis_drake_graph-legend."><i class="fa fa-check"></i><b>N.4</b> Control the <code>vis_drake_graph()</code> legend.</a></li>
<li class="chapter" data-level="N.5" data-path="vis.html"><a href="vis.html#clusters"><i class="fa fa-check"></i><b>N.5</b> Clusters</a></li>
<li class="chapter" data-level="N.6" data-path="vis.html"><a href="vis.html#output-files"><i class="fa fa-check"></i><b>N.6</b> Output files</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The drake R Package User Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="time" class="section level1">
<h1><span class="header-section-number">L</span> Time: logging, prediction, and strategy</h1>
<p>Thanks to <a href="https://github.com/dapperjapper">Jasper Clarkberg</a>, <code>drake</code> records how long it takes to build each target. For large projects that take hours or days to run, this feature becomes important for planning and execution.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb237-1" data-line-number="1"><span class="kw">library</span>(drake)</a>
<a class="sourceLine" id="cb237-2" data-line-number="2"><span class="kw">load_mtcars_example</span>() <span class="co"># Get the code with drake_example(&quot;mtcars&quot;).</span></a>
<a class="sourceLine" id="cb237-3" data-line-number="3"><span class="kw">make</span>(my_plan, <span class="dt">jobs =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb237-4" data-line-number="4"></a>
<a class="sourceLine" id="cb237-5" data-line-number="5"><span class="kw">build_times</span>(<span class="dt">digits =</span> <span class="dv">8</span>) <span class="co"># From the cache.</span></a>
<a class="sourceLine" id="cb237-6" data-line-number="6">## # A tibble: 21 x 5</a>
<a class="sourceLine" id="cb237-7" data-line-number="7">##    item                  type   elapsed        user          system       </a>
<a class="sourceLine" id="cb237-8" data-line-number="8">##  * &lt;chr&gt;                 &lt;chr&gt;  &lt;S4: Duration&gt; &lt;S4: Duratio&gt; &lt;S4: Duratio&gt;</a>
<a class="sourceLine" id="cb237-9" data-line-number="9">##  1 &quot;\&quot;report.md\&quot;&quot;       target 0.115s         0.096s        0.02s        </a>
<a class="sourceLine" id="cb237-10" data-line-number="10">##  2 &quot;\&quot;report.Rmd\&quot;&quot;      import 0.005s         0.008s        0s           </a>
<a class="sourceLine" id="cb237-11" data-line-number="11">##  3 coef_regression1_lar… target 0.024s         0.016s        0.004s       </a>
<a class="sourceLine" id="cb237-12" data-line-number="12">##  4 coef_regression1_sma… target 0.015s         0.016s        0s           </a>
<a class="sourceLine" id="cb237-13" data-line-number="13">##  5 coef_regression2_lar… target 0.023s         0.008s        0.008s       </a>
<a class="sourceLine" id="cb237-14" data-line-number="14">##  6 coef_regression2_sma… target 0.017s         0.016s        0.004s       </a>
<a class="sourceLine" id="cb237-15" data-line-number="15">##  7 large                 target 0.021s         0.012s        0.008s       </a>
<a class="sourceLine" id="cb237-16" data-line-number="16">##  8 random_rows           import 0.005s         0.004s        0s           </a>
<a class="sourceLine" id="cb237-17" data-line-number="17">##  9 reg1                  import 0.005s         0.004s        0s           </a>
<a class="sourceLine" id="cb237-18" data-line-number="18">## 10 reg2                  import 0.005s         0.004s        0s           </a>
<a class="sourceLine" id="cb237-19" data-line-number="19">## # ... with 11 more rows</a>
<a class="sourceLine" id="cb237-20" data-line-number="20"></a>
<a class="sourceLine" id="cb237-21" data-line-number="21">## `dplyr`-style `tidyselect` commands</a>
<a class="sourceLine" id="cb237-22" data-line-number="22"><span class="kw">build_times</span>(<span class="kw">starts_with</span>(<span class="st">&quot;coef&quot;</span>), <span class="dt">digits =</span> <span class="dv">8</span>)</a>
<a class="sourceLine" id="cb237-23" data-line-number="23">## # A tibble: 4 x 5</a>
<a class="sourceLine" id="cb237-24" data-line-number="24">##   item                   type   elapsed        user          system       </a>
<a class="sourceLine" id="cb237-25" data-line-number="25">## * &lt;chr&gt;                  &lt;chr&gt;  &lt;S4: Duration&gt; &lt;S4: Duratio&gt; &lt;S4: Duratio&gt;</a>
<a class="sourceLine" id="cb237-26" data-line-number="26">## 1 coef_regression1_large target 0.024s         0.016s        0.004s       </a>
<a class="sourceLine" id="cb237-27" data-line-number="27">## 2 coef_regression1_small target 0.015s         0.016s        0s           </a>
<a class="sourceLine" id="cb237-28" data-line-number="28">## 3 coef_regression2_large target 0.023s         0.008s        0.008s       </a>
<a class="sourceLine" id="cb237-29" data-line-number="29">## 4 coef_regression2_small target 0.017s         0.016s        0.004s</a>
<a class="sourceLine" id="cb237-30" data-line-number="30"></a>
<a class="sourceLine" id="cb237-31" data-line-number="31"><span class="kw">build_times</span>(<span class="dt">digits =</span> <span class="dv">8</span>, <span class="dt">targets_only =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb237-32" data-line-number="32">## # A tibble: 16 x 5</a>
<a class="sourceLine" id="cb237-33" data-line-number="33">##    item                  type   elapsed        user          system       </a>
<a class="sourceLine" id="cb237-34" data-line-number="34">##  * &lt;chr&gt;                 &lt;chr&gt;  &lt;S4: Duration&gt; &lt;S4: Duratio&gt; &lt;S4: Duratio&gt;</a>
<a class="sourceLine" id="cb237-35" data-line-number="35">##  1 &quot;\&quot;report.md\&quot;&quot;       target 0.115s         0.096s        0.02s        </a>
<a class="sourceLine" id="cb237-36" data-line-number="36">##  2 coef_regression1_lar… target 0.024s         0.016s        0.004s       </a>
<a class="sourceLine" id="cb237-37" data-line-number="37">##  3 coef_regression1_sma… target 0.015s         0.016s        0s           </a>
<a class="sourceLine" id="cb237-38" data-line-number="38">##  4 coef_regression2_lar… target 0.023s         0.008s        0.008s       </a>
<a class="sourceLine" id="cb237-39" data-line-number="39">##  5 coef_regression2_sma… target 0.017s         0.016s        0.004s       </a>
<a class="sourceLine" id="cb237-40" data-line-number="40">##  6 large                 target 0.021s         0.012s        0.008s       </a>
<a class="sourceLine" id="cb237-41" data-line-number="41">##  7 regression1_large     target 0.026s         0.02s         0.004s       </a>
<a class="sourceLine" id="cb237-42" data-line-number="42">##  8 regression1_small     target 0.036s         0.024s        0s           </a>
<a class="sourceLine" id="cb237-43" data-line-number="43">##  9 regression2_large     target 0.046s         0.012s        0.012s       </a>
<a class="sourceLine" id="cb237-44" data-line-number="44">## 10 regression2_small     target 0.029s         0.02s         0.008s       </a>
<a class="sourceLine" id="cb237-45" data-line-number="45">## 11 report                target 0.123s         0.104s        0.02s        </a>
<a class="sourceLine" id="cb237-46" data-line-number="46">## 12 small                 target 0.025s         0.016s        0.004s       </a>
<a class="sourceLine" id="cb237-47" data-line-number="47">## 13 summ_regression1_lar… target 0.027s         0.012s        0.016s       </a>
<a class="sourceLine" id="cb237-48" data-line-number="48">## 14 summ_regression1_sma… target 0.018s         0.012s        0.008s       </a>
<a class="sourceLine" id="cb237-49" data-line-number="49">## 15 summ_regression2_lar… target 0.017s         0.012s        0.004s       </a>
<a class="sourceLine" id="cb237-50" data-line-number="50">## 16 summ_regression2_sma… target 0.016s         0.004s        0.012s</a></code></pre></div>
<p>For <code>drake</code> version 4.1.0 and earlier, <code>build_times()</code> just measures the elapsed runtime of each command in <code>my_plan$command</code>. For later versions, the build times also account for all the internal operations in <code>drake:::build()</code>, such as <a href="store.html#store">storage and hashing</a>.</p>
<div id="predict-total-runtime" class="section level2">
<h2><span class="header-section-number">L.1</span> Predict total runtime</h2>
<p>Drake uses these times to predict the runtime of the next <code>make()</code>. At this moment, everything is up to date in the current example, so the next <code>make()</code> should be fast. Here, we only factor in the times of the formal targets in the workflow plan, excluding any imports.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" data-line-number="1">config &lt;-<span class="st"> </span><span class="kw">drake_config</span>(my_plan, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb238-2" data-line-number="2"><span class="kw">predict_runtime</span>(config, <span class="dt">targets_only =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb238-3" data-line-number="3">## [1] &quot;0s&quot;</a></code></pre></div>
<p>Suppose we change a dependency to make some targets out of date. Now, even though, the next <code>make()</code> should take a little longer.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb239-1" data-line-number="1">reg2 &lt;-<span class="st"> </span><span class="cf">function</span>(d){</a>
<a class="sourceLine" id="cb239-2" data-line-number="2">  d<span class="op">$</span>x3 &lt;-<span class="st"> </span>d<span class="op">$</span>x <span class="op">^</span><span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb239-3" data-line-number="3">  <span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x3, <span class="dt">data =</span> d)</a>
<a class="sourceLine" id="cb239-4" data-line-number="4">}</a>
<a class="sourceLine" id="cb239-5" data-line-number="5"></a>
<a class="sourceLine" id="cb239-6" data-line-number="6"><span class="kw">predict_runtime</span>(config, <span class="dt">targets_only =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb239-7" data-line-number="7">## [1] &quot;0s&quot;</a></code></pre></div>
<p>But what if you plan on starting from scratch next time, either after <code>clean()</code> or with <code>make(trigger = trigger(condition = TRUE))</code>?</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" data-line-number="1"><span class="kw">predict_runtime</span>(config, <span class="dt">from_scratch =</span> <span class="ot">TRUE</span>, <span class="dt">targets_only =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb240-2" data-line-number="2">## [1] &quot;0.463s&quot;</a></code></pre></div>
</div>
<div id="strategize-your-high-performance-computing" class="section level2">
<h2><span class="header-section-number">L.2</span> Strategize your high-performance computing</h2>
<p>Let’s say you are scaling up your workflow. You just put bigger data and heavier computation in your custom code, and the next time you run <code>make()</code>, your targets will take much longer to build. In fact, you estimate that every target except for your R Markdown report will take two hours to complete. Let’s write down these known times in seconds.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb241-1" data-line-number="1">known_times &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="kw">rep</span>(<span class="dv">7200</span>, <span class="kw">nrow</span>(my_plan) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb241-2" data-line-number="2"><span class="kw">names</span>(known_times) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">file_store</span>(<span class="st">&quot;report.md&quot;</span>), my_plan<span class="op">$</span>target[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb241-3" data-line-number="3">known_times</a>
<a class="sourceLine" id="cb241-4" data-line-number="4">##            &quot;report.md&quot;                  small                  large </a>
<a class="sourceLine" id="cb241-5" data-line-number="5">##                      5                   7200                   7200 </a>
<a class="sourceLine" id="cb241-6" data-line-number="6">##      regression1_small      regression1_large      regression2_small </a>
<a class="sourceLine" id="cb241-7" data-line-number="7">##                   7200                   7200                   7200 </a>
<a class="sourceLine" id="cb241-8" data-line-number="8">##      regression2_large summ_regression1_small summ_regression1_large </a>
<a class="sourceLine" id="cb241-9" data-line-number="9">##                   7200                   7200                   7200 </a>
<a class="sourceLine" id="cb241-10" data-line-number="10">## summ_regression2_small summ_regression2_large coef_regression1_small </a>
<a class="sourceLine" id="cb241-11" data-line-number="11">##                   7200                   7200                   7200 </a>
<a class="sourceLine" id="cb241-12" data-line-number="12">## coef_regression1_large coef_regression2_small coef_regression2_large </a>
<a class="sourceLine" id="cb241-13" data-line-number="13">##                   7200                   7200                   7200</a></code></pre></div>
<p>How many parallel jobs should you use in the next <code>make()</code>? The <code>predict_runtime()</code> function can help you decide. <code>predict_runtime(jobs = n)</code> simulates persistent parallel workers and reports the estimated total runtime of <code>make(jobs = n)</code>. (See also <code>predict_load_balancing()</code>.)</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" data-line-number="1">time &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb242-2" data-line-number="2"><span class="cf">for</span> (jobs <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>){</a>
<a class="sourceLine" id="cb242-3" data-line-number="3">  time[jobs] &lt;-<span class="st"> </span><span class="kw">predict_runtime</span>(</a>
<a class="sourceLine" id="cb242-4" data-line-number="4">    config,</a>
<a class="sourceLine" id="cb242-5" data-line-number="5">    <span class="dt">jobs =</span> jobs,</a>
<a class="sourceLine" id="cb242-6" data-line-number="6">    <span class="dt">from_scratch =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb242-7" data-line-number="7">    <span class="dt">known_times =</span> known_times</a>
<a class="sourceLine" id="cb242-8" data-line-number="8">  )</a>
<a class="sourceLine" id="cb242-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb242-10" data-line-number="10"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb242-11" data-line-number="11"><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">time =</span> time <span class="op">/</span><span class="st"> </span><span class="dv">3600</span>, <span class="dt">jobs =</span> <span class="kw">ordered</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>), <span class="dt">group =</span> <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb242-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> jobs, <span class="dt">y =</span> time, <span class="dt">group =</span> group)) <span class="op">+</span></a>
<a class="sourceLine" id="cb242-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">29</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb242-14" data-line-number="14"><span class="st">  </span><span class="kw">theme_gray</span>(<span class="dv">16</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb242-15" data-line-number="15"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;jobs argument of make()&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb242-16" data-line-number="16"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Predicted runtime of make() (hours)&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/predictjobs-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>We see serious potential speed gains up to 4 jobs, but beyond that point, we have to double the jobs to shave off another 2 hours. Your choice of <code>jobs</code> for <code>make()</code> ultimately depends on the runtime you can tolerate and the computing resources at your disposal.</p>
<p>A final note on predicting runtime: the output of <code>predict_runtime()</code> and <code>predict_load_balancing()</code> also depends the optional <code>workers</code> column of your <code>drake_plan()</code>. If you micromanage which workers are allowed to build which targets, you may minimize reads from disk, but you could also slow down your workflow if you are not careful. See the <a href="hpc.html#hpc">high-performance computing guide</a> for more.</p>

</div>
</div>
<div style = "background: #1C356D; color: white; padding: 10px 10px 10px 25px; font-size: 1em; width: 100%;">
  Copyright Eli Lilly and Company
</div>
            </section>

          </div>
        </div>
      </div>
<a href="store.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="triggers.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
