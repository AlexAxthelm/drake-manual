<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 9 Debugging and testing drake projects | The drake R Package User Manual</title>
  <meta name="description" content="Chapter 9 Debugging and testing drake projects | The drake R Package User Manual">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 9 Debugging and testing drake projects | The drake R Package User Manual" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Debugging and testing drake projects | The drake R Package User Manual" />
  
  
  

<meta name="author" content="Will Landau, Kirill Müller, Alex Axthelm, Jasper Clarkberg, Lorenz Walthert">
<meta name="author" content="Copyright Eli Lilly and Company">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="vis.html">
<link rel="next" href="hpc.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.5/visNetwork.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/sankey-1/sankey.js"></script>
<script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-drake-r-package"><i class="fa fa-check"></i><b>1.1</b> The drake R package</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#why-drake"><i class="fa fa-check"></i><b>1.3</b> Why drake?</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#what-gets-done-stays-done."><i class="fa fa-check"></i><b>1.3.1</b> What gets done stays done.</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#reproducibility-with-confidence"><i class="fa fa-check"></i><b>1.3.2</b> Reproducibility with confidence</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#aggressively-scale-up."><i class="fa fa-check"></i><b>1.3.3</b> Aggressively scale up.</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#documentation"><i class="fa fa-check"></i><b>1.4</b> Documentation</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#cheat-sheet"><i class="fa fa-check"></i><b>1.4.1</b> Cheat sheet</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#frequently-asked-questions"><i class="fa fa-check"></i><b>1.4.2</b> Frequently asked questions</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#function-reference"><i class="fa fa-check"></i><b>1.4.3</b> Function reference</a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#tutorials"><i class="fa fa-check"></i><b>1.4.4</b> Tutorials</a></li>
<li class="chapter" data-level="1.4.5" data-path="index.html"><a href="index.html#examples"><i class="fa fa-check"></i><b>1.4.5</b> Examples</a></li>
<li class="chapter" data-level="1.4.6" data-path="index.html"><a href="index.html#presentations"><i class="fa fa-check"></i><b>1.4.6</b> Presentations</a></li>
<li class="chapter" data-level="1.4.7" data-path="index.html"><a href="index.html#real-example-projects"><i class="fa fa-check"></i><b>1.4.7</b> Real example projects</a></li>
<li class="chapter" data-level="1.4.8" data-path="index.html"><a href="index.html#context-and-history"><i class="fa fa-check"></i><b>1.4.8</b> Context and history</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#help-and-troubleshooting"><i class="fa fa-check"></i><b>1.5</b> Help and troubleshooting</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#similar-work"><i class="fa fa-check"></i><b>1.6</b> Similar work</a><ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#gnu-make"><i class="fa fa-check"></i><b>1.6.1</b> GNU Make</a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#remake"><i class="fa fa-check"></i><b>1.6.2</b> Remake</a></li>
<li class="chapter" data-level="1.6.3" data-path="index.html"><a href="index.html#memoise"><i class="fa fa-check"></i><b>1.6.3</b> Memoise</a></li>
<li class="chapter" data-level="1.6.4" data-path="index.html"><a href="index.html#knitr-and-r-markdown"><i class="fa fa-check"></i><b>1.6.4</b> Knitr and R Markdown</a></li>
<li class="chapter" data-level="1.6.5" data-path="index.html"><a href="index.html#factuals-drake"><i class="fa fa-check"></i><b>1.6.5</b> Factual’s Drake</a></li>
<li class="chapter" data-level="1.6.6" data-path="index.html"><a href="index.html#other-pipeline-toolkits"><i class="fa fa-check"></i><b>1.6.6</b> Other pipeline toolkits</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.7</b> Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>I Examples</b></span></li>
<li class="chapter" data-level="2" data-path="main.html"><a href="main.html"><i class="fa fa-check"></i><b>2</b> The main example</a><ul>
<li class="chapter" data-level="2.1" data-path="main.html"><a href="main.html#set-the-stage."><i class="fa fa-check"></i><b>2.1</b> Set the stage.</a></li>
<li class="chapter" data-level="2.2" data-path="main.html"><a href="main.html#make-your-results."><i class="fa fa-check"></i><b>2.2</b> Make your results.</a></li>
<li class="chapter" data-level="2.3" data-path="main.html"><a href="main.html#go-back-and-fix-things."><i class="fa fa-check"></i><b>2.3</b> Go back and fix things.</a></li>
<li class="chapter" data-level="2.4" data-path="main.html"><a href="main.html#try-it-yourself"><i class="fa fa-check"></i><b>2.4</b> Try it yourself!</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>3</b> An analysis of R package download trends</a><ul>
<li class="chapter" data-level="3.1" data-path="packages.html"><a href="packages.html#get-the-code."><i class="fa fa-check"></i><b>3.1</b> Get the code.</a></li>
<li class="chapter" data-level="3.2" data-path="packages.html"><a href="packages.html#overview"><i class="fa fa-check"></i><b>3.2</b> Overview</a></li>
<li class="chapter" data-level="3.3" data-path="packages.html"><a href="packages.html#analysis"><i class="fa fa-check"></i><b>3.3</b> Analysis</a></li>
<li class="chapter" data-level="3.4" data-path="packages.html"><a href="packages.html#other-ways-to-trigger-downloads"><i class="fa fa-check"></i><b>3.4</b> Other ways to trigger downloads</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="gsp.html"><a href="gsp.html"><i class="fa fa-check"></i><b>4</b> Finding the best model of gross state product</a><ul>
<li class="chapter" data-level="4.1" data-path="gsp.html"><a href="gsp.html#get-the-code.-1"><i class="fa fa-check"></i><b>4.1</b> Get the code.</a></li>
<li class="chapter" data-level="4.2" data-path="gsp.html"><a href="gsp.html#objective-and-methods"><i class="fa fa-check"></i><b>4.2</b> Objective and methods</a></li>
<li class="chapter" data-level="4.3" data-path="gsp.html"><a href="gsp.html#data"><i class="fa fa-check"></i><b>4.3</b> Data</a></li>
<li class="chapter" data-level="4.4" data-path="gsp.html"><a href="gsp.html#analysis-1"><i class="fa fa-check"></i><b>4.4</b> Analysis</a></li>
<li class="chapter" data-level="4.5" data-path="gsp.html"><a href="gsp.html#results"><i class="fa fa-check"></i><b>4.5</b> Results</a></li>
<li class="chapter" data-level="4.6" data-path="gsp.html"><a href="gsp.html#comparison-with-gnu-make"><i class="fa fa-check"></i><b>4.6</b> Comparison with GNU Make</a></li>
<li class="chapter" data-level="4.7" data-path="gsp.html"><a href="gsp.html#references"><i class="fa fa-check"></i><b>4.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mtcars.html"><a href="mtcars.html"><i class="fa fa-check"></i><b>5</b> The mtcars example and <code>drake</code> plan generation</a><ul>
<li class="chapter" data-level="5.1" data-path="mtcars.html"><a href="mtcars.html#get-the-code.-2"><i class="fa fa-check"></i><b>5.1</b> Get the code.</a></li>
<li class="chapter" data-level="5.2" data-path="mtcars.html"><a href="mtcars.html#quick-examples"><i class="fa fa-check"></i><b>5.2</b> Quick examples</a></li>
<li class="chapter" data-level="5.3" data-path="mtcars.html"><a href="mtcars.html#the-motivation-of-the-mtcars-example"><i class="fa fa-check"></i><b>5.3</b> The motivation of the mtcars example</a></li>
<li class="chapter" data-level="5.4" data-path="mtcars.html"><a href="mtcars.html#set-up-the-mtcars-example"><i class="fa fa-check"></i><b>5.4</b> Set up the mtcars example</a></li>
<li class="chapter" data-level="5.5" data-path="mtcars.html"><a href="mtcars.html#the-drake-plan"><i class="fa fa-check"></i><b>5.5</b> The <code>drake</code> plan</a></li>
<li class="chapter" data-level="5.6" data-path="mtcars.html"><a href="mtcars.html#generate-the-plan"><i class="fa fa-check"></i><b>5.6</b> Generate the plan</a><ul>
<li class="chapter" data-level="5.6.1" data-path="mtcars.html"><a href="mtcars.html#the-easy-way"><i class="fa fa-check"></i><b>5.6.1</b> The easy way</a></li>
<li class="chapter" data-level="5.6.2" data-path="mtcars.html"><a href="mtcars.html#the-old-way"><i class="fa fa-check"></i><b>5.6.2</b> The old way</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="mtcars.html"><a href="mtcars.html#run-the-workflow"><i class="fa fa-check"></i><b>5.7</b> Run the workflow</a></li>
</ul></li>
<li class="part"><span><b>II Functionality</b></span></li>
<li class="chapter" data-level="6" data-path="plans.html"><a href="plans.html"><i class="fa fa-check"></i><b>6</b> <code>drake</code> plans</a><ul>
<li class="chapter" data-level="6.1" data-path="plans.html"><a href="plans.html#what-is-a-drake-plan"><i class="fa fa-check"></i><b>6.1</b> What is a <code>drake</code> plan?</a></li>
<li class="chapter" data-level="6.2" data-path="plans.html"><a href="plans.html#plans-are-similar-to-r-scripts."><i class="fa fa-check"></i><b>6.2</b> Plans are similar to R scripts.</a></li>
<li class="chapter" data-level="6.3" data-path="plans.html"><a href="plans.html#so-why-do-we-use-plans"><i class="fa fa-check"></i><b>6.3</b> So why do we use plans?</a><ul>
<li class="chapter" data-level="6.3.1" data-path="plans.html"><a href="plans.html#plans-chop-up-the-work-into-pieces."><i class="fa fa-check"></i><b>6.3.1</b> Plans chop up the work into pieces.</a></li>
<li class="chapter" data-level="6.3.2" data-path="plans.html"><a href="plans.html#drake-uses-plans-to-schedule-you-work."><i class="fa fa-check"></i><b>6.3.2</b> <code>drake</code> uses plans to schedule you work.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="plans.html"><a href="plans.html#special-custom-columns-in-your-plan."><i class="fa fa-check"></i><b>6.4</b> Special custom columns in your plan.</a></li>
<li class="chapter" data-level="6.5" data-path="plans.html"><a href="plans.html#create-large-plans-the-easy-way"><i class="fa fa-check"></i><b>6.5</b> Create large plans the <em>easy</em> way</a><ul>
<li class="chapter" data-level="6.5.1" data-path="plans.html"><a href="plans.html#transformations-a-high-level-overview"><i class="fa fa-check"></i><b>6.5.1</b> Transformations: a high level overview</a></li>
<li class="chapter" data-level="6.5.2" data-path="plans.html"><a href="plans.html#the-types-of-transformations"><i class="fa fa-check"></i><b>6.5.2</b> The types of transformations</a></li>
<li class="chapter" data-level="6.5.3" data-path="plans.html"><a href="plans.html#grouping-variables"><i class="fa fa-check"></i><b>6.5.3</b> Grouping variables</a></li>
<li class="chapter" data-level="6.5.4" data-path="plans.html"><a href="plans.html#tags"><i class="fa fa-check"></i><b>6.5.4</b> Tags</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="plans.html"><a href="plans.html#create-large-plans-the-old-way"><i class="fa fa-check"></i><b>6.6</b> Create large plans the <em>old</em> way</a><ul>
<li class="chapter" data-level="6.6.1" data-path="plans.html"><a href="plans.html#map_plan"><i class="fa fa-check"></i><b>6.6.1</b> <code>map_plan()</code></a></li>
<li class="chapter" data-level="6.6.2" data-path="plans.html"><a href="plans.html#wildcard-templating"><i class="fa fa-check"></i><b>6.6.2</b> Wildcard templating</a></li>
<li class="chapter" data-level="6.6.3" data-path="plans.html"><a href="plans.html#wildcard-clusters"><i class="fa fa-check"></i><b>6.6.3</b> Wildcard clusters</a></li>
<li class="chapter" data-level="6.6.4" data-path="plans.html"><a href="plans.html#non-wildcard-functions"><i class="fa fa-check"></i><b>6.6.4</b> Non-wildcard functions</a></li>
<li class="chapter" data-level="6.6.5" data-path="plans.html"><a href="plans.html#custom-metaprogramming"><i class="fa fa-check"></i><b>6.6.5</b> Custom metaprogramming</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="organize.html"><a href="organize.html"><i class="fa fa-check"></i><b>7</b> How to organize the files of drake projects</a><ul>
<li class="chapter" data-level="7.1" data-path="organize.html"><a href="organize.html#examples-1"><i class="fa fa-check"></i><b>7.1</b> Examples</a></li>
<li class="chapter" data-level="7.2" data-path="organize.html"><a href="organize.html#where-do-you-put-your-code"><i class="fa fa-check"></i><b>7.2</b> Where do you put your code?</a></li>
<li class="chapter" data-level="7.3" data-path="organize.html"><a href="organize.html#your-commands-are-code-chunks-not-r-scripts"><i class="fa fa-check"></i><b>7.3</b> Your commands are code chunks, not R scripts</a></li>
<li class="chapter" data-level="7.4" data-path="organize.html"><a href="organize.html#workflows-as-r-packages"><i class="fa fa-check"></i><b>7.4</b> Workflows as R packages</a><ul>
<li class="chapter" data-level="7.4.1" data-path="organize.html"><a href="organize.html#advantages-of-putting-workflows-in-r-packages"><i class="fa fa-check"></i><b>7.4.1</b> Advantages of putting workflows in R packages</a></li>
<li class="chapter" data-level="7.4.2" data-path="organize.html"><a href="organize.html#the-problem"><i class="fa fa-check"></i><b>7.4.2</b> The problem</a></li>
<li class="chapter" data-level="7.4.3" data-path="organize.html"><a href="organize.html#the-solution"><i class="fa fa-check"></i><b>7.4.3</b> The solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="vis.html"><a href="vis.html"><i class="fa fa-check"></i><b>8</b> Visualization with drake</a><ul>
<li class="chapter" data-level="8.0.1" data-path="vis.html"><a href="vis.html#vis_drake_graph"><i class="fa fa-check"></i><b>8.0.1</b> <code>vis_drake_graph()</code></a></li>
<li class="chapter" data-level="8.0.2" data-path="vis.html"><a href="vis.html#sankey_drake_graph"><i class="fa fa-check"></i><b>8.0.2</b> <code>sankey_drake_graph()</code></a></li>
<li class="chapter" data-level="8.0.3" data-path="vis.html"><a href="vis.html#drake_ggraph"><i class="fa fa-check"></i><b>8.0.3</b> <code>drake_ggraph()</code></a></li>
<li class="chapter" data-level="8.1" data-path="vis.html"><a href="vis.html#underlying-graph-data-node-and-edge-data-frames"><i class="fa fa-check"></i><b>8.1</b> Underlying graph data: node and edge data frames</a></li>
<li class="chapter" data-level="8.2" data-path="vis.html"><a href="vis.html#visualizing-target-status"><i class="fa fa-check"></i><b>8.2</b> Visualizing target status</a></li>
<li class="chapter" data-level="8.3" data-path="vis.html"><a href="vis.html#subgraphs"><i class="fa fa-check"></i><b>8.3</b> Subgraphs</a></li>
<li class="chapter" data-level="8.4" data-path="vis.html"><a href="vis.html#control-the-vis_drake_graph-legend."><i class="fa fa-check"></i><b>8.4</b> Control the <code>vis_drake_graph()</code> legend.</a></li>
<li class="chapter" data-level="8.5" data-path="vis.html"><a href="vis.html#clusters"><i class="fa fa-check"></i><b>8.5</b> Clusters</a></li>
<li class="chapter" data-level="8.6" data-path="vis.html"><a href="vis.html#output-files"><i class="fa fa-check"></i><b>8.6</b> Output files</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="debug.html"><a href="debug.html"><i class="fa fa-check"></i><b>9</b> Debugging and testing drake projects</a><ul>
<li class="chapter" data-level="9.1" data-path="debug.html"><a href="debug.html#dependencies"><i class="fa fa-check"></i><b>9.1</b> Dependencies</a><ul>
<li class="chapter" data-level="9.1.1" data-path="debug.html"><a href="debug.html#visualize-your-dependency-graph."><i class="fa fa-check"></i><b>9.1.1</b> Visualize your dependency graph.</a></li>
<li class="chapter" data-level="9.1.2" data-path="debug.html"><a href="debug.html#check-specific-dependency-information."><i class="fa fa-check"></i><b>9.1.2</b> Check specific dependency information.</a></li>
<li class="chapter" data-level="9.1.3" data-path="debug.html"><a href="debug.html#outdated-targets-and-missing-dependencies"><i class="fa fa-check"></i><b>9.1.3</b> Outdated targets and missing dependencies</a></li>
<li class="chapter" data-level="9.1.4" data-path="debug.html"><a href="debug.html#but-why-are-my-targets-out-of-date"><i class="fa fa-check"></i><b>9.1.4</b> But <em>why</em> are my targets out of date?</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="debug.html"><a href="debug.html#diagnose-failures."><i class="fa fa-check"></i><b>9.2</b> Diagnose failures.</a></li>
<li class="chapter" data-level="9.3" data-path="debug.html"><a href="debug.html#timeouts-and-retries"><i class="fa fa-check"></i><b>9.3</b> Timeouts and retries</a></li>
<li class="chapter" data-level="9.4" data-path="debug.html"><a href="debug.html#consider-hasty-mode"><i class="fa fa-check"></i><b>9.4</b> Consider hasty mode</a></li>
<li class="chapter" data-level="9.5" data-path="debug.html"><a href="debug.html#more-help"><i class="fa fa-check"></i><b>9.5</b> More help</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="hpc.html"><a href="hpc.html"><i class="fa fa-check"></i><b>10</b> High-performance computing</a><ul>
<li class="chapter" data-level="10.1" data-path="hpc.html"><a href="hpc.html#batch-mode-for-long-workflows"><i class="fa fa-check"></i><b>10.1</b> Batch mode for long workflows</a></li>
<li class="chapter" data-level="10.2" data-path="hpc.html"><a href="hpc.html#let-make-schedule-your-targets."><i class="fa fa-check"></i><b>10.2</b> Let <code>make()</code> schedule your targets.</a></li>
<li class="chapter" data-level="10.3" data-path="hpc.html"><a href="hpc.html#parallel-backends"><i class="fa fa-check"></i><b>10.3</b> Parallel backends</a></li>
<li class="chapter" data-level="10.4" data-path="hpc.html"><a href="hpc.html#the-clustermq-backend"><i class="fa fa-check"></i><b>10.4</b> The <code>clustermq</code> backend</a><ul>
<li class="chapter" data-level="10.4.1" data-path="hpc.html"><a href="hpc.html#persistent-workers"><i class="fa fa-check"></i><b>10.4.1</b> Persistent workers</a></li>
<li class="chapter" data-level="10.4.2" data-path="hpc.html"><a href="hpc.html#installation-1"><i class="fa fa-check"></i><b>10.4.2</b> Installation</a></li>
<li class="chapter" data-level="10.4.3" data-path="hpc.html"><a href="hpc.html#on-your-local-machine"><i class="fa fa-check"></i><b>10.4.3</b> On your local machine</a></li>
<li class="chapter" data-level="10.4.4" data-path="hpc.html"><a href="hpc.html#on-a-cluster"><i class="fa fa-check"></i><b>10.4.4</b> On a cluster</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="hpc.html"><a href="hpc.html#the-future-backend"><i class="fa fa-check"></i><b>10.5</b> The <code>future</code> backend</a><ul>
<li class="chapter" data-level="10.5.1" data-path="hpc.html"><a href="hpc.html#transient-workers"><i class="fa fa-check"></i><b>10.5.1</b> Transient workers</a></li>
<li class="chapter" data-level="10.5.2" data-path="hpc.html"><a href="hpc.html#installation-2"><i class="fa fa-check"></i><b>10.5.2</b> Installation</a></li>
<li class="chapter" data-level="10.5.3" data-path="hpc.html"><a href="hpc.html#on-your-local-machine-1"><i class="fa fa-check"></i><b>10.5.3</b> On your local machine</a></li>
<li class="chapter" data-level="10.5.4" data-path="hpc.html"><a href="hpc.html#on-a-cluster-1"><i class="fa fa-check"></i><b>10.5.4</b> On a cluster</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="hpc.html"><a href="hpc.html#advanced-options"><i class="fa fa-check"></i><b>10.6</b> Advanced options</a><ul>
<li class="chapter" data-level="10.6.1" data-path="hpc.html"><a href="hpc.html#memory"><i class="fa fa-check"></i><b>10.6.1</b> Memory</a></li>
<li class="chapter" data-level="10.6.2" data-path="hpc.html"><a href="hpc.html#storage"><i class="fa fa-check"></i><b>10.6.2</b> Storage</a></li>
<li class="chapter" data-level="10.6.3" data-path="hpc.html"><a href="hpc.html#the-template-argument-for-persistent-workers"><i class="fa fa-check"></i><b>10.6.3</b> The <code>template</code> argument for persistent workers</a></li>
<li class="chapter" data-level="10.6.4" data-path="hpc.html"><a href="hpc.html#the-resources-column-for-transient-workers"><i class="fa fa-check"></i><b>10.6.4</b> The <code>resources</code> column for transient workers</a></li>
<li class="chapter" data-level="10.6.5" data-path="hpc.html"><a href="hpc.html#custom-job-schedulers"><i class="fa fa-check"></i><b>10.6.5</b> Custom job schedulers</a></li>
<li class="chapter" data-level="10.6.6" data-path="hpc.html"><a href="hpc.html#parallel-computing-within-targets"><i class="fa fa-check"></i><b>10.6.6</b> Parallel computing <em>within</em> targets</a></li>
<li class="chapter" data-level="10.6.7" data-path="hpc.html"><a href="hpc.html#hasty-mode"><i class="fa fa-check"></i><b>10.6.7</b> Hasty mode</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="triggers.html"><a href="triggers.html"><i class="fa fa-check"></i><b>11</b> Triggers: decision rules for building targets</a><ul>
<li class="chapter" data-level="11.1" data-path="triggers.html"><a href="triggers.html#what-are-triggers"><i class="fa fa-check"></i><b>11.1</b> What are triggers?</a></li>
<li class="chapter" data-level="11.2" data-path="triggers.html"><a href="triggers.html#customization"><i class="fa fa-check"></i><b>11.2</b> Customization</a></li>
<li class="chapter" data-level="11.3" data-path="triggers.html"><a href="triggers.html#alternative-trigger-modes"><i class="fa fa-check"></i><b>11.3</b> Alternative trigger modes</a></li>
<li class="chapter" data-level="11.4" data-path="triggers.html"><a href="triggers.html#consider-hasty-mode-1"><i class="fa fa-check"></i><b>11.4</b> Consider hasty mode</a></li>
<li class="chapter" data-level="11.5" data-path="triggers.html"><a href="triggers.html#a-more-practical-example"><i class="fa fa-check"></i><b>11.5</b> A more practical example</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="time.html"><a href="time.html"><i class="fa fa-check"></i><b>12</b> Time: logging, prediction, and strategy</a><ul>
<li class="chapter" data-level="12.1" data-path="time.html"><a href="time.html#predict-total-runtime"><i class="fa fa-check"></i><b>12.1</b> Predict total runtime</a></li>
<li class="chapter" data-level="12.2" data-path="time.html"><a href="time.html#strategize-your-high-performance-computing"><i class="fa fa-check"></i><b>12.2</b> Strategize your high-performance computing</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="store.html"><a href="store.html"><i class="fa fa-check"></i><b>13</b> Storage</a><ul>
<li class="chapter" data-level="13.1" data-path="store.html"><a href="store.html#cache-formats"><i class="fa fa-check"></i><b>13.1</b> Cache formats</a><ul>
<li class="chapter" data-level="13.1.1" data-path="store.html"><a href="store.html#rds-caches"><i class="fa fa-check"></i><b>13.1.1</b> RDS caches</a></li>
<li class="chapter" data-level="13.1.2" data-path="store.html"><a href="store.html#database-caches"><i class="fa fa-check"></i><b>13.1.2</b> Database caches</a></li>
<li class="chapter" data-level="13.1.3" data-path="store.html"><a href="store.html#environment-caches"><i class="fa fa-check"></i><b>13.1.3</b> Environment caches</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="store.html"><a href="store.html#hash-algorithms"><i class="fa fa-check"></i><b>13.2</b> Hash algorithms</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>A</b> Frequently-asked questions</a></li>
<li class="chapter" data-level="B" data-path="caution.html"><a href="caution.html"><i class="fa fa-check"></i><b>B</b> Cautionary notes</a><ul>
<li class="chapter" data-level="B.1" data-path="caution.html"><a href="caution.html#workflow-plans"><i class="fa fa-check"></i><b>B.1</b> Workflow plans</a><ul>
<li class="chapter" data-level="B.1.1" data-path="caution.html"><a href="caution.html#externalizing-commands-in-r-script-files"><i class="fa fa-check"></i><b>B.1.1</b> Externalizing commands in R script files</a></li>
<li class="chapter" data-level="B.1.2" data-path="caution.html"><a href="caution.html#commands-are-not-perfectly-flexible."><i class="fa fa-check"></i><b>B.1.2</b> Commands are NOT perfectly flexible.</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="caution.html"><a href="caution.html#execution"><i class="fa fa-check"></i><b>B.2</b> Execution</a><ul>
<li class="chapter" data-level="B.2.1" data-path="caution.html"><a href="caution.html#install-drake-properly."><i class="fa fa-check"></i><b>B.2.1</b> Install <code>drake</code> properly.</a></li>
<li class="chapter" data-level="B.2.2" data-path="caution.html"><a href="caution.html#install-all-your-packages."><i class="fa fa-check"></i><b>B.2.2</b> Install all your packages.</a></li>
<li class="chapter" data-level="B.2.3" data-path="caution.html"><a href="caution.html#a-note-on-tidy-evaluation"><i class="fa fa-check"></i><b>B.2.3</b> A note on tidy evaluation</a></li>
<li class="chapter" data-level="B.2.4" data-path="caution.html"><a href="caution.html#find-and-diagnose-your-errors."><i class="fa fa-check"></i><b>B.2.4</b> Find and diagnose your errors.</a></li>
<li class="chapter" data-level="B.2.5" data-path="caution.html"><a href="caution.html#refresh-the-drake_config-list-early-and-often."><i class="fa fa-check"></i><b>B.2.5</b> Refresh the <code>drake_config()</code> list early and often.</a></li>
<li class="chapter" data-level="B.2.6" data-path="caution.html"><a href="caution.html#workflows-as-r-packages."><i class="fa fa-check"></i><b>B.2.6</b> Workflows as R packages.</a></li>
<li class="chapter" data-level="B.2.7" data-path="caution.html"><a href="caution.html#the-lazy_load-flag-does-not-work-with-parlapply-parallelism."><i class="fa fa-check"></i><b>B.2.7</b> The <code>lazy_load</code> flag does not work with <code>&quot;parLapply&quot;</code> parallelism.</a></li>
<li class="chapter" data-level="B.2.8" data-path="caution.html"><a href="caution.html#timeouts-may-be-unreliable."><i class="fa fa-check"></i><b>B.2.8</b> Timeouts may be unreliable.</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="caution.html"><a href="caution.html#dependencies-1"><i class="fa fa-check"></i><b>B.3</b> Dependencies</a><ul>
<li class="chapter" data-level="B.3.1" data-path="caution.html"><a href="caution.html#objects-that-contain-functions-may-rebuild-too-often"><i class="fa fa-check"></i><b>B.3.1</b> Objects that contain functions may rebuild too often</a></li>
<li class="chapter" data-level="B.3.2" data-path="caution.html"><a href="caution.html#dependencies-are-not-tracked-in-some-edge-cases."><i class="fa fa-check"></i><b>B.3.2</b> Dependencies are not tracked in some edge cases.</a></li>
<li class="chapter" data-level="B.3.3" data-path="caution.html"><a href="caution.html#dependencies-of-knitr-reports"><i class="fa fa-check"></i><b>B.3.3</b> Dependencies of <code>knitr</code> reports</a></li>
<li class="chapter" data-level="B.3.4" data-path="caution.html"><a href="caution.html#s3-and-generic-methods"><i class="fa fa-check"></i><b>B.3.4</b> S3 and generic methods</a></li>
<li class="chapter" data-level="B.3.5" data-path="caution.html"><a href="caution.html#file-outputs-in-imported-functions."><i class="fa fa-check"></i><b>B.3.5</b> File outputs in imported functions.</a></li>
<li class="chapter" data-level="B.3.6" data-path="caution.html"><a href="caution.html#functions-produced-by-vectorize"><i class="fa fa-check"></i><b>B.3.6</b> Functions produced by <code>Vectorize()</code></a></li>
<li class="chapter" data-level="B.3.7" data-path="caution.html"><a href="caution.html#compiled-code-is-not-reproducibly-tracked."><i class="fa fa-check"></i><b>B.3.7</b> Compiled code is not reproducibly tracked.</a></li>
<li class="chapter" data-level="B.3.8" data-path="caution.html"><a href="caution.html#directories-folders-are-not-reproducibly-tracked."><i class="fa fa-check"></i><b>B.3.8</b> Directories (folders) are not reproducibly tracked.</a></li>
<li class="chapter" data-level="B.3.9" data-path="caution.html"><a href="caution.html#packages-are-not-tracked-as-dependencies."><i class="fa fa-check"></i><b>B.3.9</b> Packages are not tracked as dependencies.</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="caution.html"><a href="caution.html#high-performance-computing"><i class="fa fa-check"></i><b>B.4</b> High-performance computing</a><ul>
<li class="chapter" data-level="B.4.1" data-path="caution.html"><a href="caution.html#calling-mclapply-within-targets"><i class="fa fa-check"></i><b>B.4.1</b> Calling <code>mclapply()</code> <em>within</em> targets</a></li>
<li class="chapter" data-level="B.4.2" data-path="caution.html"><a href="caution.html#zombie-processes"><i class="fa fa-check"></i><b>B.4.2</b> Zombie processes</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="caution.html"><a href="caution.html#storage-1"><i class="fa fa-check"></i><b>B.5</b> Storage</a><ul>
<li class="chapter" data-level="B.5.1" data-path="caution.html"><a href="caution.html#projects-hosted-on-dropbox-and-similar-platforms"><i class="fa fa-check"></i><b>B.5.1</b> Projects hosted on Dropbox and similar platforms</a></li>
<li class="chapter" data-level="B.5.2" data-path="caution.html"><a href="caution.html#cache-customization-is-limited"><i class="fa fa-check"></i><b>B.5.2</b> Cache customization is limited</a></li>
<li class="chapter" data-level="B.5.3" data-path="caution.html"><a href="caution.html#runtime-predictions"><i class="fa fa-check"></i><b>B.5.3</b> Runtime predictions</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The drake R Package User Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="debug" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Debugging and testing drake projects</h1>
<p>This chapter is a guide to debugging and testing <code>drake</code> projects.</p>
<div id="dependencies" class="section level2">
<h2><span class="header-section-number">9.1</span> Dependencies</h2>
<p><code>drake</code> automatically detects dependency relationships among your targets and imports. While this is convenient most of the time, it can lead to some pitfalls. This section describes techniques to understand you project’s dependency structure and diagnose and debug issues.</p>
<div id="visualize-your-dependency-graph." class="section level3">
<h3><span class="header-section-number">9.1.1</span> Visualize your dependency graph.</h3>
<p>To avoid frustration early on, please use <a href="#visuals"><code>drake</code>’s dependency graph visualizations</a> to see how the steps of your workflow fit together. <code>drake</code> resolves the dependency relationships in the graph by analyzing the code in your commands and the functions in your environment.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load_mtcars_example</span>()
config &lt;-<span class="st"> </span><span class="kw">drake_config</span>(my_plan)
<span class="co"># Hover, click, drag, zoom, and pan. See args &#39;from&#39; and &#39;to&#39;.</span>
<span class="kw">vis_drake_graph</span>(config, <span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>, <span class="dt">height =</span> <span class="st">&quot;500px&quot;</span>)</code></pre>
<div id="htmlwidget-13b0e8e333249dfcc101" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-13b0e8e333249dfcc101">{"x":{"nodes":{"id":["coef_regression1_large","coef_regression1_small","coef_regression2_large","coef_regression2_small","large","n-MRQXIYLTMV2HGOR2NV2GGYLSOM","p-OJSXA33SOQXFE3LE","p-OJSXA33SOQXG2ZA","random_rows","reg1","reg2","regression1_large","regression1_small","regression2_large","regression2_small","report","simulate","small","summ_regression1_large","summ_regression1_small","summ_regression2_large","summ_regression2_small","x2"],"imported":[false,false,false,false,false,true,true,false,true,true,true,false,false,false,false,false,true,false,false,false,false,false,true],"label":["coef_regression1_large","coef_regression1_small","coef_regression2_large","coef_regression2_small","large","datasets::mtcars","file report.Rmd","file report.md","random_rows","reg1","reg2","regression1_large","regression1_small","regression2_large","regression2_small","report","simulate","small","summ_regression1_large","summ_regression1_small","summ_regression2_large","summ_regression2_small","x2"],"command":["suppressWarnings(summary(regression1_large))$coefficients","suppressWarnings(summary(regression1_small))$coefficients","suppressWarnings(summary(regression2_large))$coefficients","suppressWarnings(summary(regression2_small))$coefficients","simulate(64)",null,null,"knit(knitr_in(\"report.Rmd\"), file_out(\"report.md\"), quiet = TRUE)",null,null,null,"reg1(large)","reg1(small)","reg2(large)","reg2(small)","knit(knitr_in(\"report.Rmd\"), file_out(\"report.md\"), quiet = TRUE)",null,"simulate(48)","suppressWarnings(summary(regression1_large$residuals))","suppressWarnings(summary(regression1_small$residuals))","suppressWarnings(summary(regression2_large$residuals))","suppressWarnings(summary(regression2_small$residuals))",null],"status":["outdated","outdated","outdated","outdated","outdated","imported","imported","outdated","imported","imported","imported","outdated","outdated","outdated","outdated","outdated","imported","outdated","outdated","outdated","outdated","outdated","imported"],"type":["object","object","object","object","object","object","file","object","function","function","function","object","object","object","object","object","function","object","object","object","object","object","object"],"font.size":[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],"color":["#000000","#000000","#000000","#000000","#000000","#1874CD","#1874CD","#000000","#1874CD","#1874CD","#1874CD","#000000","#000000","#000000","#000000","#000000","#1874CD","#000000","#000000","#000000","#000000","#000000","#1874CD"],"shape":["dot","dot","dot","dot","dot","dot","square","square","triangle","triangle","triangle","dot","dot","dot","dot","dot","triangle","dot","dot","dot","dot","dot","dot"],"level":[5,5,5,5,3,1,1,7,1,1,2,4,4,4,4,6,2,3,5,5,5,5,1],"title":["suppressWarnings(summary(regression1_large))$c...","suppressWarnings(summary(regression1_small))$c...","suppressWarnings(summary(regression2_large))$c...","suppressWarnings(summary(regression2_small))$c...","simulate(64)","n-MRQXIYLTMV2HGOR2NV2GGYLSOM","---<br>title: \"Final results report for the mtcars ex...<br>author: You<br>output: html_document<br>---<br><br># The weight and fuel efficiency of cars<br><br>Is there an association between the weight and...<br>...","knit(knitr_in(\"report.Rmd\"),&nbsp;file_out(\"report....","function&nbsp;(data,&nbsp;n)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;data[sample.int(n&nbsp;=&nbsp;nrow(data),&nbsp;size&nbsp;=&nbsp;n,&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br>}","function&nbsp;(d)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;lm(y&nbsp;~&nbsp;+x,&nbsp;data&nbsp;=&nbsp;d)<br>}","function&nbsp;(d)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;d$x2&nbsp;<-&nbsp;d$x^2<br>&nbsp;&nbsp;&nbsp;&nbsp;lm(y&nbsp;~&nbsp;x2,&nbsp;data&nbsp;=&nbsp;d)<br>}","reg1(large)","reg1(small)","reg2(large)","reg2(small)","knit(knitr_in(\"report.Rmd\"),&nbsp;file_out(\"report....","function&nbsp;(n)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;<-&nbsp;random_rows(data&nbsp;=&nbsp;datasets::mtcar...<br>&nbsp;&nbsp;&nbsp;&nbsp;data.frame(x&nbsp;=&nbsp;data$wt,&nbsp;y&nbsp;=&nbsp;data$mpg)<br>}","simulate(48)","suppressWarnings(summary(regression1_large$res...","suppressWarnings(summary(regression1_small$res...","suppressWarnings(summary(regression2_large$res...","suppressWarnings(summary(regression2_small$res...","x2"],"x":[0.1,1,0.4,-0.1,-0.9,-0.8,-1,-1,-0.6,-0.2,0.5,-0.1,0.9,0.3,0.6,-1,-0.8,0,-0.5,0.6,-0.3,0.8,0.6],"y":[0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,-0.333333333333333,-1,-1,1,-1,-1,-0.666666666666667,0,0,0,0,0.666666666666667,-0.666666666666667,-0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,-1]},"edges":{"from":["x2","random_rows","n-MRQXIYLTMV2HGOR2NV2GGYLSOM","reg1","reg1","large","large","large","small","small","small","coef_regression2_small","p-OJSXA33SOQXFE3LE","report","simulate","simulate","reg2","reg2","regression1_small","regression1_small","regression1_large","regression1_large","regression2_small","regression2_small","regression2_large","regression2_large"],"to":["reg2","simulate","simulate","regression1_small","regression1_large","report","regression1_large","regression2_large","report","regression1_small","regression2_small","report","report","p-OJSXA33SOQXG2ZA","large","small","regression2_small","regression2_large","summ_regression1_small","coef_regression1_small","summ_regression1_large","coef_regression1_large","coef_regression2_small","summ_regression2_small","summ_regression2_large","coef_regression2_large"],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"smooth":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"layout":{"hierarchical":{"enabled":true,"direction":"LR"}},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"navigationButtons":true}},"groups":null,"width":"100%","height":"500px","idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)"},"main":{"text":"Dependency graph","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":false,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":true,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["Outdated","Imported","Object","Function","File"],"color":["#000000","#1874CD","#888888","#888888","#888888"],"shape":["dot","dot","dot","triangle","square"],"font.color":["black","black","black","black","black"],"font.size":[20,20,20,20,20],"id":[2,5,7,8,9]},"nodesToDataframe":true},"igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="check-specific-dependency-information." class="section level3">
<h3><span class="header-section-number">9.1.2</span> Check specific dependency information.</h3>
<p>With the <code>deps_code()</code> function, you can see for yourself how <code>drake</code> detects first-order dependencies from code.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(simulate)
## function (n) 
## {
##     data &lt;- random_rows(data = datasets::mtcars, n = n)
##     data.frame(x = data$wt, y = data$mpg)
## }

<span class="kw">deps_code</span>(simulate)
## $globals
## [1] &quot;data.frame&quot;  &quot;mpg&quot;         &quot;wt&quot;          &quot;random_rows&quot;
## 
## $namespaced
## [1] &quot;datasets::mtcars&quot;

<span class="co"># knitr_in() makes sure your target depends on `report.Rmd`</span>
<span class="co"># and any dependencies loaded with loadd() and readd()</span>
<span class="co"># in the report&#39;s active code chunks.</span>
<span class="kw">cat</span>(my_plan<span class="op">$</span>command[<span class="dv">1</span>])
## knit(knitr_in(&quot;report.Rmd&quot;), file_out(&quot;report.md&quot;), quiet = TRUE)

<span class="kw">deps_code</span>(my_plan<span class="op">$</span>command[<span class="dv">1</span>])
## $globals
## [1] &quot;knit&quot;
## 
## $loadd
## [1] &quot;large&quot;
## 
## $readd
## [1] &quot;small&quot;                  &quot;coef_regression2_small&quot;
## 
## $file_out
## [1] &quot;report.md&quot;
## 
## $knitr_in
## [1] &quot;report.Rmd&quot;

<span class="kw">cat</span>(my_plan<span class="op">$</span>command[<span class="kw">nrow</span>(my_plan)])
## suppressWarnings(summary(regression2_large))$coefficients

<span class="kw">deps_code</span>(my_plan<span class="op">$</span>command[<span class="kw">nrow</span>(my_plan)])
## $globals
## [1] &quot;summary&quot;           &quot;suppressWarnings&quot;  &quot;regression2_large&quot;
## [4] &quot;coefficients&quot;</code></pre>
<p>With <code>deps_target()</code>, you can see the dependencies that <code>drake</code> has already detected for your targets and imports.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">deps_target</span>(<span class="st">&quot;simulate&quot;</span>, config)
## $globals
## [1] &quot;random_rows&quot;
## 
## $namespaced
## [1] &quot;datasets::mtcars&quot;

<span class="kw">deps_target</span>(<span class="st">&quot;small&quot;</span>, config)
## $globals
## [1] &quot;simulate&quot;

<span class="kw">deps_target</span>(<span class="st">&quot;report&quot;</span>, config)
## $loadd
## [1] &quot;large&quot;
## 
## $readd
## [1] &quot;small&quot;                  &quot;coef_regression2_small&quot;
## 
## $file_out
## [1] &quot;report.md&quot;
## 
## $knitr_in
## [1] &quot;report.Rmd&quot;</code></pre>
<p>And with <code>tracked()</code>, you can list all the reproducibly tracked objects and files.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tracked</span>(config)
##  [1] &quot;coef_regression1_large&quot; &quot;coef_regression1_small&quot;
##  [3] &quot;coef_regression2_large&quot; &quot;coef_regression2_small&quot;
##  [5] &quot;large&quot;                  &quot;datasets::mtcars&quot;      
##  [7] &quot;file report.Rmd&quot;        &quot;file report.md&quot;        
##  [9] &quot;random_rows&quot;            &quot;reg1&quot;                  
## [11] &quot;reg2&quot;                   &quot;regression1_large&quot;     
## [13] &quot;regression1_small&quot;      &quot;regression2_large&quot;     
## [15] &quot;regression2_small&quot;      &quot;report&quot;                
## [17] &quot;simulate&quot;               &quot;small&quot;                 
## [19] &quot;summ_regression1_large&quot; &quot;summ_regression1_small&quot;
## [21] &quot;summ_regression2_large&quot; &quot;summ_regression2_small&quot;
## [23] &quot;x2&quot;</code></pre>
</div>
<div id="outdated-targets-and-missing-dependencies" class="section level3">
<h3><span class="header-section-number">9.1.3</span> Outdated targets and missing dependencies</h3>
<p><code>missed()</code> shows any imports missing from your environment</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">missed</span>(config) <span class="co"># Nothing is missing right now.</span>
## character(0)</code></pre>
<p><code>outdated()</code> reports any targets that are outdated.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">outdated</span>(config)
##  [1] &quot;coef_regression1_large&quot; &quot;coef_regression1_small&quot;
##  [3] &quot;coef_regression2_large&quot; &quot;coef_regression2_small&quot;
##  [5] &quot;large&quot;                  &quot;regression1_large&quot;     
##  [7] &quot;regression1_small&quot;      &quot;regression2_large&quot;     
##  [9] &quot;regression2_small&quot;      &quot;report&quot;                
## [11] &quot;small&quot;                  &quot;summ_regression1_large&quot;
## [13] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;
## [15] &quot;summ_regression2_small&quot;

<span class="kw">make</span>(my_plan)
## target large
## target small
## target regression1_large
## target regression2_large
## target regression1_small
## target regression2_small
## target summ_regression1_large
## target coef_regression1_large
## target summ_regression2_large
## target coef_regression2_large
## target summ_regression1_small
## target coef_regression1_small
## target coef_regression2_small
## target summ_regression2_small
## target report

<span class="kw">outdated</span>(config)
## character(0)</code></pre>
</div>
<div id="but-why-are-my-targets-out-of-date" class="section level3">
<h3><span class="header-section-number">9.1.4</span> But <em>why</em> are my targets out of date?</h3>
<p><code>drake</code> has the option to produce a cache log with the fingerprint of every target and import.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">drake_cache_log</span>())
## # A tibble: 6 x 3
##   hash             type   name                        
##   &lt;chr&gt;            &lt;chr&gt;  &lt;chr&gt;                       
## 1 4e6e4d4c0bcda263 target coef_regression1_large      
## 2 5ad25785a84e0cac target coef_regression1_small      
## 3 b2662785d55b28c1 target coef_regression2_large      
## 4 23c66b36be56905b target coef_regression2_small      
## 5 7b6504d4c0dcceab target large                       
## 6 f4b89e63bc92af79 import n-MRQXIYLTMV2HGOR2NV2GGYLSOM</code></pre>
<p>We highly recommend that you automatically produce a cache log file on every <code>make()</code> and put it under <a href="https://github.com">version control</a> with the rest of your project.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">make</span>(my_plan, <span class="dt">cache_log_file =</span> <span class="st">&quot;cache_log.txt&quot;</span>)
## All targets are already up to date.

<span class="kw">read.table</span>(<span class="st">&quot;cache_log.txt&quot;</span>, <span class="dt">nrows =</span> <span class="dv">6</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)
##               hash   type                         name
## 1 4e6e4d4c0bcda263 target       coef_regression1_large
## 2 5ad25785a84e0cac target       coef_regression1_small
## 3 b2662785d55b28c1 target       coef_regression2_large
## 4 23c66b36be56905b target       coef_regression2_small
## 5 7b6504d4c0dcceab target                        large
## 6 f4b89e63bc92af79 import n-MRQXIYLTMV2HGOR2NV2GGYLSOM</code></pre>
<p>Suppose we go back and add input checking to one of our functions.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(random_rows)
## function (data, n) 
## {
##     data[sample.int(n = nrow(data), size = n, replace = TRUE), 
##         ]
## }
## &lt;bytecode: 0xb4a9938&gt;

random_rows &lt;-<span class="st"> </span><span class="cf">function</span>(data, n){
  <span class="kw">stopifnot</span>(n <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)
  data[<span class="kw">sample.int</span>(<span class="dt">n =</span> <span class="kw">nrow</span>(data), <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>), ]
}</code></pre>
<p>Then, we forget to run <code>make()</code> again, and we leave the the project for several months. When we come back, all our targets are suddenly out of date.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">outdated</span>(config)
##  [1] &quot;coef_regression1_large&quot; &quot;coef_regression1_small&quot;
##  [3] &quot;coef_regression2_large&quot; &quot;coef_regression2_small&quot;
##  [5] &quot;large&quot;                  &quot;regression1_large&quot;     
##  [7] &quot;regression1_small&quot;      &quot;regression2_large&quot;     
##  [9] &quot;regression2_small&quot;      &quot;report&quot;                
## [11] &quot;small&quot;                  &quot;summ_regression1_large&quot;
## [13] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;
## [15] &quot;summ_regression2_small&quot;</code></pre>
<p>At first, we may not know why all our targets are outdated. But we can generate another cache log and check any hashes that changed. Our call to <code>outdated()</code> already re-cached the imports, so any changed imports will show up in the new log file.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">drake_cache_log_file</span>(<span class="dt">file =</span> <span class="st">&quot;cache_log2.txt&quot;</span>)

<span class="kw">system2</span>(<span class="st">&quot;diff&quot;</span>, <span class="st">&quot;cache_log.txt cache_log2.txt&quot;</span>, <span class="dt">stdout =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">cat</span>(<span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
## Warning in system2(&quot;diff&quot;, &quot;cache_log.txt cache_log2.txt&quot;, stdout = TRUE):
## running command &#39;&#39;diff&#39; cache_log.txt cache_log2.txt&#39; had status 1
## 10c10
## &lt; f6c574f24b2c9366 import random_rows
## ---
## &gt; 6f4f6662bac73cbf import random_rows
## 18c18
## &lt; 60fc7e05b8b58c7d import simulate
## ---
## &gt; 5a9c7035e352bc1a import simulate</code></pre>
<p>Now, we see that <code>random_rows()</code> has changed since last time, and we have a new dependency <code>stopifnot()</code>. <code>simulate()</code> shows up in the changes too, but only because <code>random_rows()</code> is nested in the body of <code>simulate()</code>. If we revert <code>random_rows()</code> to its original state, all our targets are up to date again.</p>
<pre class="sourceCode r"><code class="sourceCode r">random_rows &lt;-<span class="st"> </span><span class="cf">function</span>(data, n){
  data[<span class="kw">sample.int</span>(<span class="dt">n =</span> <span class="kw">nrow</span>(data), <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>), ]
}

<span class="kw">outdated</span>(config)
## character(0)

<span class="kw">drake_cache_log_file</span>(<span class="dt">file =</span> <span class="st">&quot;cache_log3.txt&quot;</span>)

<span class="kw">system2</span>(<span class="st">&quot;diff&quot;</span>, <span class="st">&quot;cache_log.txt cache_log3.txt&quot;</span>, <span class="dt">stdout =</span> <span class="ot">TRUE</span>)
## character(0)</code></pre>
</div>
</div>
<div id="diagnose-failures." class="section level2">
<h2><span class="header-section-number">9.2</span> Diagnose failures.</h2>
<p><code>drake</code> records diagnostic metadata on all your targets, including the latest errors, warnings, messages, and other bits of context.</p>
<pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  <span class="cf">if</span> (x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>){
    <span class="kw">stop</span>(<span class="st">&quot;`x` cannot be negative.&quot;</span>)
  }
  x
}
bad_plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(
  <span class="dt">a =</span> <span class="dv">12</span>,
  <span class="dt">b =</span> <span class="op">-</span>a,
  <span class="dt">my_target =</span> <span class="kw">f</span>(b)
)

bad_plan
## # A tibble: 3 x 2
##   target    command
##   &lt;chr&gt;     &lt;chr&gt;  
## 1 a         12     
## 2 b         -a     
## 3 my_target f(b)

withr<span class="op">::</span><span class="kw">with_message_sink</span>(
  <span class="dt">new =</span> <span class="kw">stdout</span>(),
  <span class="kw">make</span>(bad_plan)
)
## target a
## target b
## target my_target
## fail my_target
## Error: Target `my_target` failed. Call `diagnose(my_target)` for details. Error message:
##   `x` cannot be negative.

<span class="kw">failed</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) <span class="co"># from the last make() only</span>
## [1] &quot;my_target&quot;

<span class="co"># See also warnings and messages.</span>
error &lt;-<span class="st"> </span><span class="kw">diagnose</span>(my_target, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)<span class="op">$</span>error

error<span class="op">$</span>message
## [1] &quot;`x` cannot be negative.&quot;

error<span class="op">$</span>call
## f(b)

<span class="kw">str</span>(error<span class="op">$</span>calls) <span class="co"># View the traceback.</span>
## List of 8
##  $ : language local({     f(b) ...
##  $ : language eval.parent(substitute(eval(quote(expr), envir)))
##  $ : language eval(expr, p)
##  $ : language eval(expr, p)
##  $ : language eval(quote({     f(b) ...
##  $ : language eval(quote({     f(b) ...
##  $ : language f(b)
##  $ : language stop(&quot;`x` cannot be negative.&quot;)
##   ..- attr(*, &quot;srcref&quot;)= &#39;srcref&#39; int [1:8] 3 5 3 35 5 35 3 3
##   .. ..- attr(*, &quot;srcfile&quot;)=Classes &#39;srcfilecopy&#39;, &#39;srcfile&#39; &lt;environment: 0x180aa880&gt;</code></pre>
<p>To figure out what went wrong, you could try to build the failed target interactively. To do that, simply call <code>drake_build()</code> or <code>drake_debug()</code>. These functions first call <code>loadd(deps = TRUE)</code> to load any missing dependencies (see the <code>replace</code> argument here) and then build your target. <code>drake_build()</code> simply runs the command, and <code>drake_debug()</code> runs the command in debug mode using <code>debugonce()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Pretend we just opened a new R session.</span>
<span class="kw">library</span>(drake)

<span class="co"># Unloads target `b`.</span>
config &lt;-<span class="st"> </span><span class="kw">drake_config</span>(<span class="dt">plan =</span> bad_plan)

<span class="co"># my_target depends on b.</span>
<span class="st">&quot;b&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">ls</span>()
## [1] FALSE

<span class="co"># Try to build my_target until the error is fixed.</span>
<span class="co"># Skip all that pesky work checking dependencies.</span>
<span class="kw">drake_build</span>(my_target, <span class="dt">config =</span> config) <span class="co"># See also drake_debug().</span>
## target my_target
## fail my_target
## Error: Target `my_target` failed. Call `diagnose(my_target)` for details. Error message:
##   `x` cannot be negative.

<span class="co"># The target failed, but the dependency was loaded.</span>
<span class="st">&quot;b&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">ls</span>()
## [1] FALSE

<span class="co"># What was `b` again?</span>
b
## Error in eval(expr, envir, enclos): object &#39;b&#39; not found

<span class="co"># How was `b` used?</span>
<span class="kw">diagnose</span>(my_target)<span class="op">$</span>message
## NULL

<span class="kw">diagnose</span>(my_target)<span class="op">$</span>call
## NULL

f
## function(x){
##   if (x &lt; 0){
##     stop(&quot;`x` cannot be negative.&quot;)
##   }
##   x
## }

<span class="co"># Aha! The error was in f(). Let&#39;s fix it and try again.</span>
f &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  x &lt;-<span class="st"> </span><span class="kw">abs</span>(x)
  <span class="cf">if</span> (x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>){
    <span class="kw">stop</span>(<span class="st">&quot;`x` cannot be negative.&quot;</span>)
  }
  x
}

<span class="co"># Now it works!</span>
<span class="co"># Since you called make() previously, `config` is read from the cache</span>
<span class="co"># if you do not supply it.</span>
<span class="kw">drake_build</span>(my_target) <span class="co"># See also drake_debug().</span>
## Error in loadd(list = target, deps = TRUE, envir = config$eval, cache = config$cache, : cannot find drake cache.

<span class="kw">readd</span>(my_target)
## Error: key &#39;my_target&#39; (&#39;objects&#39;) not found</code></pre>
</div>
<div id="timeouts-and-retries" class="section level2">
<h2><span class="header-section-number">9.3</span> Timeouts and retries</h2>
<p>See the <code>timeout</code>, <code>cpu</code>, <code>elapsed</code>, and <code>retries</code> argument to <code>make()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">clean</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>)
f &lt;-<span class="st"> </span><span class="cf">function</span>(...){
  <span class="kw">Sys.sleep</span>(<span class="dv">1</span>)
}
debug_plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="kw">f</span>(x))
debug_plan
## # A tibble: 2 x 2
##   target command
##   &lt;chr&gt;  &lt;chr&gt;  
## 1 x      1      
## 2 y      f(x)

withr<span class="op">::</span><span class="kw">with_message_sink</span>(
  <span class="kw">stdout</span>(),
  <span class="kw">make</span>(debug_plan, <span class="dt">timeout =</span> <span class="fl">1e-3</span>, <span class="dt">retries =</span> <span class="dv">2</span>)
)
## Warning: Argument `timeout` is deprecated. Use `elapsed` and/or `cpu`
## instead.

## Warning: Argument `timeout` is deprecated. Use `elapsed` and/or `cpu`
## instead.
## target x
## target y</code></pre>
<p>To tailor these settings to each individual target, create new <code>timeout</code>, <code>cpu</code>, <code>elapsed</code>, or <code>retries</code> columns in your <code>drake</code> plan. These columns override the analogous arguments to <code>make()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">clean</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>)
debug_plan<span class="op">$</span>timeout &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1e-3</span>, <span class="fl">2e-3</span>)
debug_plan<span class="op">$</span>retries &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>

debug_plan
## # A tibble: 2 x 4
##   target command timeout retries
##   &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;   &lt;int&gt;
## 1 x      1         0.001       1
## 2 y      f(x)      0.002       2

withr<span class="op">::</span><span class="kw">with_message_sink</span>(
  <span class="dt">new =</span> <span class="kw">stdout</span>(),
  <span class="kw">make</span>(debug_plan, <span class="dt">timeout =</span> <span class="ot">Inf</span>, <span class="dt">retries =</span> <span class="dv">0</span>)
)
## Warning: Argument `timeout` is deprecated. Use `elapsed` and/or `cpu`
## instead.

## Warning: Argument `timeout` is deprecated. Use `elapsed` and/or `cpu`
## instead.
## target x
## target y</code></pre>
</div>
<div id="consider-hasty-mode" class="section level2">
<h2><span class="header-section-number">9.4</span> Consider hasty mode</h2>
<p>In hasty mode, <code>drake</code> acts as a job scheduler without watching dependencies. In other words, <code>make(parallelism = &quot;hasty&quot;)</code> always runs all the targets, and computational overhead is dramatically reduced. Because it helps deploy targets much faster, hasty mode may be a nice way to test a workflow before running it in production. Read more <a href="https://ropenscilabs.github.io/drake-manual/hpc.html#hasty-mode">here</a>.</p>
</div>
<div id="more-help" class="section level2">
<h2><span class="header-section-number">9.5</span> More help</h2>
<p>Please also see the <a href="caution.html#caution">compendium of cautionary notes</a>, which addresses <code>drake</code>’s known edge cases, pitfalls, and weaknesses that may or may not be fixed in future releases. For the most up-to-date information on unhandled edge cases, please visit the <a href="https://github.com/ropensci/drake/issues">issue tracker</a>, where you can submit your own bug reports as well. Be sure to search the closed issues too, especially if you are not using the most up-to-date development version.</p>

</div>
</div>
<div style = "background: #1C356D; color: white; padding: 10px 10px 10px 25px; font-size: 1em; width: 100%;">
  Copyright Eli Lilly and Company
</div>
            </section>

          </div>
        </div>
      </div>
<a href="vis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hpc.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
