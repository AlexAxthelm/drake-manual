<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>The drake R Package User Manual</title>
  <meta name="description" content="The drake R Package User Manual">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="The drake R Package User Manual" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="The drake R Package User Manual" />
  
  
  

<meta name="author" content="Will Landau, Kirill Müller, Alex Axthelm, Jasper Clarkberg, Lorenz Walthert">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="vis.html">
<link rel="next" href="hpc.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.4/visNetwork.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/sankey-1/sankey.js"></script>
<script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-drake-r-package"><i class="fa fa-check"></i><b>1.1</b> The drake R package</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#why-drake"><i class="fa fa-check"></i><b>1.3</b> Why drake?</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#what-gets-done-stays-done."><i class="fa fa-check"></i><b>1.3.1</b> What gets done stays done.</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#reproducibility-with-confidence"><i class="fa fa-check"></i><b>1.3.2</b> Reproducibility with confidence</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#aggressively-scale-up."><i class="fa fa-check"></i><b>1.3.3</b> Aggressively scale up.</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#documentation"><i class="fa fa-check"></i><b>1.4</b> Documentation</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#cheat-sheet"><i class="fa fa-check"></i><b>1.4.1</b> Cheat sheet</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#frequently-asked-questions"><i class="fa fa-check"></i><b>1.4.2</b> Frequently asked questions</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#function-reference"><i class="fa fa-check"></i><b>1.4.3</b> Function reference</a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#tutorials"><i class="fa fa-check"></i><b>1.4.4</b> Tutorials</a></li>
<li class="chapter" data-level="1.4.5" data-path="index.html"><a href="index.html#examples"><i class="fa fa-check"></i><b>1.4.5</b> Examples</a></li>
<li class="chapter" data-level="1.4.6" data-path="index.html"><a href="index.html#presentations"><i class="fa fa-check"></i><b>1.4.6</b> Presentations</a></li>
<li class="chapter" data-level="1.4.7" data-path="index.html"><a href="index.html#real-example-projects"><i class="fa fa-check"></i><b>1.4.7</b> Real example projects</a></li>
<li class="chapter" data-level="1.4.8" data-path="index.html"><a href="index.html#context-and-history"><i class="fa fa-check"></i><b>1.4.8</b> Context and history</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#help-and-troubleshooting"><i class="fa fa-check"></i><b>1.5</b> Help and troubleshooting</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#similar-work"><i class="fa fa-check"></i><b>1.6</b> Similar work</a><ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#gnu-make"><i class="fa fa-check"></i><b>1.6.1</b> GNU Make</a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#remake"><i class="fa fa-check"></i><b>1.6.2</b> Remake</a></li>
<li class="chapter" data-level="1.6.3" data-path="index.html"><a href="index.html#memoise"><i class="fa fa-check"></i><b>1.6.3</b> Memoise</a></li>
<li class="chapter" data-level="1.6.4" data-path="index.html"><a href="index.html#knitr-and-r-markdown"><i class="fa fa-check"></i><b>1.6.4</b> Knitr and R Markdown</a></li>
<li class="chapter" data-level="1.6.5" data-path="index.html"><a href="index.html#factuals-drake"><i class="fa fa-check"></i><b>1.6.5</b> Factual’s Drake</a></li>
<li class="chapter" data-level="1.6.6" data-path="index.html"><a href="index.html#other-pipeline-toolkits"><i class="fa fa-check"></i><b>1.6.6</b> Other pipeline toolkits</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.7</b> Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>I Examples</b></span></li>
<li class="chapter" data-level="2" data-path="main.html"><a href="main.html"><i class="fa fa-check"></i><b>2</b> The main example</a><ul>
<li class="chapter" data-level="2.1" data-path="main.html"><a href="main.html#set-the-stage."><i class="fa fa-check"></i><b>2.1</b> Set the stage.</a></li>
<li class="chapter" data-level="2.2" data-path="main.html"><a href="main.html#make-your-results."><i class="fa fa-check"></i><b>2.2</b> Make your results.</a></li>
<li class="chapter" data-level="2.3" data-path="main.html"><a href="main.html#go-back-and-fix-things."><i class="fa fa-check"></i><b>2.3</b> Go back and fix things.</a></li>
<li class="chapter" data-level="2.4" data-path="main.html"><a href="main.html#try-it-yourself"><i class="fa fa-check"></i><b>2.4</b> Try it yourself!</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>3</b> An analysis of R package download trends</a><ul>
<li class="chapter" data-level="3.1" data-path="packages.html"><a href="packages.html#get-the-code."><i class="fa fa-check"></i><b>3.1</b> Get the code.</a></li>
<li class="chapter" data-level="3.2" data-path="packages.html"><a href="packages.html#overview"><i class="fa fa-check"></i><b>3.2</b> Overview</a></li>
<li class="chapter" data-level="3.3" data-path="packages.html"><a href="packages.html#analysis"><i class="fa fa-check"></i><b>3.3</b> Analysis</a></li>
<li class="chapter" data-level="3.4" data-path="packages.html"><a href="packages.html#other-ways-to-trigger-downloads"><i class="fa fa-check"></i><b>3.4</b> Other ways to trigger downloads</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="gsp.html"><a href="gsp.html"><i class="fa fa-check"></i><b>4</b> Finding the best model of gross state product</a><ul>
<li class="chapter" data-level="4.1" data-path="gsp.html"><a href="gsp.html#get-the-code.-1"><i class="fa fa-check"></i><b>4.1</b> Get the code.</a></li>
<li class="chapter" data-level="4.2" data-path="gsp.html"><a href="gsp.html#objective-and-methods"><i class="fa fa-check"></i><b>4.2</b> Objective and methods</a></li>
<li class="chapter" data-level="4.3" data-path="gsp.html"><a href="gsp.html#data"><i class="fa fa-check"></i><b>4.3</b> Data</a></li>
<li class="chapter" data-level="4.4" data-path="gsp.html"><a href="gsp.html#analysis-1"><i class="fa fa-check"></i><b>4.4</b> Analysis</a></li>
<li class="chapter" data-level="4.5" data-path="gsp.html"><a href="gsp.html#results"><i class="fa fa-check"></i><b>4.5</b> Results</a></li>
<li class="chapter" data-level="4.6" data-path="gsp.html"><a href="gsp.html#comparison-with-gnu-make"><i class="fa fa-check"></i><b>4.6</b> Comparison with GNU Make</a></li>
<li class="chapter" data-level="4.7" data-path="gsp.html"><a href="gsp.html#references"><i class="fa fa-check"></i><b>4.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mtcars.html"><a href="mtcars.html"><i class="fa fa-check"></i><b>5</b> The mtcars example and workflow plan generation</a><ul>
<li class="chapter" data-level="5.1" data-path="mtcars.html"><a href="mtcars.html#get-the-code.-2"><i class="fa fa-check"></i><b>5.1</b> Get the code.</a></li>
<li class="chapter" data-level="5.2" data-path="mtcars.html"><a href="mtcars.html#quick-examples"><i class="fa fa-check"></i><b>5.2</b> Quick examples</a></li>
<li class="chapter" data-level="5.3" data-path="mtcars.html"><a href="mtcars.html#the-motivation-of-the-mtcars-example"><i class="fa fa-check"></i><b>5.3</b> The motivation of the mtcars example</a></li>
<li class="chapter" data-level="5.4" data-path="mtcars.html"><a href="mtcars.html#set-up-the-mtcars-example"><i class="fa fa-check"></i><b>5.4</b> Set up the mtcars example</a></li>
<li class="chapter" data-level="5.5" data-path="mtcars.html"><a href="mtcars.html#the-workflow-plan-data-frame"><i class="fa fa-check"></i><b>5.5</b> The workflow plan data frame</a></li>
<li class="chapter" data-level="5.6" data-path="mtcars.html"><a href="mtcars.html#generate-the-workflow-plan"><i class="fa fa-check"></i><b>5.6</b> Generate the workflow plan</a></li>
<li class="chapter" data-level="5.7" data-path="mtcars.html"><a href="mtcars.html#flexible-workflow-plan-generation"><i class="fa fa-check"></i><b>5.7</b> Flexible workflow plan generation</a></li>
<li class="chapter" data-level="5.8" data-path="mtcars.html"><a href="mtcars.html#run-the-workflow"><i class="fa fa-check"></i><b>5.8</b> Run the workflow</a></li>
<li class="chapter" data-level="5.9" data-path="mtcars.html"><a href="mtcars.html#automatic-watching-for-changed-dependencies"><i class="fa fa-check"></i><b>5.9</b> Automatic watching for changed dependencies</a></li>
<li class="chapter" data-level="5.10" data-path="mtcars.html"><a href="mtcars.html#a-note-on-tidy-evaluation"><i class="fa fa-check"></i><b>5.10</b> A note on tidy evaluation</a></li>
<li class="chapter" data-level="5.11" data-path="mtcars.html"><a href="mtcars.html#need-more-speed"><i class="fa fa-check"></i><b>5.11</b> Need more speed?</a></li>
</ul></li>
<li class="part"><span><b>II Functionality</b></span></li>
<li class="chapter" data-level="6" data-path="plans.html"><a href="plans.html"><i class="fa fa-check"></i><b>6</b> Workflow data frames</a><ul>
<li class="chapter" data-level="6.1" data-path="plans.html"><a href="plans.html#what-is-a-workflow-plan-data-frame"><i class="fa fa-check"></i><b>6.1</b> What is a workflow plan data frame?</a></li>
<li class="chapter" data-level="6.2" data-path="plans.html"><a href="plans.html#rationale"><i class="fa fa-check"></i><b>6.2</b> Rationale</a><ul>
<li class="chapter" data-level="6.2.1" data-path="plans.html"><a href="plans.html#you-can-skip-up-to-date-work."><i class="fa fa-check"></i><b>6.2.1</b> You can skip up-to-date work.</a></li>
<li class="chapter" data-level="6.2.2" data-path="plans.html"><a href="plans.html#data-frames-scale-well."><i class="fa fa-check"></i><b>6.2.2</b> Data frames scale well.</a></li>
<li class="chapter" data-level="6.2.3" data-path="plans.html"><a href="plans.html#you-do-not-need-to-worry-about-which-targets-run-first."><i class="fa fa-check"></i><b>6.2.3</b> You do not need to worry about which targets run first.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="plans.html"><a href="plans.html#automatic-dependency-detection"><i class="fa fa-check"></i><b>6.3</b> Automatic dependency detection</a></li>
<li class="chapter" data-level="6.4" data-path="plans.html"><a href="plans.html#generating-large-workflow-plans"><i class="fa fa-check"></i><b>6.4</b> Generating large workflow plans</a><ul>
<li class="chapter" data-level="6.4.1" data-path="plans.html"><a href="plans.html#wildcard-templating"><i class="fa fa-check"></i><b>6.4.1</b> Wildcard templating</a></li>
<li class="chapter" data-level="6.4.2" data-path="plans.html"><a href="plans.html#wildcard-clusters"><i class="fa fa-check"></i><b>6.4.2</b> Wildcard clusters</a></li>
<li class="chapter" data-level="6.4.3" data-path="plans.html"><a href="plans.html#specialized-wildcard-functionality"><i class="fa fa-check"></i><b>6.4.3</b> Specialized wildcard functionality</a></li>
<li class="chapter" data-level="6.4.4" data-path="plans.html"><a href="plans.html#non-wildcard-functions"><i class="fa fa-check"></i><b>6.4.4</b> Non-wildcard functions</a></li>
<li class="chapter" data-level="6.4.5" data-path="plans.html"><a href="plans.html#custom-metaprogramming"><i class="fa fa-check"></i><b>6.4.5</b> Custom metaprogramming</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="plans.html"><a href="plans.html#optional-columns-in-your-plan."><i class="fa fa-check"></i><b>6.5</b> Optional columns in your plan.</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="organize.html"><a href="organize.html"><i class="fa fa-check"></i><b>7</b> How to organize the files of drake projects</a><ul>
<li class="chapter" data-level="7.1" data-path="organize.html"><a href="organize.html#examples-1"><i class="fa fa-check"></i><b>7.1</b> Examples</a></li>
<li class="chapter" data-level="7.2" data-path="organize.html"><a href="organize.html#where-do-you-put-your-code"><i class="fa fa-check"></i><b>7.2</b> Where do you put your code?</a></li>
<li class="chapter" data-level="7.3" data-path="organize.html"><a href="organize.html#your-commands-are-code-chunks-not-r-scripts"><i class="fa fa-check"></i><b>7.3</b> Your commands are code chunks, not R scripts</a></li>
<li class="chapter" data-level="7.4" data-path="organize.html"><a href="organize.html#workflows-as-r-packages"><i class="fa fa-check"></i><b>7.4</b> Workflows as R packages</a><ul>
<li class="chapter" data-level="7.4.1" data-path="organize.html"><a href="organize.html#advantages-of-putting-workflows-in-r-packages"><i class="fa fa-check"></i><b>7.4.1</b> Advantages of putting workflows in R packages</a></li>
<li class="chapter" data-level="7.4.2" data-path="organize.html"><a href="organize.html#the-problem"><i class="fa fa-check"></i><b>7.4.2</b> The problem</a></li>
<li class="chapter" data-level="7.4.3" data-path="organize.html"><a href="organize.html#the-solution"><i class="fa fa-check"></i><b>7.4.3</b> The solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="vis.html"><a href="vis.html"><i class="fa fa-check"></i><b>8</b> Visualization with drake</a><ul>
<li class="chapter" data-level="8.0.1" data-path="vis.html"><a href="vis.html#vis_drake_graph"><i class="fa fa-check"></i><b>8.0.1</b> <code>vis_drake_graph()</code></a></li>
<li class="chapter" data-level="8.0.2" data-path="vis.html"><a href="vis.html#sankey_drake_graph"><i class="fa fa-check"></i><b>8.0.2</b> <code>sankey_drake_graph()</code></a></li>
<li class="chapter" data-level="8.0.3" data-path="vis.html"><a href="vis.html#drake_ggraph"><i class="fa fa-check"></i><b>8.0.3</b> <code>drake_ggraph()</code></a></li>
<li class="chapter" data-level="8.1" data-path="vis.html"><a href="vis.html#underlying-graph-data-node-and-edge-data-frames"><i class="fa fa-check"></i><b>8.1</b> Underlying graph data: node and edge data frames</a></li>
<li class="chapter" data-level="8.2" data-path="vis.html"><a href="vis.html#visualizing-target-status"><i class="fa fa-check"></i><b>8.2</b> Visualizing target status</a></li>
<li class="chapter" data-level="8.3" data-path="vis.html"><a href="vis.html#subgraphs"><i class="fa fa-check"></i><b>8.3</b> Subgraphs</a></li>
<li class="chapter" data-level="8.4" data-path="vis.html"><a href="vis.html#control-the-vis_drake_graph-legend."><i class="fa fa-check"></i><b>8.4</b> Control the <code>vis_drake_graph()</code> legend.</a></li>
<li class="chapter" data-level="8.5" data-path="vis.html"><a href="vis.html#clusters"><i class="fa fa-check"></i><b>8.5</b> Clusters</a></li>
<li class="chapter" data-level="8.6" data-path="vis.html"><a href="vis.html#output-files"><i class="fa fa-check"></i><b>8.6</b> Output files</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="debug.html"><a href="debug.html"><i class="fa fa-check"></i><b>9</b> Debugging and testing drake projects</a><ul>
<li class="chapter" data-level="9.1" data-path="debug.html"><a href="debug.html#the-configuration-list"><i class="fa fa-check"></i><b>9.1</b> The configuration list</a></li>
<li class="chapter" data-level="9.2" data-path="debug.html"><a href="debug.html#plan-your-work."><i class="fa fa-check"></i><b>9.2</b> Plan your work.</a><ul>
<li class="chapter" data-level="9.2.1" data-path="debug.html"><a href="debug.html#workflow-plan-data-frames"><i class="fa fa-check"></i><b>9.2.1</b> Workflow plan data frames</a></li>
<li class="chapter" data-level="9.2.2" data-path="debug.html"><a href="debug.html#visualize-your-workflow."><i class="fa fa-check"></i><b>9.2.2</b> Visualize your workflow.</a></li>
<li class="chapter" data-level="9.2.3" data-path="debug.html"><a href="debug.html#check-dependency-relationships."><i class="fa fa-check"></i><b>9.2.3</b> Check dependency relationships.</a></li>
<li class="chapter" data-level="9.2.4" data-path="debug.html"><a href="debug.html#outdated-up-to-date-and-missing-items"><i class="fa fa-check"></i><b>9.2.4</b> Outdated, up to date, and missing items</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="debug.html"><a href="debug.html#skipping-imports"><i class="fa fa-check"></i><b>9.3</b> Skipping imports</a></li>
<li class="chapter" data-level="9.4" data-path="debug.html"><a href="debug.html#impose-timeouts-and-retries"><i class="fa fa-check"></i><b>9.4</b> Impose timeouts and retries</a></li>
<li class="chapter" data-level="9.5" data-path="debug.html"><a href="debug.html#diagnose-failures."><i class="fa fa-check"></i><b>9.5</b> Diagnose failures.</a><ul>
<li class="chapter" data-level="9.5.1" data-path="debug.html"><a href="debug.html#tidy-evaluation-a-caveat-to-diagnosing-interactively"><i class="fa fa-check"></i><b>9.5.1</b> Tidy evaluation: a caveat to diagnosing interactively</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="debug.html"><a href="debug.html#debrief-a-build-session."><i class="fa fa-check"></i><b>9.6</b> Debrief a build session.</a></li>
<li class="chapter" data-level="9.7" data-path="debug.html"><a href="debug.html#start-tinkering."><i class="fa fa-check"></i><b>9.7</b> Start tinkering.</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="hpc.html"><a href="hpc.html"><i class="fa fa-check"></i><b>10</b> High-performance computing with drake</a><ul>
<li class="chapter" data-level="10.1" data-path="hpc.html"><a href="hpc.html#batch-mode-for-long-workflows"><i class="fa fa-check"></i><b>10.1</b> Batch mode for long workflows</a></li>
<li class="chapter" data-level="10.2" data-path="hpc.html"><a href="hpc.html#let-drake-schedule-your-targets."><i class="fa fa-check"></i><b>10.2</b> Let drake schedule your targets.</a></li>
<li class="chapter" data-level="10.3" data-path="hpc.html"><a href="hpc.html#parallel-backends"><i class="fa fa-check"></i><b>10.3</b> Parallel backends</a></li>
<li class="chapter" data-level="10.4" data-path="hpc.html"><a href="hpc.html#local-workers"><i class="fa fa-check"></i><b>10.4</b> Local workers</a></li>
<li class="chapter" data-level="10.5" data-path="hpc.html"><a href="hpc.html#remote-workers"><i class="fa fa-check"></i><b>10.5</b> Remote workers</a><ul>
<li class="chapter" data-level="10.5.1" data-path="hpc.html"><a href="hpc.html#future-future_lapply-and-future_lapply_staged"><i class="fa fa-check"></i><b>10.5.1</b> <code>&quot;future&quot;</code>, <code>&quot;future_lapply&quot;</code>, and <code>&quot;future_lapply_staged&quot;</code></a></li>
<li class="chapter" data-level="10.5.2" data-path="hpc.html"><a href="hpc.html#clustermq_staged"><i class="fa fa-check"></i><b>10.5.2</b> <code>&quot;clustermq_staged&quot;</code></a></li>
<li class="chapter" data-level="10.5.3" data-path="hpc.html"><a href="hpc.html#makefile"><i class="fa fa-check"></i><b>10.5.3</b> <code>&quot;Makefile&quot;</code></a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="hpc.html"><a href="hpc.html#scheduling-algorithms"><i class="fa fa-check"></i><b>10.6</b> Scheduling algorithms</a><ul>
<li class="chapter" data-level="10.6.1" data-path="hpc.html"><a href="hpc.html#persistent-scheduling"><i class="fa fa-check"></i><b>10.6.1</b> Persistent scheduling</a></li>
<li class="chapter" data-level="10.6.2" data-path="hpc.html"><a href="hpc.html#transient-scheduling"><i class="fa fa-check"></i><b>10.6.2</b> Transient scheduling</a></li>
<li class="chapter" data-level="10.6.3" data-path="hpc.html"><a href="hpc.html#staged-scheduling"><i class="fa fa-check"></i><b>10.6.3</b> Staged scheduling</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="hpc.html"><a href="hpc.html#final-thoughts"><i class="fa fa-check"></i><b>10.7</b> Final thoughts</a><ul>
<li class="chapter" data-level="10.7.1" data-path="hpc.html"><a href="hpc.html#debugging"><i class="fa fa-check"></i><b>10.7.1</b> Debugging</a></li>
<li class="chapter" data-level="10.7.2" data-path="hpc.html"><a href="hpc.html#drake-as-an-ordinary-job-scheduler"><i class="fa fa-check"></i><b>10.7.2</b> Drake as an ordinary job scheduler</a></li>
<li class="chapter" data-level="10.7.3" data-path="hpc.html"><a href="hpc.html#more-resources"><i class="fa fa-check"></i><b>10.7.3</b> More resources</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="hpc.html"><a href="hpc.html#footnotes"><i class="fa fa-check"></i><b>10.8</b> Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="triggers.html"><a href="triggers.html"><i class="fa fa-check"></i><b>11</b> Triggers: decision rules for building targets</a><ul>
<li class="chapter" data-level="11.1" data-path="triggers.html"><a href="triggers.html#what-are-triggers"><i class="fa fa-check"></i><b>11.1</b> What are triggers?</a></li>
<li class="chapter" data-level="11.2" data-path="triggers.html"><a href="triggers.html#customization"><i class="fa fa-check"></i><b>11.2</b> Customization</a></li>
<li class="chapter" data-level="11.3" data-path="triggers.html"><a href="triggers.html#a-more-practical-example"><i class="fa fa-check"></i><b>11.3</b> A more practical example</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="time.html"><a href="time.html"><i class="fa fa-check"></i><b>12</b> Time: logging, prediction, and strategy</a><ul>
<li class="chapter" data-level="12.1" data-path="time.html"><a href="time.html#predict-total-runtime"><i class="fa fa-check"></i><b>12.1</b> Predict total runtime</a></li>
<li class="chapter" data-level="12.2" data-path="time.html"><a href="time.html#strategize-your-high-performance-computing"><i class="fa fa-check"></i><b>12.2</b> Strategize your high-performance computing</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="store.html"><a href="store.html"><i class="fa fa-check"></i><b>13</b> Storage</a><ul>
<li class="chapter" data-level="13.1" data-path="store.html"><a href="store.html#caches"><i class="fa fa-check"></i><b>13.1</b> Caches</a></li>
<li class="chapter" data-level="13.2" data-path="store.html"><a href="store.html#hash-algorithms"><i class="fa fa-check"></i><b>13.2</b> Hash algorithms</a></li>
<li class="chapter" data-level="13.3" data-path="store.html"><a href="store.html#which-hash-algorithm-should-you-choose"><i class="fa fa-check"></i><b>13.3</b> Which hash algorithm should you choose?</a></li>
<li class="chapter" data-level="13.4" data-path="store.html"><a href="store.html#select-the-hash-algorithms-of-the-cache"><i class="fa fa-check"></i><b>13.4</b> Select the hash algorithms of the cache</a></li>
<li class="chapter" data-level="13.5" data-path="store.html"><a href="store.html#using-storr-directly"><i class="fa fa-check"></i><b>13.5</b> Using <code>storr</code> directly</a></li>
<li class="chapter" data-level="13.6" data-path="store.html"><a href="store.html#cleaning-up"><i class="fa fa-check"></i><b>13.6</b> Cleaning up</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>A</b> Frequently-asked questions</a></li>
<li class="chapter" data-level="B" data-path="caution.html"><a href="caution.html"><i class="fa fa-check"></i><b>B</b> Cautionary notes</a><ul>
<li class="chapter" data-level="B.1" data-path="caution.html"><a href="caution.html#projects-built-with-drake-4.4.0-are-not-back-compatible-with-drake-4.4.0."><i class="fa fa-check"></i><b>B.1</b> Projects built with drake &lt;= 4.4.0 are not back compatible with drake &gt; 4.4.0.</a></li>
<li class="chapter" data-level="B.2" data-path="caution.html"><a href="caution.html#workflow-plans"><i class="fa fa-check"></i><b>B.2</b> Workflow plans</a><ul>
<li class="chapter" data-level="B.2.1" data-path="caution.html"><a href="caution.html#externalizing-commands-in-r-script-files"><i class="fa fa-check"></i><b>B.2.1</b> Externalizing commands in R script files</a></li>
<li class="chapter" data-level="B.2.2" data-path="caution.html"><a href="caution.html#commands-are-not-perfectly-flexible."><i class="fa fa-check"></i><b>B.2.2</b> Commands are NOT perfectly flexible.</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="caution.html"><a href="caution.html#execution"><i class="fa fa-check"></i><b>B.3</b> Execution</a><ul>
<li class="chapter" data-level="B.3.1" data-path="caution.html"><a href="caution.html#install-drake-properly."><i class="fa fa-check"></i><b>B.3.1</b> Install <code>drake</code> properly.</a></li>
<li class="chapter" data-level="B.3.2" data-path="caution.html"><a href="caution.html#install-all-your-packages."><i class="fa fa-check"></i><b>B.3.2</b> Install all your packages.</a></li>
<li class="chapter" data-level="B.3.3" data-path="caution.html"><a href="caution.html#a-note-on-tidy-evaluation-1"><i class="fa fa-check"></i><b>B.3.3</b> A note on tidy evaluation</a></li>
<li class="chapter" data-level="B.3.4" data-path="caution.html"><a href="caution.html#find-and-diagnose-your-errors."><i class="fa fa-check"></i><b>B.3.4</b> Find and diagnose your errors.</a></li>
<li class="chapter" data-level="B.3.5" data-path="caution.html"><a href="caution.html#refresh-the-drake_config-list-early-and-often."><i class="fa fa-check"></i><b>B.3.5</b> Refresh the <code>drake_config()</code> list early and often.</a></li>
<li class="chapter" data-level="B.3.6" data-path="caution.html"><a href="caution.html#workflows-as-r-packages."><i class="fa fa-check"></i><b>B.3.6</b> Workflows as R packages.</a></li>
<li class="chapter" data-level="B.3.7" data-path="caution.html"><a href="caution.html#the-lazy_load-flag-does-not-work-with-parlapply-parallelism."><i class="fa fa-check"></i><b>B.3.7</b> The <code>lazy_load</code> flag does not work with <code>&quot;parLapply&quot;</code> parallelism.</a></li>
<li class="chapter" data-level="B.3.8" data-path="caution.html"><a href="caution.html#timeouts-may-be-unreliable."><i class="fa fa-check"></i><b>B.3.8</b> Timeouts may be unreliable.</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="caution.html"><a href="caution.html#dependencies"><i class="fa fa-check"></i><b>B.4</b> Dependencies</a><ul>
<li class="chapter" data-level="B.4.1" data-path="caution.html"><a href="caution.html#objects-that-contain-functions-may-rebuild-too-often"><i class="fa fa-check"></i><b>B.4.1</b> Objects that contain functions may rebuild too often</a></li>
<li class="chapter" data-level="B.4.2" data-path="caution.html"><a href="caution.html#the-magrittr-dot-.-is-always-ignored."><i class="fa fa-check"></i><b>B.4.2</b> The <code>magrittr</code> dot (<code>.</code>) is always ignored.</a></li>
<li class="chapter" data-level="B.4.3" data-path="caution.html"><a href="caution.html#dependencies-are-not-tracked-in-some-edge-cases."><i class="fa fa-check"></i><b>B.4.3</b> Dependencies are not tracked in some edge cases.</a></li>
<li class="chapter" data-level="B.4.4" data-path="caution.html"><a href="caution.html#dependencies-of-knitr-reports"><i class="fa fa-check"></i><b>B.4.4</b> Dependencies of <code>knitr</code> reports</a></li>
<li class="chapter" data-level="B.4.5" data-path="caution.html"><a href="caution.html#file-outputs-in-imported-functions."><i class="fa fa-check"></i><b>B.4.5</b> File outputs in imported functions.</a></li>
<li class="chapter" data-level="B.4.6" data-path="caution.html"><a href="caution.html#functions-produced-by-vectorize"><i class="fa fa-check"></i><b>B.4.6</b> Functions produced by <code>Vectorize()</code></a></li>
<li class="chapter" data-level="B.4.7" data-path="caution.html"><a href="caution.html#compiled-code-is-not-reproducibly-tracked."><i class="fa fa-check"></i><b>B.4.7</b> Compiled code is not reproducibly tracked.</a></li>
<li class="chapter" data-level="B.4.8" data-path="caution.html"><a href="caution.html#directories-folders-are-not-reproducibly-tracked."><i class="fa fa-check"></i><b>B.4.8</b> Directories (folders) are not reproducibly tracked.</a></li>
<li class="chapter" data-level="B.4.9" data-path="caution.html"><a href="caution.html#packages-are-not-tracked-as-dependencies."><i class="fa fa-check"></i><b>B.4.9</b> Packages are not tracked as dependencies.</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="caution.html"><a href="caution.html#high-performance-computing"><i class="fa fa-check"></i><b>B.5</b> High-performance computing</a><ul>
<li class="chapter" data-level="B.5.1" data-path="caution.html"><a href="caution.html#the-practical-utility-of-parallel-computing"><i class="fa fa-check"></i><b>B.5.1</b> The practical utility of parallel computing</a></li>
<li class="chapter" data-level="B.5.2" data-path="caution.html"><a href="caution.html#maximum-number-of-simultaneous-jobs"><i class="fa fa-check"></i><b>B.5.2</b> Maximum number of simultaneous jobs</a></li>
<li class="chapter" data-level="B.5.3" data-path="caution.html"><a href="caution.html#parallel-computing-on-windows"><i class="fa fa-check"></i><b>B.5.3</b> Parallel computing on Windows</a></li>
<li class="chapter" data-level="B.5.4" data-path="caution.html"><a href="caution.html#configuring-futurebatchtools-parallelism-for-clusters"><i class="fa fa-check"></i><b>B.5.4</b> Configuring <a href="https://github.com/HenrikBengtsson/future">future</a>/<a href="https://github.com/mllg/batchtools">batchtools</a> parallelism for clusters</a></li>
<li class="chapter" data-level="B.5.5" data-path="caution.html"><a href="caution.html#proper-makefiles-are-not-standalone."><i class="fa fa-check"></i><b>B.5.5</b> Proper Makefiles are not standalone.</a></li>
<li class="chapter" data-level="B.5.6" data-path="caution.html"><a href="caution.html#makefile-level-parallelism-for-imported-objects-and-files"><i class="fa fa-check"></i><b>B.5.6</b> Makefile-level parallelism for imported objects and files</a></li>
<li class="chapter" data-level="B.5.7" data-path="caution.html"><a href="caution.html#zombie-processes"><i class="fa fa-check"></i><b>B.5.7</b> Zombie processes</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="caution.html"><a href="caution.html#storage"><i class="fa fa-check"></i><b>B.6</b> Storage</a><ul>
<li class="chapter" data-level="B.6.1" data-path="caution.html"><a href="caution.html#projects-hosted-on-dropbox-and-similar-platforms"><i class="fa fa-check"></i><b>B.6.1</b> Projects hosted on Dropbox and similar platforms</a></li>
<li class="chapter" data-level="B.6.2" data-path="caution.html"><a href="caution.html#cache-customization-is-limited"><i class="fa fa-check"></i><b>B.6.2</b> Cache customization is limited</a></li>
<li class="chapter" data-level="B.6.3" data-path="caution.html"><a href="caution.html#runtime-predictions"><i class="fa fa-check"></i><b>B.6.3</b> Runtime predictions</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The drake R Package User Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="debug" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Debugging and testing drake projects</h1>
<p>This chapter is a guide to debugging and testing <code>drake</code> projects. Please also see the <a href="caution.html#caution">compendium of cautionary notes</a>, which addresses <code>drake</code>’s known edge cases, pitfalls, and weaknesses that may or may not be fixed in future releases. For the most up-to-date information on unhandled edge cases, please visit the <a href="https://github.com/ropensci/drake/issues">issue tracker</a>, where you can submit your own bug reports as well. Be sure to search the closed issues too, especially if you are not using the most up-to-date development version.</p>
<div id="the-configuration-list" class="section level2">
<h2><span class="header-section-number">9.1</span> The configuration list</h2>
<p>Most of <code>drake</code>’s functions rely on a central <code>config</code> list. An understanding of <code>config</code> will help you grasp the internals. <code>make()</code> and <code>drake_config()</code> both return the <code>config</code> list. Unlike <code>make()</code>, <code>drake_config()</code>’s return value is visible, and its only purpose is to construct your <code>config</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load_mtcars_example</span>() <span class="co"># Get the code with drake_example(&quot;mtcars&quot;).</span>
config &lt;-<span class="st"> </span><span class="kw">drake_config</span>(my_plan)

<span class="kw">sort</span>(<span class="kw">names</span>(config))
##  [1] &quot;all_imports&quot;        &quot;all_targets&quot;        &quot;args&quot;              
##  [4] &quot;cache&quot;              &quot;cache_log_file&quot;     &quot;cache_path&quot;        
##  [7] &quot;caching&quot;            &quot;command&quot;            &quot;console_log_file&quot;  
## [10] &quot;cpu&quot;                &quot;elapsed&quot;            &quot;ensure_workers&quot;    
## [13] &quot;envir&quot;              &quot;evaluator&quot;          &quot;fetch_cache&quot;       
## [16] &quot;garbage_collection&quot; &quot;graph&quot;              &quot;hook&quot;              
## [19] &quot;jobs&quot;               &quot;jobs_imports&quot;       &quot;jobs_targets&quot;      
## [22] &quot;keep_going&quot;         &quot;lazy_load&quot;          &quot;log_progress&quot;      
## [25] &quot;long_hash_algo&quot;     &quot;makefile_path&quot;      &quot;parallelism&quot;       
## [28] &quot;plan&quot;               &quot;prepend&quot;            &quot;prework&quot;           
## [31] &quot;pruning_strategy&quot;   &quot;recipe_command&quot;     &quot;retries&quot;           
## [34] &quot;seed&quot;               &quot;session&quot;            &quot;session_info&quot;      
## [37] &quot;short_hash_algo&quot;    &quot;skip_imports&quot;       &quot;skip_safety_checks&quot;
## [40] &quot;skip_targets&quot;       &quot;targets&quot;            &quot;timeout&quot;           
## [43] &quot;trigger&quot;            &quot;verbose&quot;</code></pre>
<p>The fields of <code>config</code> mostly arguments to <code>make()</code> and are documented there. The rest of the fields are as follows.</p>
<ul>
<li><code>graph</code>: An <a href="https://github.com/igraph/rigraph">igraph</a> object with the directed acyclic graph (DAG) of the workflow.</li>
<li><code>inventory</code>: A running list of the cached objects in each <code>storr</code> namespace. Maintaining this list helps avoid repeated calls to <code>config$cache$list()</code>, which increases speed.</li>
<li><code>long_hash_algo</code>: Name of the long hash algorithm used throughout <code>make()</code>. Used to generate hash keys that <em>will not</em> become the names of files. See the <a href="store.html#store">custom storage guide</a> for details.</li>
<li><code>seed</code>: The random number generator seed taken from the user’s R session. Each target is built reproducibly using a deterministic function of this seed, and the build does not change the seed outside the scope of the target’s command.</li>
<li><code>short_hash_algo</code>: Name of the short hash algorithm used throughout <code>make()</code>. Used to generate hash keys that could become names of files. See the <a href="store.html#store">custom storage guide</a> for details.</li>
</ul>
<p>Early in <code>make()</code>, the <code>config</code> list is stored in the cache. You can retrieve it with</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">read_drake_config</span>()</code></pre>
<p>and you can access parts of it with some companion functions.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">read_drake_graph</span>()
<span class="kw">read_drake_plan</span>()</code></pre>
</div>
<div id="plan-your-work." class="section level2">
<h2><span class="header-section-number">9.2</span> Plan your work.</h2>
<div id="workflow-plan-data-frames" class="section level3">
<h3><span class="header-section-number">9.2.1</span> Workflow plan data frames</h3>
<p>The workflow plan data frame is your responsibility, and it takes effort and care. Fortunately, functions in <code>drake</code> can help. You can check the plan for formatting issues, missing input files, etc. with the <code>check_plan()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load_mtcars_example</span>() <span class="co"># Get the code with drake_example(&quot;mtcars&quot;).</span>
my_plan
## # A tibble: 15 x 2
##    target                 command                                         
##    &lt;chr&gt;                  &lt;chr&gt;                                           
##  1 report                 &quot;knit(knitr_in(\&quot;report.Rmd\&quot;), file_out(\&quot;repo…
##  2 small                  simulate(48)                                    
##  3 large                  simulate(64)                                    
##  4 regression1_small      reg1(small)                                     
##  5 regression1_large      reg1(large)                                     
##  6 regression2_small      reg2(small)                                     
##  7 regression2_large      reg2(large)                                     
##  8 summ_regression1_small suppressWarnings(summary(regression1_small$resi…
##  9 summ_regression1_large suppressWarnings(summary(regression1_large$resi…
## 10 summ_regression2_small suppressWarnings(summary(regression2_small$resi…
## 11 summ_regression2_large suppressWarnings(summary(regression2_large$resi…
## 12 coef_regression1_small suppressWarnings(summary(regression1_small))$co…
## 13 coef_regression1_large suppressWarnings(summary(regression1_large))$co…
## 14 coef_regression2_small suppressWarnings(summary(regression2_small))$co…
## 15 coef_regression2_large suppressWarnings(summary(regression2_large))$co…

<span class="kw">check_plan</span>(my_plan) <span class="co"># No issues.</span></code></pre>
</div>
<div id="visualize-your-workflow." class="section level3">
<h3><span class="header-section-number">9.2.2</span> Visualize your workflow.</h3>
<p>After quality-checking your plan, you should check that you understand how the steps of your workflow are interconnected. The web of dependencies affects which targets are built and which ones are skipped during <code>make()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">## Hover, click, drag, zoom, and pan. See args &#39;from&#39; and &#39;to&#39;.
config &lt;-<span class="st"> </span><span class="kw">drake_config</span>(my_plan)
<span class="kw">vis_drake_graph</span>(config, <span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>, <span class="dt">height =</span> <span class="st">&quot;500px&quot;</span>)</code></pre>
<div id="htmlwidget-24e98bce2511b820e238" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-24e98bce2511b820e238">{"x":{"nodes":{"id":["\"report.md\"","\"report.Rmd\"","coef_regression1_large","coef_regression1_small","coef_regression2_large","coef_regression2_small","data.frame","knit","large","lm","mtcars","nrow","random_rows","reg1","reg2","regression1_large","regression1_small","regression2_large","regression2_small","report","sample.int","simulate","small","summ_regression1_large","summ_regression1_small","summ_regression2_large","summ_regression2_small","summary","suppressWarnings"],"deps":[{},null,{},{},{},{},null,null,{},null,null,null,{},{},{},{},{},{},{},{},null,{},{},{},{},{},{},null,null],"trigger":[{},null,{},{},{},{},null,null,{},null,null,null,null,null,null,{},{},{},{},{},null,null,{},{},{},{},{},null,null],"label":["\"report.md\"","\"report.Rmd\"\n0.003s","coef_regression1_large","coef_regression1_small","coef_regression2_large","coef_regression2_small","data.frame\n0.052s","knit\n0.035s","large","lm\n0.018s","mtcars\n0.004s","nrow\n0.014s","random_rows\n0.004s","reg1\n0.003s","reg2\n0.004s","regression1_large","regression1_small","regression2_large","regression2_small","report","sample.int\n0.014s","simulate\n0.004s","small","summ_regression1_large","summ_regression1_small","summ_regression2_large","summ_regression2_small","summary\n0.013s","suppressWarnings\n0.014s"],"command":["knit(knitr_in(\"report.Rmd\"), file_out(\"report.md\"), quiet = TRUE)",null,"suppressWarnings(summary(regression1_large))$coefficients","suppressWarnings(summary(regression1_small))$coefficients","suppressWarnings(summary(regression2_large))$coefficients","suppressWarnings(summary(regression2_small))$coefficients",null,null,"simulate(64)",null,null,null,null,null,null,"reg1(large)","reg1(small)","reg2(large)","reg2(small)","knit(knitr_in(\"report.Rmd\"), file_out(\"report.md\"), quiet = TRUE)",null,null,"simulate(48)","suppressWarnings(summary(regression1_large$residuals))","suppressWarnings(summary(regression1_small$residuals))","suppressWarnings(summary(regression2_large$residuals))","suppressWarnings(summary(regression2_small$residuals))",null,null],"status":["outdated","imported","outdated","outdated","outdated","outdated","imported","imported","outdated","imported","imported","imported","imported","imported","imported","outdated","outdated","outdated","outdated","outdated","imported","imported","outdated","outdated","outdated","outdated","outdated","imported","imported"],"type":["file","file","object","object","object","object","function","function","object","function","object","function","function","function","function","object","object","object","object","object","function","function","object","object","object","object","object","function","function"],"font.size":[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],"color":["#000000","#1874CD","#000000","#000000","#000000","#000000","#1874CD","#1874CD","#000000","#1874CD","#1874CD","#1874CD","#1874CD","#1874CD","#1874CD","#000000","#000000","#000000","#000000","#000000","#1874CD","#1874CD","#000000","#000000","#000000","#000000","#000000","#1874CD","#1874CD"],"shape":["square","square","dot","dot","dot","dot","triangle","triangle","dot","triangle","dot","triangle","triangle","triangle","triangle","dot","dot","dot","dot","dot","triangle","triangle","dot","dot","dot","dot","dot","triangle","triangle"],"level":[8,1,6,6,6,6,1,1,4,1,1,1,2,2,2,5,5,5,5,7,1,3,4,6,6,6,6,1,1],"hover_label":["knit(knitr_in(\"report.Rmd\"), file_out(\"report.md\"), quiet = TRUE)","---\ntitle: \"Final results report for the mtcars example\"\nauthor: You\noutput: html_document\n---\n\n# The weight and fuel efficiency of cars\n\nIs there an association between the weight and the fuel efficiency of cars? To find out, we use the `mtcars` ...","suppressWarnings(summary(regression1_large))$coefficients","suppressWarnings(summary(regression1_small))$coefficients","suppressWarnings(summary(regression2_large))$coefficients","suppressWarnings(summary(regression2_small))$coefficients","function (..., row.names = NULL, check.rows = FALSE, check.names = TRUE, \n    fix.empty.names = TRUE, stringsAsFactors = default.stringsAsFactors()) \n{\n    data.row.names <- if (check.rows && is.null(row.names)) \n        function(current, new, i) ...","function (input, output = NULL, tangle = FALSE, text = NULL, \n    quiet = FALSE, envir = parent.frame(), encoding = getOption(\"encoding\")) \n{\n    in.file = !missing(input) && (is.character(input) || prod(inherits(input, \n        c(\"file\", \"connect...","simulate(64)","function (formula, data, subset, weights, na.action, method = \"qr\", \n    model = TRUE, x = FALSE, y = FALSE, qr = TRUE, singular.ok = TRUE, \n    contrasts = NULL, offset, ...) \n{\n    ret.x <- x\n    ret.y <- y\n    cl <- match.call()\n    mf <- match...","mtcars","function (x) \ndim(x)[1L]","function (data, n) \n{\n    data[sample.int(n = nrow(data), size = n, replace = TRUE), \n        ]\n}","function (d) \n{\n    lm(y ~ +x, data = d)\n}","function (d) \n{\n    d$x2 <- d$x^2\n    lm(y ~ x2, data = d)\n}","reg1(large)","reg1(small)","reg2(large)","reg2(small)","knit(knitr_in(\"report.Rmd\"), file_out(\"report.md\"), quiet = TRUE)","function (n, size = n, replace = FALSE, prob = NULL, useHash = (!replace && \n    is.null(prob) && size <= n/2 && n > 1e+07)) \n{\n    if (useHash) \n        .Internal(sample2(n, size))\n    else .Internal(sample(n, size, replace, prob))\n}","function (n) \n{\n    data <- random_rows(data = mtcars, n = n)\n    data.frame(x = data$wt, y = data$mpg)\n}","simulate(48)","suppressWarnings(summary(regression1_large$residuals))","suppressWarnings(summary(regression1_small$residuals))","suppressWarnings(summary(regression2_large$residuals))","suppressWarnings(summary(regression2_small$residuals))","function (object, ...) \nUseMethod(\"summary\")","function (expr) \n{\n    ops <- options(warn = -1)\n    on.exit(options(ops))\n    withCallingHandlers(expr, warning = function(w) invokeRestart(\"muffleWarning\"))\n}"],"x":[-1,-0.826086956521739,0.826086956521739,0.347826086956522,-0.391304347826087,-0.521739130434783,-0.478260869565217,-0.739130434782609,-0.347826086956522,0.0869565217391304,-0.391304347826087,-0.565217391304348,-0.347826086956522,0.739130434782609,-0.478260869565217,0.782608695652174,0.652173913043478,-0.391304347826087,-0.260869565217391,-1,-0.652173913043478,-0.260869565217391,-0.217391304347826,0.652173913043478,1,-0.0869565217391305,0.434782608695652,0.608695652173913,0.521739130434783],"y":[1,-1,0.428571428571429,0.428571428571429,0.428571428571429,0.428571428571429,-1,-1,-0.142857142857143,-1,-1,-1,-0.714285714285714,-0.714285714285714,-0.714285714285714,0.142857142857143,0.142857142857143,0.142857142857143,0.142857142857143,0.714285714285714,-1,-0.428571428571429,-0.142857142857143,0.428571428571429,0.428571428571429,0.428571428571429,0.428571428571429,-1,-1]},"edges":{"from":["nrow","sample.int","data.frame","summary","summary","summary","summary","summary","summary","summary","summary","lm","lm","mtcars","random_rows","\"report.Rmd\"","coef_regression2_small","knit","large","large","large","small","small","small","simulate","simulate","reg1","reg1","reg2","reg2","regression1_small","regression1_small","suppressWarnings","suppressWarnings","suppressWarnings","suppressWarnings","suppressWarnings","suppressWarnings","suppressWarnings","suppressWarnings","regression1_large","regression1_large","regression2_small","regression2_small","regression2_large","regression2_large","report"],"to":["random_rows","random_rows","simulate","coef_regression2_small","summ_regression1_small","summ_regression1_large","summ_regression2_small","summ_regression2_large","coef_regression1_small","coef_regression1_large","coef_regression2_large","reg1","reg2","simulate","simulate","report","report","report","regression1_large","regression2_large","report","regression1_small","regression2_small","report","large","small","regression1_small","regression1_large","regression2_small","regression2_large","summ_regression1_small","coef_regression1_small","coef_regression2_small","summ_regression1_small","summ_regression1_large","summ_regression2_small","summ_regression2_large","coef_regression1_small","coef_regression1_large","coef_regression2_large","summ_regression1_large","coef_regression1_large","coef_regression2_small","summ_regression2_small","summ_regression2_large","coef_regression2_large","\"report.md\""],"file":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,null],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"layout":{"hierarchical":{"enabled":true,"direction":"LR"}},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"navigationButtons":true,"hover":true}},"groups":null,"width":"100%","height":"500px","idselection":{"enabled":false},"byselection":{"enabled":false},"main":{"text":"Dependency graph","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["Outdated","Imported","Object","Function","File"],"color":["#000000","#1874CD","#888888","#888888","#888888"],"shape":["dot","dot","dot","triangle","square"],"font.color":["black","black","black","black","black"],"font.size":[20,20,20,20,20],"id":[2,5,7,8,9]},"nodesToDataframe":true},"igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","events":{"hoverNode":"function(e){\n        var label_info = this.body.data.nodes.get({\n          fields: ['label', 'hover_label'],\n          filter: function (item) {\n            return item.id === e.node\n          },\n          returnType :'Array'\n        });\n        this.body.data.nodes.update({\n          id: e.node,\n          label : label_info[0].hover_label,\n          hover_label : label_info[0].label\n        });\n      }","blurNode":"function(e){\n        var label_info = this.body.data.nodes.get({\n          fields: ['label', 'hover_label'],\n          filter: function (item) {\n            return item.id === e.node\n          },\n          returnType :'Array'\n        });\n        this.body.data.nodes.update({\n          id: e.node,\n          label : label_info[0].hover_label,\n          hover_label : label_info[0].label\n        });\n      }"}},"evals":["events.hoverNode","events.blurNode"],"jsHooks":[]}</script>
<p>See the <a href="vis.html#vis">visualization chapter</a> to learn more about how graphing can help (for example, how to visualize small subgraphs). If you want to take control of your own <a href="http://datastorm-open.github.io/visNetwork/">visNetwork graph</a>, use the <code>drake_graph_info()</code> function to get data frames of nodes, edges, and legend nodes.</p>
</div>
<div id="check-dependency-relationships." class="section level3">
<h3><span class="header-section-number">9.2.3</span> Check dependency relationships.</h3>
<p>Programmatically, several functions can help you check immediate dependencies.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">deps_code</span>(reg2)
## $globals
## [1] &quot;lm&quot;

## knitr_in() makes sure your target depends on `report.Rmd`
## and any dependencies loaded with loadd() and readd()
## in the report&#39;s active code chunks.
<span class="kw">deps_code</span>(my_plan<span class="op">$</span>command[<span class="dv">1</span>])
## $globals
## [1] &quot;knit&quot;
## 
## $loadd
## [1] &quot;large&quot;
## 
## $readd
## [1] &quot;small&quot;                  &quot;coef_regression2_small&quot;
## 
## $knitr_in
## [1] &quot;\&quot;report.Rmd\&quot;&quot;
## 
## $file_out
## [1] &quot;\&quot;report.md\&quot;&quot;

<span class="kw">deps_code</span>(my_plan<span class="op">$</span>command[<span class="kw">nrow</span>(my_plan)])
## $globals
## [1] &quot;suppressWarnings&quot;  &quot;summary&quot;           &quot;regression2_large&quot;</code></pre>
<p><code>Drake</code> takes special precautions so that a target/import does not depend on itself. For example, <code>deps_code(f)</code> might return <code>&quot;f&quot;</code> if <code>f()</code> is a recursive function, but <code>make()</code> just ignores this conflict and runs as expected. In other words, <code>make()</code> automatically removes all self-referential loops in the dependency network.</p>
<p>List all the reproducibly-tracked objects and files, including imports and targets.</p>
<pre class="sourceCode r"><code class="sourceCode r">config &lt;-<span class="st"> </span><span class="kw">drake_config</span>(my_plan)
<span class="kw">tracked</span>(config)
##  [1] &quot;\&quot;report.md\&quot;&quot;          &quot;\&quot;report.Rmd\&quot;&quot;        
##  [3] &quot;coef_regression1_large&quot; &quot;coef_regression1_small&quot;
##  [5] &quot;coef_regression2_large&quot; &quot;coef_regression2_small&quot;
##  [7] &quot;data.frame&quot;             &quot;knit&quot;                  
##  [9] &quot;large&quot;                  &quot;lm&quot;                    
## [11] &quot;mtcars&quot;                 &quot;nrow&quot;                  
## [13] &quot;random_rows&quot;            &quot;reg1&quot;                  
## [15] &quot;reg2&quot;                   &quot;regression1_large&quot;     
## [17] &quot;regression1_small&quot;      &quot;regression2_large&quot;     
## [19] &quot;regression2_small&quot;      &quot;report&quot;                
## [21] &quot;sample.int&quot;             &quot;simulate&quot;              
## [23] &quot;small&quot;                  &quot;summ_regression1_large&quot;
## [25] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;
## [27] &quot;summ_regression2_small&quot; &quot;summary&quot;               
## [29] &quot;suppressWarnings&quot;</code></pre>
</div>
<div id="outdated-up-to-date-and-missing-items" class="section level3">
<h3><span class="header-section-number">9.2.4</span> Outdated, up to date, and missing items</h3>
<p><code>missed()</code> reports import dependencies missing from your environment</p>
<pre class="sourceCode r"><code class="sourceCode r">config &lt;-<span class="st"> </span><span class="kw">drake_config</span>(my_plan, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
<span class="kw">missed</span>(config) <span class="co"># Nothing is missing right now.</span>
## character(0)</code></pre>
<p><code>outdated()</code> reports any targets that are outdated, plus any downstream targets that depend on them.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">outdated</span>(config)
##  [1] &quot;coef_regression1_large&quot; &quot;coef_regression1_small&quot;
##  [3] &quot;coef_regression2_large&quot; &quot;coef_regression2_small&quot;
##  [5] &quot;large&quot;                  &quot;regression1_large&quot;     
##  [7] &quot;regression1_small&quot;      &quot;regression2_large&quot;     
##  [9] &quot;regression2_small&quot;      &quot;report&quot;                
## [11] &quot;small&quot;                  &quot;summ_regression1_large&quot;
## [13] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;
## [15] &quot;summ_regression2_small&quot;</code></pre>
<p>To find out why a target is out of date, you can load the <a href="https://github.com/richfitz/storr">storr</a>-based cache and compare the appropriate hash keys to the output of <code>dependency_profile()</code>. To use <code>dependency_profile()</code>, be sure to supply the master configuration list as the <code>config</code> argument. The same is true for <code>drake_meta()</code>, another alternative.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load_mtcars_example</span>() <span class="co"># Get the code with drake_example(&quot;mtcars&quot;).</span>
config &lt;-<span class="st"> </span><span class="kw">make</span>(my_plan, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
## Change a dependency.
reg2 &lt;-<span class="st"> </span><span class="cf">function</span>(d) {
  d<span class="op">$</span>x3 &lt;-<span class="st"> </span>d<span class="op">$</span>x <span class="op">^</span><span class="st"> </span><span class="dv">3</span>
  <span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x3, <span class="dt">data =</span> d)
}
<span class="kw">outdated</span>(config)
## [1] &quot;coef_regression2_large&quot; &quot;coef_regression2_small&quot;
## [3] &quot;regression2_large&quot;      &quot;regression2_small&quot;     
## [5] &quot;report&quot;                 &quot;summ_regression2_large&quot;
## [7] &quot;summ_regression2_small&quot;

<span class="kw">dependency_profile</span>(<span class="dt">target =</span> <span class="st">&quot;regression2_small&quot;</span>, <span class="dt">config =</span> config)
## $cached_command
## [1] &quot;{\n reg2(small) \n}&quot;
## 
## $current_command
## [1] &quot;{\n reg2(small) \n}&quot;
## 
## $cached_file_modification_time
## NULL
## 
## $cached_input_file_hash
## [1] &quot;01234566814cd2a2b3cd7c19c907964b4a4f018a19ec224788d9edb74d7376df&quot;
## 
## $current_input_file_hash
## [1] &quot;01234566814cd2a2b3cd7c19c907964b4a4f018a19ec224788d9edb74d7376df&quot;
## 
## $cached_output_file_hash
## [1] &quot;01234566814cd2a2b3cd7c19c907964b4a4f018a19ec224788d9edb74d7376df&quot;
## 
## $current_output_file_hash
## [1] &quot;01234566814cd2a2b3cd7c19c907964b4a4f018a19ec224788d9edb74d7376df&quot;
## 
## $cached_dependency_hash
## [1] &quot;ffe33a15d52e57557072fb9eb57d5d7ecc1f95aaa4d61322b726121ca980df74&quot;
## 
## $current_dependency_hash
## [1] &quot;80a7eb5288828c2f5816caf84db9ebf97d423021e4682949705d682586218012&quot;
## 
## $hashes_of_dependencies
##              small               reg2 
## &quot;7d836504e5060e6d&quot; &quot;d47109544c89ca7a&quot;

<span class="kw">drake_meta</span>(<span class="dt">target =</span> <span class="st">&quot;regression2_small&quot;</span>, <span class="dt">config =</span> config)
## $name
## [1] &quot;regression2_small&quot;
## 
## $target
## [1] &quot;regression2_small&quot;
## 
## $imported
## [1] FALSE
## 
## $foreign
## [1] TRUE
## 
## $missing
## [1] FALSE
## 
## $seed
## [1] 1034257256
## 
## $trigger
## $trigger$depend
## [1] TRUE
## 
## $trigger$condition
## NULL
## 
## $trigger$file
## [1] TRUE
## 
## $trigger$command
## [1] TRUE
## 
## $trigger$change
## NULL
## 
## 
## $command
## [1] &quot;{\n reg2(small) \n}&quot;
## 
## $dependency_hash
## [1] &quot;0675307b21b618a78b59a38659cef53b7de69d3bc02d8a6c4b55f4b050a1bb97&quot;
## 
## $input_file_hash
## [1] &quot;01234566814cd2a2b3cd7c19c907964b4a4f018a19ec224788d9edb74d7376df&quot;
## 
## $output_file_hash
## [1] &quot;01234566814cd2a2b3cd7c19c907964b4a4f018a19ec224788d9edb74d7376df&quot;

config<span class="op">$</span>cache<span class="op">$</span><span class="kw">get_hash</span>(<span class="dt">key =</span> <span class="st">&quot;small&quot;</span>, <span class="dt">namespace =</span> <span class="st">&quot;kernels&quot;</span>) <span class="co"># same</span>
## [1] &quot;7d836504e5060e6d&quot;

config<span class="op">$</span>cache<span class="op">$</span><span class="kw">get_hash</span>(<span class="dt">key =</span> <span class="st">&quot;small&quot;</span>) <span class="co"># same</span>
## [1] &quot;7d836504e5060e6d&quot;

config<span class="op">$</span>cache<span class="op">$</span><span class="kw">get_hash</span>(<span class="dt">key =</span> <span class="st">&quot;reg2&quot;</span>, <span class="dt">namespace =</span> <span class="st">&quot;kernels&quot;</span>) <span class="co"># same</span>
## [1] &quot;d47109544c89ca7a&quot;

config<span class="op">$</span>cache<span class="op">$</span><span class="kw">get_hash</span>(<span class="dt">key =</span> <span class="st">&quot;reg2&quot;</span>) <span class="co"># different</span>
## [1] &quot;1eb28f47936e3c65&quot;</code></pre>
<p>In <code>drake</code>, the “kernel” of a target or import is the piece of the output that is reproducibly tracked. For ordinary R objects, the kernel is just the object itself. For custom external files, it is a separate hash. But for functions, the kernel is the deparsed body of the function, together with the dependency hash if the function is imported (see <code>drake:::store_function()</code>).</p>
<p>The internal functions <code>drake:::meta()</code> and <code>drake:::meta_list()</code> compute the metadata on each target that <code>drake</code> uses to decide which targets to build and which to skip (via <code>drake:::should_build_target()</code>). Then, after the target/import is processed, <code>drake:::finish_meta()</code> updates the metadata (except for the <code>$missing</code> element) before it is cached. See <code>diagnose()</code> to read available metadata, along with any errors, warnings, and messages generated during the build.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(<span class="kw">diagnose</span>(small))
## List of 14
##  $ name            : chr &quot;small&quot;
##  $ target          : chr &quot;small&quot;
##  $ imported        : logi FALSE
##  $ foreign         : logi TRUE
##  $ missing         : logi TRUE
##  $ seed            : num 1.95e+09
##  $ trigger         :List of 5
##   ..$ depend   : logi TRUE
##   ..$ condition: NULL
##   ..$ file     : logi TRUE
##   ..$ command  : logi TRUE
##   ..$ change   : NULL
##  $ command         : chr &quot;{\n simulate(48) \n}&quot;
##  $ dependency_hash : chr &quot;eb89933a9211e556671c06c5018dcdb7efdad4593b4adff4f88ee6a34de61f7f&quot;
##  $ input_file_hash : chr &quot;01234566814cd2a2b3cd7c19c907964b4a4f018a19ec224788d9edb74d7376df&quot;
##  $ output_file_hash: chr &quot;01234566814cd2a2b3cd7c19c907964b4a4f018a19ec224788d9edb74d7376df&quot;
##  $ start           : &#39;proc_time&#39; Named num [1:5] 54.04 6.61 80.38 13.24 7.1
##   ..- attr(*, &quot;names&quot;)= chr [1:5] &quot;user.self&quot; &quot;sys.self&quot; &quot;elapsed&quot; &quot;user.child&quot; ...
##  $ time_command    :&#39;data.frame&#39;:    1 obs. of  5 variables:
##   ..$ item   : chr &quot;small&quot;
##   ..$ type   : chr &quot;target&quot;
##   ..$ elapsed: num 0
##   ..$ user   : num 0.004
##   ..$ system : num 0
##  $ time_build      :&#39;data.frame&#39;:    1 obs. of  5 variables:
##   ..$ item   : chr &quot;small&quot;
##   ..$ type   : chr &quot;target&quot;
##   ..$ elapsed: num 0.007
##   ..$ user   : num 0.004
##   ..$ system : num 0

<span class="kw">str</span>(<span class="kw">diagnose</span>(<span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">report.md</span><span class="ch">\&quot;</span><span class="st">&quot;</span>))
## List of 15
##  $ name            : chr &quot;\&quot;report.md\&quot;&quot;
##  $ target          : chr &quot;report&quot;
##  $ imported        : logi FALSE
##  $ foreign         : logi TRUE
##  $ missing         : logi TRUE
##  $ seed            : num 1.1e+09
##  $ trigger         :List of 5
##   ..$ depend   : logi TRUE
##   ..$ condition: NULL
##   ..$ file     : logi TRUE
##   ..$ command  : logi TRUE
##   ..$ change   : NULL
##  $ command         : chr &quot;{\n knit(knitr_in(\&quot;report.Rmd\&quot;), file_out(\&quot;report.md\&quot;), quiet = TRUE) \n}&quot;
##  $ dependency_hash : chr &quot;72c4f6105d879c17660c28d7bb2e55adbccf19303234a10a32c66348f1bafe03&quot;
##  $ input_file_hash : chr &quot;5e0b77b3e058a55dcc9ffccb67851732560a363151da0b2c5778dbee366ad455&quot;
##  $ output_file_hash: chr &quot;0f173e0c5db4474a8d798744617b75e1a12f2a4a5c4f80e165a09c9d8cb3c256&quot;
##  $ start           : &#39;proc_time&#39; Named num [1:5] 54.27 6.63 80.64 13.24 7.1
##   ..- attr(*, &quot;names&quot;)= chr [1:5] &quot;user.self&quot; &quot;sys.self&quot; &quot;elapsed&quot; &quot;user.child&quot; ...
##  $ time_command    :&#39;data.frame&#39;:    1 obs. of  5 variables:
##   ..$ item   : chr &quot;\&quot;report.md\&quot;&quot;
##   ..$ type   : chr &quot;target&quot;
##   ..$ elapsed: num 0.063
##   ..$ user   : num 0.056
##   ..$ system : num 0.008
##  $ mtime           : POSIXct[1:1], format: &quot;2018-08-02 17:52:45&quot;
##  $ time_build      :&#39;data.frame&#39;:    1 obs. of  5 variables:
##   ..$ item   : chr &quot;\&quot;report.md\&quot;&quot;
##   ..$ type   : chr &quot;target&quot;
##   ..$ elapsed: num 0.069
##   ..$ user   : num 0.06
##   ..$ system : num 0.008</code></pre>
<p>If your target’s last build succeeded, then <code>diagnose(your_target)</code> has the most current information from that build. But if your target failed, then only <code>diagnose(your_target)$error</code>, <code>diagnose(your_target)$warnings</code>, and <code>diagnose(your_target)$messages</code> correspond to the failure, and all the other metadata correspond to the last build that completed without an error.</p>
</div>
</div>
<div id="skipping-imports" class="section level2">
<h2><span class="header-section-number">9.3</span> Skipping imports</h2>
<p>It may be time-consuming to process all the imported objects and files, so for testing purposes, if you processed the imports once, you can choose to jump straight to the targets. This is not recommended for the production version</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">clean</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>)

<span class="kw">make</span>(my_plan, <span class="dt">skip_imports =</span> <span class="ot">TRUE</span>)
## target large
## target small
## target regression1_large
## target regression2_large
## target regression1_small
## target regression2_small
## target summ_regression1_large
## target coef_regression1_large
## target summ_regression2_large
## target coef_regression2_large
## target summ_regression1_small
## target coef_regression1_small
## target coef_regression2_small
## target summ_regression2_small
## target report
## Skipped the imports. If some imports are not already cached, targets could be out of date.</code></pre>
</div>
<div id="impose-timeouts-and-retries" class="section level2">
<h2><span class="header-section-number">9.4</span> Impose timeouts and retries</h2>
<p>See the <code>timeout</code>, <code>cpu</code>, <code>elapsed</code>, and <code>retries</code> argument to <code>make()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">clean</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>)
f &lt;-<span class="st"> </span><span class="cf">function</span>(...){
  <span class="kw">Sys.sleep</span>(<span class="dv">1</span>)
}
debug_plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="kw">f</span>(x))
debug_plan
## # A tibble: 2 x 2
##   target command
## * &lt;chr&gt;  &lt;chr&gt;  
## 1 x      1      
## 2 y      f(x)

withr<span class="op">::</span><span class="kw">with_message_sink</span>(
  <span class="kw">stdout</span>(),
  <span class="kw">make</span>(debug_plan, <span class="dt">timeout =</span> <span class="fl">1e-3</span>, <span class="dt">retries =</span> <span class="dv">2</span>)
)
## target x
## target y
## retry y: 1 of 2
## retry y: 2 of 2
## fail y
## Error: Target `y` failed. Call `diagnose(y)` for details. Error message:
##   reached elapsed time limit
## Warning: No message sink to remove.</code></pre>
<p>To tailor these settings to each individual target, create new <code>timeout</code>, <code>cpu</code>, <code>elapsed</code>, or <code>retries</code> columns in your workflow plan. These columns override the analogous arguments to <code>make()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">clean</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>)
debug_plan<span class="op">$</span>timeout &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1e-3</span>, <span class="fl">2e-3</span>)
debug_plan<span class="op">$</span>retries &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>

debug_plan
## # A tibble: 2 x 4
##   target command timeout retries
## * &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;   &lt;int&gt;
## 1 x      1         0.001       1
## 2 y      f(x)      0.002       2

withr<span class="op">::</span><span class="kw">with_message_sink</span>(
  <span class="dt">new =</span> <span class="kw">stdout</span>(),
  <span class="kw">make</span>(debug_plan, <span class="dt">timeout =</span> <span class="ot">Inf</span>, <span class="dt">retries =</span> <span class="dv">0</span>)
)
## Unloading targets from environment:
##   x
## target x
## target y
## fail y
## Error: Target `y` failed. Call `diagnose(y)` for details. Error message:
##   reached elapsed time limit
## Warning: No message sink to remove.</code></pre>
</div>
<div id="diagnose-failures." class="section level2">
<h2><span class="header-section-number">9.5</span> Diagnose failures.</h2>
<p><code>Drake</code> records diagnostic metadata on all your targets, including the latest errors, warnings, messages, and other bits of context.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">diagnose</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) <span class="co"># Targets with available metadata.</span>
## [1] &quot;f&quot;         &quot;Sys.sleep&quot; &quot;x&quot;         &quot;y&quot;

f &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  <span class="cf">if</span> (x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>){
    <span class="kw">stop</span>(<span class="st">&quot;`x` cannot be negative.&quot;</span>)
  }
  x
}
bad_plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(
  <span class="dt">a =</span> <span class="dv">12</span>,
  <span class="dt">b =</span> <span class="op">-</span>a,
  <span class="dt">my_target =</span> <span class="kw">f</span>(b)
)

bad_plan
## # A tibble: 3 x 2
##   target    command
## * &lt;chr&gt;     &lt;chr&gt;  
## 1 a         12     
## 2 b         -a     
## 3 my_target f(b)

withr<span class="op">::</span><span class="kw">with_message_sink</span>(
  <span class="dt">new =</span> <span class="kw">stdout</span>(),
  <span class="kw">make</span>(bad_plan)
)
## target a
## target b
## target my_target
## fail my_target
## Error: Target `my_target` failed. Call `diagnose(my_target)` for details. Error message:
##   `x` cannot be negative.
## Warning: No message sink to remove.

<span class="kw">failed</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) <span class="co"># from the last make() only</span>
## [1] &quot;my_target&quot;

## See also warnings and messages.
error &lt;-<span class="st"> </span><span class="kw">diagnose</span>(my_target, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)<span class="op">$</span>error

error<span class="op">$</span>message
## [1] &quot;`x` cannot be negative.&quot;

error<span class="op">$</span>call
## f(b)

error<span class="op">$</span>calls <span class="co"># View the traceback.</span>
## [[1]]
## local({
##     f(b)
## })
## 
## [[2]]
## eval.parent(substitute(eval(quote(expr), envir)))
## 
## [[3]]
## eval(expr, p)
## 
## [[4]]
## eval(expr, p)
## 
## [[5]]
## eval(quote({
##     f(b)
## }), new.env())
## 
## [[6]]
## eval(quote({
##     f(b)
## }), new.env())
## 
## [[7]]
## f(b)
## 
## [[8]]
## stop(&quot;`x` cannot be negative.&quot;)</code></pre>
<p>To figure out what went wrong, you could try to build the failed target interactively. To do that, simply call <code>drake_build()</code>. This function first calls <code>loadd(deps = TRUE)</code> to load any missing dependencies (see the <code>replace</code> argument here) and then builds your target.</p>
<pre class="sourceCode r"><code class="sourceCode r">## Pretend we just opened a new R session.
<span class="kw">library</span>(drake)

## Unloads target `b`.
config &lt;-<span class="st"> </span><span class="kw">drake_config</span>(<span class="dt">plan =</span> bad_plan)
## Unloading targets from environment:
##   b

## my_target depends on b.
<span class="st">&quot;b&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">ls</span>()
## [1] FALSE

## Try to build my_target until the error is fixed.
## Skip all that pesky work checking dependencies.
<span class="kw">drake_build</span>(my_target, <span class="dt">config =</span> config)
## target my_target
## fail my_target
## Error: Target `my_target` failed. Call `diagnose(my_target)` for details. Error message:
##   `x` cannot be negative.

## The target failed, but the dependency was loaded.
<span class="st">&quot;b&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">ls</span>()
## [1] TRUE

## What was `b` again?
b
## [1] -12

## How was `b` used?
<span class="kw">diagnose</span>(my_target)<span class="op">$</span>message
## NULL

<span class="kw">diagnose</span>(my_target)<span class="op">$</span>call
## NULL

f
## function(x){
##   if (x &lt; 0){
##     stop(&quot;`x` cannot be negative.&quot;)
##   }
##   x
## }

## Aha! The error was in f(). Let&#39;s fix it and try again.
f &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  x &lt;-<span class="st"> </span><span class="kw">abs</span>(x)
  <span class="cf">if</span> (x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>){
    <span class="kw">stop</span>(<span class="st">&quot;`x` cannot be negative.&quot;</span>)
  }
  x
}

## Now it works!
## Since you called make() previously, `config` is read from the cache
## if you do not supply it.
<span class="kw">drake_build</span>(my_target)
## target my_target

<span class="kw">readd</span>(my_target)
## [1] 12</code></pre>
<div id="tidy-evaluation-a-caveat-to-diagnosing-interactively" class="section level3">
<h3><span class="header-section-number">9.5.1</span> Tidy evaluation: a caveat to diagnosing interactively</h3>
<p>Running commands in your R console is not always exactly like running them with <code>make()</code>. That’s because <code>make()</code> uses tidy evaluation as implemented in the <a href="https://github.com/tidyverse/rlang"><code>rlang</code> package</a>.</p>
<pre class="sourceCode r"><code class="sourceCode r">## This workflow plan uses rlang&#39;s quasiquotation operator `!!`.
my_plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(<span class="dt">list =</span> <span class="kw">c</span>(
  <span class="dt">little_b =</span> <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">b</span><span class="ch">\&quot;</span><span class="st">&quot;</span>,
  <span class="dt">letter =</span> <span class="st">&quot;!!little_b&quot;</span>
))
my_plan
## # A tibble: 2 x 2
##   target   command   
## * &lt;chr&gt;    &lt;chr&gt;     
## 1 little_b &quot;\&quot;b\&quot;&quot;   
## 2 letter   !!little_b
<span class="kw">make</span>(my_plan)
## target little_b
## target letter
<span class="kw">readd</span>(letter)
## [1] &quot;b&quot;</code></pre>
</div>
</div>
<div id="debrief-a-build-session." class="section level2">
<h2><span class="header-section-number">9.6</span> Debrief a build session.</h2>
<p>After your project is at least somewhat built, you can inspect and read your results from the cache.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">make</span>(my_plan, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)

## drake_session(verbose = FALSE) # Prints the sessionInfo() of the last make(). # nolint

<span class="kw">cached</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>)
## [1] &quot;a&quot;         &quot;b&quot;         &quot;f&quot;         &quot;letter&quot;    &quot;little_b&quot;  &quot;my_target&quot;
## [7] &quot;stop&quot;      &quot;Sys.sleep&quot; &quot;x&quot;

<span class="kw">built</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>)
## [1] &quot;a&quot;         &quot;b&quot;         &quot;letter&quot;    &quot;little_b&quot;  &quot;my_target&quot; &quot;x&quot;

<span class="kw">imported</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>)
## [1] &quot;f&quot;         &quot;stop&quot;      &quot;Sys.sleep&quot;

<span class="kw">loadd</span>(little_b, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)

little_b
## [1] &quot;b&quot;

<span class="kw">readd</span>(letter, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
## [1] &quot;b&quot;

<span class="kw">progress</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>)
## Error in progress(verbose = FALSE): unused argument (verbose = FALSE)

<span class="kw">in_progress</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) <span class="co"># Unfinished targets</span>
## character(0)</code></pre>
<p>There are functions to help you locate the project’s cache.</p>
<pre class="sourceCode r"><code class="sourceCode r">## find_project() # nolint
## find_cache()   # nolint</code></pre>
<p>For more information on the cache, see the <a href="store.html#store">chapter on storage and caches</a>.</p>
</div>
<div id="start-tinkering." class="section level2">
<h2><span class="header-section-number">9.7</span> Start tinkering.</h2>
<p>The <code>load_mtcars_example()</code> function loads the <a href="https://github.com/ropensci/drake/tree/master/inst/examples/mtcars">mtcars example</a> from <code>drake_example(&quot;mtcars&quot;)</code> right into your workspace. The workflow plan data frame, workspace, and import files are set up for you. Only <code>make(my_plan)</code> is left to you.</p>
<p><code>Drake</code> has <a href="https://github.com/ropensci/drake/tree/master/inst/examples">many more built-in examples</a>. To see your choices, use</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">drake_examples</span>()
##  [1] &quot;Docker-psock&quot;     &quot;gsp&quot;              &quot;lfs&quot;             
##  [4] &quot;main&quot;             &quot;Makefile-cluster&quot; &quot;mtcars&quot;          
##  [7] &quot;packages&quot;         &quot;sge&quot;              &quot;slurm&quot;           
## [10] &quot;torque&quot;</code></pre>
<p>To write the files for an example, use <code>drake_example()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">drake_example</span>(<span class="st">&quot;main&quot;</span>)
<span class="kw">drake_example</span>(<span class="st">&quot;packages&quot;</span>)
<span class="kw">drake_example</span>(<span class="st">&quot;gsp&quot;</span>)</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="vis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hpc.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
