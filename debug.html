<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>The drake R Package User Manual</title>
  <meta name="description" content="The drake R Package User Manual">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="The drake R Package User Manual" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="The drake R Package User Manual" />
  
  
  

<meta name="author" content="Will Landau, Kirill Müller, Alex Axthelm, Jasper Clarkberg, Lorenz Walthert">
<meta name="author" content="Copyright Eli Lilly and Company">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="caution.html">
<link rel="next" href="faq.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.4/visNetwork.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/sankey-1/sankey.js"></script>
<script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-drake-r-package"><i class="fa fa-check"></i><b>1.1</b> The drake R package</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#why-drake"><i class="fa fa-check"></i><b>1.3</b> Why drake?</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#what-gets-done-stays-done."><i class="fa fa-check"></i><b>1.3.1</b> What gets done stays done.</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#reproducibility-with-confidence"><i class="fa fa-check"></i><b>1.3.2</b> Reproducibility with confidence</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#aggressively-scale-up."><i class="fa fa-check"></i><b>1.3.3</b> Aggressively scale up.</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#documentation"><i class="fa fa-check"></i><b>1.4</b> Documentation</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#cheat-sheet"><i class="fa fa-check"></i><b>1.4.1</b> Cheat sheet</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#frequently-asked-questions"><i class="fa fa-check"></i><b>1.4.2</b> Frequently asked questions</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#function-reference"><i class="fa fa-check"></i><b>1.4.3</b> Function reference</a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#tutorials"><i class="fa fa-check"></i><b>1.4.4</b> Tutorials</a></li>
<li class="chapter" data-level="1.4.5" data-path="index.html"><a href="index.html#examples"><i class="fa fa-check"></i><b>1.4.5</b> Examples</a></li>
<li class="chapter" data-level="1.4.6" data-path="index.html"><a href="index.html#presentations"><i class="fa fa-check"></i><b>1.4.6</b> Presentations</a></li>
<li class="chapter" data-level="1.4.7" data-path="index.html"><a href="index.html#real-example-projects"><i class="fa fa-check"></i><b>1.4.7</b> Real example projects</a></li>
<li class="chapter" data-level="1.4.8" data-path="index.html"><a href="index.html#context-and-history"><i class="fa fa-check"></i><b>1.4.8</b> Context and history</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#help-and-troubleshooting"><i class="fa fa-check"></i><b>1.5</b> Help and troubleshooting</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#similar-work"><i class="fa fa-check"></i><b>1.6</b> Similar work</a><ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#gnu-make"><i class="fa fa-check"></i><b>1.6.1</b> GNU Make</a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#remake"><i class="fa fa-check"></i><b>1.6.2</b> Remake</a></li>
<li class="chapter" data-level="1.6.3" data-path="index.html"><a href="index.html#memoise"><i class="fa fa-check"></i><b>1.6.3</b> Memoise</a></li>
<li class="chapter" data-level="1.6.4" data-path="index.html"><a href="index.html#knitr-and-r-markdown"><i class="fa fa-check"></i><b>1.6.4</b> Knitr and R Markdown</a></li>
<li class="chapter" data-level="1.6.5" data-path="index.html"><a href="index.html#factuals-drake"><i class="fa fa-check"></i><b>1.6.5</b> Factual’s Drake</a></li>
<li class="chapter" data-level="1.6.6" data-path="index.html"><a href="index.html#other-pipeline-toolkits"><i class="fa fa-check"></i><b>1.6.6</b> Other pipeline toolkits</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.7</b> Acknowledgements</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="caution.html"><a href="caution.html"><i class="fa fa-check"></i><b>A</b> Cautionary notes</a><ul>
<li class="chapter" data-level="A.1" data-path="caution.html"><a href="caution.html#projects-built-with-drake-4.4.0-are-not-back-compatible-with-drake-4.4.0."><i class="fa fa-check"></i><b>A.1</b> Projects built with drake &lt;= 4.4.0 are not back compatible with drake &gt; 4.4.0.</a></li>
<li class="chapter" data-level="A.2" data-path="caution.html"><a href="caution.html#workflow-plans"><i class="fa fa-check"></i><b>A.2</b> Workflow plans</a><ul>
<li class="chapter" data-level="A.2.1" data-path="caution.html"><a href="caution.html#externalizing-commands-in-r-script-files"><i class="fa fa-check"></i><b>A.2.1</b> Externalizing commands in R script files</a></li>
<li class="chapter" data-level="A.2.2" data-path="caution.html"><a href="caution.html#commands-are-not-perfectly-flexible."><i class="fa fa-check"></i><b>A.2.2</b> Commands are NOT perfectly flexible.</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="caution.html"><a href="caution.html#execution"><i class="fa fa-check"></i><b>A.3</b> Execution</a><ul>
<li class="chapter" data-level="A.3.1" data-path="caution.html"><a href="caution.html#install-drake-properly."><i class="fa fa-check"></i><b>A.3.1</b> Install <code>drake</code> properly.</a></li>
<li class="chapter" data-level="A.3.2" data-path="caution.html"><a href="caution.html#install-all-your-packages."><i class="fa fa-check"></i><b>A.3.2</b> Install all your packages.</a></li>
<li class="chapter" data-level="A.3.3" data-path="caution.html"><a href="caution.html#a-note-on-tidy-evaluation"><i class="fa fa-check"></i><b>A.3.3</b> A note on tidy evaluation</a></li>
<li class="chapter" data-level="A.3.4" data-path="caution.html"><a href="caution.html#find-and-diagnose-your-errors."><i class="fa fa-check"></i><b>A.3.4</b> Find and diagnose your errors.</a></li>
<li class="chapter" data-level="A.3.5" data-path="caution.html"><a href="caution.html#refresh-the-drake_config-list-early-and-often."><i class="fa fa-check"></i><b>A.3.5</b> Refresh the <code>drake_config()</code> list early and often.</a></li>
<li class="chapter" data-level="A.3.6" data-path="caution.html"><a href="caution.html#workflows-as-r-packages."><i class="fa fa-check"></i><b>A.3.6</b> Workflows as R packages.</a></li>
<li class="chapter" data-level="A.3.7" data-path="caution.html"><a href="caution.html#the-lazy_load-flag-does-not-work-with-parlapply-parallelism."><i class="fa fa-check"></i><b>A.3.7</b> The <code>lazy_load</code> flag does not work with <code>&quot;parLapply&quot;</code> parallelism.</a></li>
<li class="chapter" data-level="A.3.8" data-path="caution.html"><a href="caution.html#timeouts-may-be-unreliable."><i class="fa fa-check"></i><b>A.3.8</b> Timeouts may be unreliable.</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="caution.html"><a href="caution.html#dependencies"><i class="fa fa-check"></i><b>A.4</b> Dependencies</a><ul>
<li class="chapter" data-level="A.4.1" data-path="caution.html"><a href="caution.html#objects-that-contain-functions-may-rebuild-too-often"><i class="fa fa-check"></i><b>A.4.1</b> Objects that contain functions may rebuild too often</a></li>
<li class="chapter" data-level="A.4.2" data-path="caution.html"><a href="caution.html#the-magrittr-dot-.-is-always-ignored."><i class="fa fa-check"></i><b>A.4.2</b> The <code>magrittr</code> dot (<code>.</code>) is always ignored.</a></li>
<li class="chapter" data-level="A.4.3" data-path="caution.html"><a href="caution.html#dependencies-are-not-tracked-in-some-edge-cases."><i class="fa fa-check"></i><b>A.4.3</b> Dependencies are not tracked in some edge cases.</a></li>
<li class="chapter" data-level="A.4.4" data-path="caution.html"><a href="caution.html#dependencies-of-knitr-reports"><i class="fa fa-check"></i><b>A.4.4</b> Dependencies of <code>knitr</code> reports</a></li>
<li class="chapter" data-level="A.4.5" data-path="caution.html"><a href="caution.html#file-outputs-in-imported-functions."><i class="fa fa-check"></i><b>A.4.5</b> File outputs in imported functions.</a></li>
<li class="chapter" data-level="A.4.6" data-path="caution.html"><a href="caution.html#functions-produced-by-vectorize"><i class="fa fa-check"></i><b>A.4.6</b> Functions produced by <code>Vectorize()</code></a></li>
<li class="chapter" data-level="A.4.7" data-path="caution.html"><a href="caution.html#compiled-code-is-not-reproducibly-tracked."><i class="fa fa-check"></i><b>A.4.7</b> Compiled code is not reproducibly tracked.</a></li>
<li class="chapter" data-level="A.4.8" data-path="caution.html"><a href="caution.html#directories-folders-are-not-reproducibly-tracked."><i class="fa fa-check"></i><b>A.4.8</b> Directories (folders) are not reproducibly tracked.</a></li>
<li class="chapter" data-level="A.4.9" data-path="caution.html"><a href="caution.html#packages-are-not-tracked-as-dependencies."><i class="fa fa-check"></i><b>A.4.9</b> Packages are not tracked as dependencies.</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="caution.html"><a href="caution.html#high-performance-computing"><i class="fa fa-check"></i><b>A.5</b> High-performance computing</a><ul>
<li class="chapter" data-level="A.5.1" data-path="caution.html"><a href="caution.html#the-practical-utility-of-parallel-computing"><i class="fa fa-check"></i><b>A.5.1</b> The practical utility of parallel computing</a></li>
<li class="chapter" data-level="A.5.2" data-path="caution.html"><a href="caution.html#maximum-number-of-simultaneous-jobs"><i class="fa fa-check"></i><b>A.5.2</b> Maximum number of simultaneous jobs</a></li>
<li class="chapter" data-level="A.5.3" data-path="caution.html"><a href="caution.html#parallel-computing-on-windows"><i class="fa fa-check"></i><b>A.5.3</b> Parallel computing on Windows</a></li>
<li class="chapter" data-level="A.5.4" data-path="caution.html"><a href="caution.html#configuring-futurebatchtools-parallelism-for-clusters"><i class="fa fa-check"></i><b>A.5.4</b> Configuring <a href="https://github.com/HenrikBengtsson/future">future</a>/<a href="https://github.com/mllg/batchtools">batchtools</a> parallelism for clusters</a></li>
<li class="chapter" data-level="A.5.5" data-path="caution.html"><a href="caution.html#proper-makefiles-are-not-standalone."><i class="fa fa-check"></i><b>A.5.5</b> Proper Makefiles are not standalone.</a></li>
<li class="chapter" data-level="A.5.6" data-path="caution.html"><a href="caution.html#makefile-level-parallelism-for-imported-objects-and-files"><i class="fa fa-check"></i><b>A.5.6</b> Makefile-level parallelism for imported objects and files</a></li>
<li class="chapter" data-level="A.5.7" data-path="caution.html"><a href="caution.html#zombie-processes"><i class="fa fa-check"></i><b>A.5.7</b> Zombie processes</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="caution.html"><a href="caution.html#storage"><i class="fa fa-check"></i><b>A.6</b> Storage</a><ul>
<li class="chapter" data-level="A.6.1" data-path="caution.html"><a href="caution.html#projects-hosted-on-dropbox-and-similar-platforms"><i class="fa fa-check"></i><b>A.6.1</b> Projects hosted on Dropbox and similar platforms</a></li>
<li class="chapter" data-level="A.6.2" data-path="caution.html"><a href="caution.html#cache-customization-is-limited"><i class="fa fa-check"></i><b>A.6.2</b> Cache customization is limited</a></li>
<li class="chapter" data-level="A.6.3" data-path="caution.html"><a href="caution.html#runtime-predictions"><i class="fa fa-check"></i><b>A.6.3</b> Runtime predictions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="debug.html"><a href="debug.html"><i class="fa fa-check"></i><b>B</b> Debugging and testing drake projects</a><ul>
<li class="chapter" data-level="B.1" data-path="debug.html"><a href="debug.html#dependencies-1"><i class="fa fa-check"></i><b>B.1</b> Dependencies</a><ul>
<li class="chapter" data-level="B.1.1" data-path="debug.html"><a href="debug.html#visualize-your-dependency-graph."><i class="fa fa-check"></i><b>B.1.1</b> Visualize your dependency graph.</a></li>
<li class="chapter" data-level="B.1.2" data-path="debug.html"><a href="debug.html#check-specific-dependency-information."><i class="fa fa-check"></i><b>B.1.2</b> Check specific dependency information.</a></li>
<li class="chapter" data-level="B.1.3" data-path="debug.html"><a href="debug.html#outdated-targets-and-missing-dependencies"><i class="fa fa-check"></i><b>B.1.3</b> Outdated targets and missing dependencies</a></li>
<li class="chapter" data-level="B.1.4" data-path="debug.html"><a href="debug.html#but-why-are-my-targets-out-of-date"><i class="fa fa-check"></i><b>B.1.4</b> But <em>why</em> are my targets out of date?</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="debug.html"><a href="debug.html#diagnose-failures."><i class="fa fa-check"></i><b>B.2</b> Diagnose failures.</a></li>
<li class="chapter" data-level="B.3" data-path="debug.html"><a href="debug.html#timeouts-and-retries"><i class="fa fa-check"></i><b>B.3</b> Timeouts and retries</a></li>
<li class="chapter" data-level="B.4" data-path="debug.html"><a href="debug.html#consider-hasty-mode"><i class="fa fa-check"></i><b>B.4</b> Consider hasty mode</a></li>
<li class="chapter" data-level="B.5" data-path="debug.html"><a href="debug.html#more-help"><i class="fa fa-check"></i><b>B.5</b> More help</a></li>
</ul></li>
<li class="part"><span><b>I Examples</b></span></li>
<li class="chapter" data-level="C" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>C</b> Frequently-asked questions</a></li>
<li class="part"><span><b>II Functionality</b></span></li>
<li class="chapter" data-level="D" data-path="gsp.html"><a href="gsp.html"><i class="fa fa-check"></i><b>D</b> Finding the best model of gross state product</a><ul>
<li class="chapter" data-level="D.1" data-path="gsp.html"><a href="gsp.html#get-the-code."><i class="fa fa-check"></i><b>D.1</b> Get the code.</a></li>
<li class="chapter" data-level="D.2" data-path="gsp.html"><a href="gsp.html#objective-and-methods"><i class="fa fa-check"></i><b>D.2</b> Objective and methods</a></li>
<li class="chapter" data-level="D.3" data-path="gsp.html"><a href="gsp.html#data"><i class="fa fa-check"></i><b>D.3</b> Data</a></li>
<li class="chapter" data-level="D.4" data-path="gsp.html"><a href="gsp.html#analysis"><i class="fa fa-check"></i><b>D.4</b> Analysis</a></li>
<li class="chapter" data-level="D.5" data-path="gsp.html"><a href="gsp.html#results"><i class="fa fa-check"></i><b>D.5</b> Results</a></li>
<li class="chapter" data-level="D.6" data-path="gsp.html"><a href="gsp.html#comparison-with-gnu-make"><i class="fa fa-check"></i><b>D.6</b> Comparison with GNU Make</a></li>
<li class="chapter" data-level="D.7" data-path="gsp.html"><a href="gsp.html#references"><i class="fa fa-check"></i><b>D.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="hpc.html"><a href="hpc.html"><i class="fa fa-check"></i><b>E</b> High-performance computing with drake</a><ul>
<li class="chapter" data-level="E.1" data-path="hpc.html"><a href="hpc.html#batch-mode-for-long-workflows"><i class="fa fa-check"></i><b>E.1</b> Batch mode for long workflows</a></li>
<li class="chapter" data-level="E.2" data-path="hpc.html"><a href="hpc.html#let-drake-schedule-your-targets."><i class="fa fa-check"></i><b>E.2</b> Let drake schedule your targets.</a></li>
<li class="chapter" data-level="E.3" data-path="hpc.html"><a href="hpc.html#parallel-backends"><i class="fa fa-check"></i><b>E.3</b> Parallel backends</a></li>
<li class="chapter" data-level="E.4" data-path="hpc.html"><a href="hpc.html#local-workers"><i class="fa fa-check"></i><b>E.4</b> Local workers</a></li>
<li class="chapter" data-level="E.5" data-path="hpc.html"><a href="hpc.html#remote-workers"><i class="fa fa-check"></i><b>E.5</b> Remote workers</a><ul>
<li class="chapter" data-level="E.5.1" data-path="hpc.html"><a href="hpc.html#clustermq-clustermq_staged-and-hasty"><i class="fa fa-check"></i><b>E.5.1</b> <code>&quot;clustermq&quot;</code>, <code>&quot;clustermq_staged&quot;</code>, and <code>&quot;hasty&quot;</code></a></li>
<li class="chapter" data-level="E.5.2" data-path="hpc.html"><a href="hpc.html#future-future_lapply-and-future_lapply_staged"><i class="fa fa-check"></i><b>E.5.2</b> <code>&quot;future&quot;</code>, <code>&quot;future_lapply&quot;</code>, and <code>&quot;future_lapply_staged&quot;</code></a></li>
<li class="chapter" data-level="E.5.3" data-path="hpc.html"><a href="hpc.html#makefile"><i class="fa fa-check"></i><b>E.5.3</b> <code>&quot;Makefile&quot;</code></a></li>
</ul></li>
<li class="chapter" data-level="E.6" data-path="hpc.html"><a href="hpc.html#scheduling-algorithms"><i class="fa fa-check"></i><b>E.6</b> Scheduling algorithms</a><ul>
<li class="chapter" data-level="E.6.1" data-path="hpc.html"><a href="hpc.html#persistent-scheduling"><i class="fa fa-check"></i><b>E.6.1</b> Persistent scheduling</a></li>
<li class="chapter" data-level="E.6.2" data-path="hpc.html"><a href="hpc.html#transient-scheduling"><i class="fa fa-check"></i><b>E.6.2</b> Transient scheduling</a></li>
<li class="chapter" data-level="E.6.3" data-path="hpc.html"><a href="hpc.html#staged-scheduling"><i class="fa fa-check"></i><b>E.6.3</b> Staged scheduling</a></li>
</ul></li>
<li class="chapter" data-level="E.7" data-path="hpc.html"><a href="hpc.html#final-thoughts"><i class="fa fa-check"></i><b>E.7</b> Final thoughts</a><ul>
<li class="chapter" data-level="E.7.1" data-path="hpc.html"><a href="hpc.html#debugging"><i class="fa fa-check"></i><b>E.7.1</b> Debugging</a></li>
<li class="chapter" data-level="E.7.2" data-path="hpc.html"><a href="hpc.html#drake-as-an-ordinary-job-scheduler"><i class="fa fa-check"></i><b>E.7.2</b> Drake as an ordinary job scheduler</a></li>
<li class="chapter" data-level="E.7.3" data-path="hpc.html"><a href="hpc.html#more-resources"><i class="fa fa-check"></i><b>E.7.3</b> More resources</a></li>
</ul></li>
<li class="chapter" data-level="E.8" data-path="hpc.html"><a href="hpc.html#footnotes"><i class="fa fa-check"></i><b>E.8</b> Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="main.html"><a href="main.html"><i class="fa fa-check"></i><b>F</b> The main example</a><ul>
<li class="chapter" data-level="F.1" data-path="main.html"><a href="main.html#set-the-stage."><i class="fa fa-check"></i><b>F.1</b> Set the stage.</a></li>
<li class="chapter" data-level="F.2" data-path="main.html"><a href="main.html#make-your-results."><i class="fa fa-check"></i><b>F.2</b> Make your results.</a></li>
<li class="chapter" data-level="F.3" data-path="main.html"><a href="main.html#go-back-and-fix-things."><i class="fa fa-check"></i><b>F.3</b> Go back and fix things.</a></li>
<li class="chapter" data-level="F.4" data-path="main.html"><a href="main.html#try-it-yourself"><i class="fa fa-check"></i><b>F.4</b> Try it yourself!</a></li>
</ul></li>
<li class="chapter" data-level="G" data-path="mtcars.html"><a href="mtcars.html"><i class="fa fa-check"></i><b>G</b> The mtcars example and workflow plan generation</a><ul>
<li class="chapter" data-level="G.1" data-path="mtcars.html"><a href="mtcars.html#get-the-code.-1"><i class="fa fa-check"></i><b>G.1</b> Get the code.</a></li>
<li class="chapter" data-level="G.2" data-path="mtcars.html"><a href="mtcars.html#quick-examples"><i class="fa fa-check"></i><b>G.2</b> Quick examples</a></li>
<li class="chapter" data-level="G.3" data-path="mtcars.html"><a href="mtcars.html#the-motivation-of-the-mtcars-example"><i class="fa fa-check"></i><b>G.3</b> The motivation of the mtcars example</a></li>
<li class="chapter" data-level="G.4" data-path="mtcars.html"><a href="mtcars.html#set-up-the-mtcars-example"><i class="fa fa-check"></i><b>G.4</b> Set up the mtcars example</a></li>
<li class="chapter" data-level="G.5" data-path="mtcars.html"><a href="mtcars.html#the-workflow-plan-data-frame"><i class="fa fa-check"></i><b>G.5</b> The workflow plan data frame</a></li>
<li class="chapter" data-level="G.6" data-path="mtcars.html"><a href="mtcars.html#generate-the-workflow-plan"><i class="fa fa-check"></i><b>G.6</b> Generate the workflow plan</a></li>
<li class="chapter" data-level="G.7" data-path="mtcars.html"><a href="mtcars.html#run-the-workflow"><i class="fa fa-check"></i><b>G.7</b> Run the workflow</a></li>
</ul></li>
<li class="chapter" data-level="H" data-path="organize.html"><a href="organize.html"><i class="fa fa-check"></i><b>H</b> How to organize the files of drake projects</a><ul>
<li class="chapter" data-level="H.1" data-path="organize.html"><a href="organize.html#examples-1"><i class="fa fa-check"></i><b>H.1</b> Examples</a></li>
<li class="chapter" data-level="H.2" data-path="organize.html"><a href="organize.html#where-do-you-put-your-code"><i class="fa fa-check"></i><b>H.2</b> Where do you put your code?</a></li>
<li class="chapter" data-level="H.3" data-path="organize.html"><a href="organize.html#your-commands-are-code-chunks-not-r-scripts"><i class="fa fa-check"></i><b>H.3</b> Your commands are code chunks, not R scripts</a></li>
<li class="chapter" data-level="H.4" data-path="organize.html"><a href="organize.html#workflows-as-r-packages"><i class="fa fa-check"></i><b>H.4</b> Workflows as R packages</a><ul>
<li class="chapter" data-level="H.4.1" data-path="organize.html"><a href="organize.html#advantages-of-putting-workflows-in-r-packages"><i class="fa fa-check"></i><b>H.4.1</b> Advantages of putting workflows in R packages</a></li>
<li class="chapter" data-level="H.4.2" data-path="organize.html"><a href="organize.html#the-problem"><i class="fa fa-check"></i><b>H.4.2</b> The problem</a></li>
<li class="chapter" data-level="H.4.3" data-path="organize.html"><a href="organize.html#the-solution"><i class="fa fa-check"></i><b>H.4.3</b> The solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="I" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>I</b> An analysis of R package download trends</a><ul>
<li class="chapter" data-level="I.1" data-path="packages.html"><a href="packages.html#get-the-code.-2"><i class="fa fa-check"></i><b>I.1</b> Get the code.</a></li>
<li class="chapter" data-level="I.2" data-path="packages.html"><a href="packages.html#overview"><i class="fa fa-check"></i><b>I.2</b> Overview</a></li>
<li class="chapter" data-level="I.3" data-path="packages.html"><a href="packages.html#analysis-1"><i class="fa fa-check"></i><b>I.3</b> Analysis</a></li>
<li class="chapter" data-level="I.4" data-path="packages.html"><a href="packages.html#other-ways-to-trigger-downloads"><i class="fa fa-check"></i><b>I.4</b> Other ways to trigger downloads</a></li>
</ul></li>
<li class="chapter" data-level="J" data-path="plans.html"><a href="plans.html"><i class="fa fa-check"></i><b>J</b> Workflow plan data frames</a><ul>
<li class="chapter" data-level="J.1" data-path="plans.html"><a href="plans.html#what-is-a-workflow-plan-data-frame"><i class="fa fa-check"></i><b>J.1</b> What is a workflow plan data frame?</a></li>
<li class="chapter" data-level="J.2" data-path="plans.html"><a href="plans.html#plans-are-like-r-scripts."><i class="fa fa-check"></i><b>J.2</b> Plans are like R scripts.</a></li>
<li class="chapter" data-level="J.3" data-path="plans.html"><a href="plans.html#so-why-do-we-use-plans"><i class="fa fa-check"></i><b>J.3</b> So why do we use plans?</a><ul>
<li class="chapter" data-level="J.3.1" data-path="plans.html"><a href="plans.html#you-can-skip-up-to-date-work."><i class="fa fa-check"></i><b>J.3.1</b> You can skip up-to-date work.</a></li>
<li class="chapter" data-level="J.3.2" data-path="plans.html"><a href="plans.html#data-frames-scale-well."><i class="fa fa-check"></i><b>J.3.2</b> Data frames scale well.</a></li>
<li class="chapter" data-level="J.3.3" data-path="plans.html"><a href="plans.html#you-do-not-need-to-worry-about-which-targets-run-first."><i class="fa fa-check"></i><b>J.3.3</b> You do not need to worry about which targets run first.</a></li>
</ul></li>
<li class="chapter" data-level="J.4" data-path="plans.html"><a href="plans.html#automatic-dependency-detection"><i class="fa fa-check"></i><b>J.4</b> Automatic dependency detection</a></li>
<li class="chapter" data-level="J.5" data-path="plans.html"><a href="plans.html#automatically-generating-workflow-plans"><i class="fa fa-check"></i><b>J.5</b> Automatically generating workflow plans</a><ul>
<li class="chapter" data-level="J.5.1" data-path="plans.html"><a href="plans.html#map_plan"><i class="fa fa-check"></i><b>J.5.1</b> <code>map_plan()</code></a></li>
<li class="chapter" data-level="J.5.2" data-path="plans.html"><a href="plans.html#wildcard-templating"><i class="fa fa-check"></i><b>J.5.2</b> Wildcard templating</a></li>
<li class="chapter" data-level="J.5.3" data-path="plans.html"><a href="plans.html#wildcard-clusters"><i class="fa fa-check"></i><b>J.5.3</b> Wildcard clusters</a></li>
<li class="chapter" data-level="J.5.4" data-path="plans.html"><a href="plans.html#specialized-wildcard-functionality"><i class="fa fa-check"></i><b>J.5.4</b> Specialized wildcard functionality</a></li>
<li class="chapter" data-level="J.5.5" data-path="plans.html"><a href="plans.html#non-wildcard-functions"><i class="fa fa-check"></i><b>J.5.5</b> Non-wildcard functions</a></li>
<li class="chapter" data-level="J.5.6" data-path="plans.html"><a href="plans.html#custom-metaprogramming"><i class="fa fa-check"></i><b>J.5.6</b> Custom metaprogramming</a></li>
</ul></li>
<li class="chapter" data-level="J.6" data-path="plans.html"><a href="plans.html#optional-columns-in-your-plan."><i class="fa fa-check"></i><b>J.6</b> Optional columns in your plan.</a></li>
</ul></li>
<li class="chapter" data-level="K" data-path="store.html"><a href="store.html"><i class="fa fa-check"></i><b>K</b> Storage</a><ul>
<li class="chapter" data-level="K.1" data-path="store.html"><a href="store.html#caches"><i class="fa fa-check"></i><b>K.1</b> Caches</a></li>
<li class="chapter" data-level="K.2" data-path="store.html"><a href="store.html#hash-algorithms"><i class="fa fa-check"></i><b>K.2</b> Hash algorithms</a></li>
<li class="chapter" data-level="K.3" data-path="store.html"><a href="store.html#which-hash-algorithm-should-you-choose"><i class="fa fa-check"></i><b>K.3</b> Which hash algorithm should you choose?</a></li>
<li class="chapter" data-level="K.4" data-path="store.html"><a href="store.html#select-the-hash-algorithms-of-the-cache"><i class="fa fa-check"></i><b>K.4</b> Select the hash algorithms of the cache</a></li>
<li class="chapter" data-level="K.5" data-path="store.html"><a href="store.html#using-storr-directly"><i class="fa fa-check"></i><b>K.5</b> Using <code>storr</code> directly</a></li>
<li class="chapter" data-level="K.6" data-path="store.html"><a href="store.html#cleaning-up"><i class="fa fa-check"></i><b>K.6</b> Cleaning up</a></li>
</ul></li>
<li class="chapter" data-level="L" data-path="time.html"><a href="time.html"><i class="fa fa-check"></i><b>L</b> Time: logging, prediction, and strategy</a><ul>
<li class="chapter" data-level="L.1" data-path="time.html"><a href="time.html#predict-total-runtime"><i class="fa fa-check"></i><b>L.1</b> Predict total runtime</a></li>
<li class="chapter" data-level="L.2" data-path="time.html"><a href="time.html#strategize-your-high-performance-computing"><i class="fa fa-check"></i><b>L.2</b> Strategize your high-performance computing</a></li>
</ul></li>
<li class="chapter" data-level="M" data-path="triggers.html"><a href="triggers.html"><i class="fa fa-check"></i><b>M</b> Triggers: decision rules for building targets</a><ul>
<li class="chapter" data-level="M.1" data-path="triggers.html"><a href="triggers.html#what-are-triggers"><i class="fa fa-check"></i><b>M.1</b> What are triggers?</a></li>
<li class="chapter" data-level="M.2" data-path="triggers.html"><a href="triggers.html#customization"><i class="fa fa-check"></i><b>M.2</b> Customization</a></li>
<li class="chapter" data-level="M.3" data-path="triggers.html"><a href="triggers.html#alternative-trigger-modes"><i class="fa fa-check"></i><b>M.3</b> Alternative trigger modes</a></li>
<li class="chapter" data-level="M.4" data-path="triggers.html"><a href="triggers.html#consider-hasty-mode-1"><i class="fa fa-check"></i><b>M.4</b> Consider hasty mode</a></li>
<li class="chapter" data-level="M.5" data-path="triggers.html"><a href="triggers.html#a-more-practical-example"><i class="fa fa-check"></i><b>M.5</b> A more practical example</a></li>
</ul></li>
<li class="chapter" data-level="N" data-path="vis.html"><a href="vis.html"><i class="fa fa-check"></i><b>N</b> Visualization with drake</a><ul>
<li class="chapter" data-level="N.0.1" data-path="vis.html"><a href="vis.html#vis_drake_graph"><i class="fa fa-check"></i><b>N.0.1</b> <code>vis_drake_graph()</code></a></li>
<li class="chapter" data-level="N.0.2" data-path="vis.html"><a href="vis.html#sankey_drake_graph"><i class="fa fa-check"></i><b>N.0.2</b> <code>sankey_drake_graph()</code></a></li>
<li class="chapter" data-level="N.0.3" data-path="vis.html"><a href="vis.html#drake_ggraph"><i class="fa fa-check"></i><b>N.0.3</b> <code>drake_ggraph()</code></a></li>
<li class="chapter" data-level="N.1" data-path="vis.html"><a href="vis.html#underlying-graph-data-node-and-edge-data-frames"><i class="fa fa-check"></i><b>N.1</b> Underlying graph data: node and edge data frames</a></li>
<li class="chapter" data-level="N.2" data-path="vis.html"><a href="vis.html#visualizing-target-status"><i class="fa fa-check"></i><b>N.2</b> Visualizing target status</a></li>
<li class="chapter" data-level="N.3" data-path="vis.html"><a href="vis.html#subgraphs"><i class="fa fa-check"></i><b>N.3</b> Subgraphs</a></li>
<li class="chapter" data-level="N.4" data-path="vis.html"><a href="vis.html#control-the-vis_drake_graph-legend."><i class="fa fa-check"></i><b>N.4</b> Control the <code>vis_drake_graph()</code> legend.</a></li>
<li class="chapter" data-level="N.5" data-path="vis.html"><a href="vis.html#clusters"><i class="fa fa-check"></i><b>N.5</b> Clusters</a></li>
<li class="chapter" data-level="N.6" data-path="vis.html"><a href="vis.html#output-files"><i class="fa fa-check"></i><b>N.6</b> Output files</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The drake R Package User Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="debug" class="section level1">
<h1><span class="header-section-number">B</span> Debugging and testing drake projects</h1>
<p>This chapter is a guide to debugging and testing <code>drake</code> projects.</p>
<div id="dependencies-1" class="section level2">
<h2><span class="header-section-number">B.1</span> Dependencies</h2>
<p><code>drake</code> automatically detects dependency relationships among your targets and imports. While this is convenient most of the time, it can lead to some pitfalls. This section describes techniques to understand you project’s dependency structure and diagnose and debug issues.</p>
<div id="visualize-your-dependency-graph." class="section level3">
<h3><span class="header-section-number">B.1.1</span> Visualize your dependency graph.</h3>
<p>To avoid frustration early on, please use <a href="#visuals"><code>drake</code>’s dependency graph visualizations</a> to see how the steps of your workflow fit together. <code>drake</code> resolves the dependency relationships in the graph by analyzing the code in your commands and the functions in your environment.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">load_mtcars_example</span>()</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">config &lt;-<span class="st"> </span><span class="kw">drake_config</span>(my_plan)</a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co"># Hover, click, drag, zoom, and pan. See args &#39;from&#39; and &#39;to&#39;.</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="kw">vis_drake_graph</span>(config, <span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>, <span class="dt">height =</span> <span class="st">&quot;500px&quot;</span>)</a></code></pre></div>
<div id="htmlwidget-ec897849c5c50a6f7846" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-ec897849c5c50a6f7846">{"x":{"nodes":{"id":["\"report.md\"","\"report.Rmd\"","coef_regression1_large","coef_regression1_small","coef_regression2_large","coef_regression2_small","large","random_rows","reg1","reg2","regression1_large","regression1_small","regression2_large","regression2_small","report","simulate","small","summ_regression1_large","summ_regression1_small","summ_regression2_large","summ_regression2_small"],"deps":[{},null,{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],"trigger":[{},null,{},{},{},{},{},null,null,null,{},{},{},{},{},null,{},{},{},{},{}],"label":["\"report.md\"","\"report.Rmd\"\n0.004s","coef_regression1_large","coef_regression1_small","coef_regression2_large","coef_regression2_small","large","random_rows\n0.003s","reg1\n0.003s","reg2\n0.003s","regression1_large","regression1_small","regression2_large","regression2_small","report","simulate\n0.004s","small","summ_regression1_large","summ_regression1_small","summ_regression2_large","summ_regression2_small"],"command":["knit(knitr_in(\"report.Rmd\"), file_out(\"report.md\"), quiet = TRUE)",null,"suppressWarnings(summary(regression1_large))$coefficients","suppressWarnings(summary(regression1_small))$coefficients","suppressWarnings(summary(regression2_large))$coefficients","suppressWarnings(summary(regression2_small))$coefficients","simulate(64)",null,null,null,"reg1(large)","reg1(small)","reg2(large)","reg2(small)","knit(knitr_in(\"report.Rmd\"), file_out(\"report.md\"), quiet = TRUE)",null,"simulate(48)","suppressWarnings(summary(regression1_large$residuals))","suppressWarnings(summary(regression1_small$residuals))","suppressWarnings(summary(regression2_large$residuals))","suppressWarnings(summary(regression2_small$residuals))"],"status":["outdated","imported","outdated","outdated","outdated","outdated","outdated","imported","imported","imported","outdated","outdated","outdated","outdated","outdated","imported","outdated","outdated","outdated","outdated","outdated"],"type":["file","file","object","object","object","object","object","function","function","function","object","object","object","object","object","function","object","object","object","object","object"],"font.size":[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],"color":["#000000","#1874CD","#000000","#000000","#000000","#000000","#000000","#1874CD","#1874CD","#1874CD","#000000","#000000","#000000","#000000","#000000","#1874CD","#000000","#000000","#000000","#000000","#000000"],"shape":["square","square","dot","dot","dot","dot","dot","triangle","triangle","triangle","dot","dot","dot","dot","dot","triangle","dot","dot","dot","dot","dot"],"level":[7,1,5,5,5,5,3,1,1,1,4,4,4,4,6,2,3,5,5,5,5],"title":["knit(knitr_in(\"report.Rmd\"),&nbsp;file_out(\"report....","---<br>title: \"Final results report for the mtcars ex...<br>author: You<br>output: html_document<br>---<br><br># The weight and fuel efficiency of cars<br><br>Is there an association between the weight and...<br>...","suppressWarnings(summary(regression1_large))$c...","suppressWarnings(summary(regression1_small))$c...","suppressWarnings(summary(regression2_large))$c...","suppressWarnings(summary(regression2_small))$c...","simulate(64)","function&nbsp;(data,&nbsp;n)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;data[sample.int(n&nbsp;=&nbsp;nrow(data),&nbsp;size&nbsp;=&nbsp;n,&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br>}","function&nbsp;(d)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;lm(y&nbsp;~&nbsp;+x,&nbsp;data&nbsp;=&nbsp;d)<br>}","function&nbsp;(d)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;d$x2&nbsp;<-&nbsp;d$x^2<br>&nbsp;&nbsp;&nbsp;&nbsp;lm(y&nbsp;~&nbsp;x2,&nbsp;data&nbsp;=&nbsp;d)<br>}","reg1(large)","reg1(small)","reg2(large)","reg2(small)","knit(knitr_in(\"report.Rmd\"),&nbsp;file_out(\"report....","function&nbsp;(n)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;<-&nbsp;random_rows(data&nbsp;=&nbsp;mtcars,&nbsp;n&nbsp;=&nbsp;n)<br>&nbsp;&nbsp;&nbsp;&nbsp;data.frame(x&nbsp;=&nbsp;data$wt,&nbsp;y&nbsp;=&nbsp;data$mpg)<br>}","simulate(48)","suppressWarnings(summary(regression1_large$res...","suppressWarnings(summary(regression1_small$res...","suppressWarnings(summary(regression2_large$res...","suppressWarnings(summary(regression2_small$res..."],"x":[-1,-0.545454545454545,-0.272727272727273,0.272727272727273,0.0909090909090908,-0.636363636363636,-0.363636363636364,-0.363636363636364,0.909090909090909,0.0909090909090908,0.727272727272727,1,-0.181818181818182,0.363636363636364,-1,-0.363636363636364,0,0.454545454545455,0.636363636363636,-0.0909090909090909,0.818181818181818],"y":[1,-1,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,-0.333333333333333,-1,-1,-1,0,0,0,0,0.666666666666667,-0.666666666666667,-0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333]},"edges":{"from":["random_rows","reg1","reg1","reg2","reg2","\"report.Rmd\"","coef_regression2_small","large","large","large","small","small","small","simulate","simulate","regression1_small","regression1_small","regression1_large","regression1_large","regression2_small","regression2_small","regression2_large","regression2_large","report"],"to":["simulate","regression1_small","regression1_large","regression2_small","regression2_large","report","report","regression1_large","regression2_large","report","regression1_small","regression2_small","report","large","small","summ_regression1_small","coef_regression1_small","summ_regression1_large","coef_regression1_large","coef_regression2_small","summ_regression2_small","summ_regression2_large","coef_regression2_large","\"report.md\""],"file":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,null],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"smooth":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"layout":{"hierarchical":{"enabled":true,"direction":"LR"}},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"navigationButtons":true}},"groups":null,"width":"100%","height":"500px","idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)"},"main":{"text":"Dependency graph","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":false,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":true,"fit":false,"resetHighlight":true,"clusterOptions":null},"legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["Outdated","Imported","Object","Function","File"],"color":["#000000","#1874CD","#888888","#888888","#888888"],"shape":["dot","dot","dot","triangle","square"],"font.color":["black","black","black","black","black"],"font.size":[20,20,20,20,20],"id":[2,5,7,8,9]},"nodesToDataframe":true},"igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="check-specific-dependency-information." class="section level3">
<h3><span class="header-section-number">B.1.2</span> Check specific dependency information.</h3>
<p>With the <code>deps_code()</code> function, you can see for yourself how <code>drake</code> detects first-order dependencies from code.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">print</span>(simulate)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">## function (n) </a>
<a class="sourceLine" id="cb23-3" data-line-number="3">## {</a>
<a class="sourceLine" id="cb23-4" data-line-number="4">##     data &lt;- random_rows(data = mtcars, n = n)</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">##     data.frame(x = data$wt, y = data$mpg)</a>
<a class="sourceLine" id="cb23-6" data-line-number="6">## }</a>
<a class="sourceLine" id="cb23-7" data-line-number="7"></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="kw">deps_code</span>(simulate)</a>
<a class="sourceLine" id="cb23-9" data-line-number="9">## $globals</a>
<a class="sourceLine" id="cb23-10" data-line-number="10">## [1] &quot;random_rows&quot; &quot;mtcars&quot;      &quot;data.frame&quot;</a>
<a class="sourceLine" id="cb23-11" data-line-number="11"></a>
<a class="sourceLine" id="cb23-12" data-line-number="12"><span class="co"># knitr_in() makes sure your target depends on `report.Rmd`</span></a>
<a class="sourceLine" id="cb23-13" data-line-number="13"><span class="co"># and any dependencies loaded with loadd() and readd()</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14"><span class="co"># in the report&#39;s active code chunks.</span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15"><span class="kw">cat</span>(my_plan<span class="op">$</span>command[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb23-16" data-line-number="16">## knit(knitr_in(&quot;report.Rmd&quot;), file_out(&quot;report.md&quot;), quiet = TRUE)</a>
<a class="sourceLine" id="cb23-17" data-line-number="17"></a>
<a class="sourceLine" id="cb23-18" data-line-number="18"><span class="kw">deps_code</span>(my_plan<span class="op">$</span>command[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb23-19" data-line-number="19">## $globals</a>
<a class="sourceLine" id="cb23-20" data-line-number="20">## [1] &quot;knit&quot;</a>
<a class="sourceLine" id="cb23-21" data-line-number="21">## </a>
<a class="sourceLine" id="cb23-22" data-line-number="22">## $loadd</a>
<a class="sourceLine" id="cb23-23" data-line-number="23">## [1] &quot;large&quot;                  &quot;coef_regression2_small&quot;</a>
<a class="sourceLine" id="cb23-24" data-line-number="24">## [3] &quot;small&quot;                 </a>
<a class="sourceLine" id="cb23-25" data-line-number="25">## </a>
<a class="sourceLine" id="cb23-26" data-line-number="26">## $readd</a>
<a class="sourceLine" id="cb23-27" data-line-number="27">## [1] &quot;small&quot;                  &quot;coef_regression2_small&quot;</a>
<a class="sourceLine" id="cb23-28" data-line-number="28">## </a>
<a class="sourceLine" id="cb23-29" data-line-number="29">## $knitr_in</a>
<a class="sourceLine" id="cb23-30" data-line-number="30">## [1] &quot;\&quot;report.Rmd\&quot;&quot;</a>
<a class="sourceLine" id="cb23-31" data-line-number="31">## </a>
<a class="sourceLine" id="cb23-32" data-line-number="32">## $file_out</a>
<a class="sourceLine" id="cb23-33" data-line-number="33">## [1] &quot;\&quot;report.md\&quot;&quot;</a>
<a class="sourceLine" id="cb23-34" data-line-number="34"></a>
<a class="sourceLine" id="cb23-35" data-line-number="35"><span class="kw">cat</span>(my_plan<span class="op">$</span>command[<span class="kw">nrow</span>(my_plan)])</a>
<a class="sourceLine" id="cb23-36" data-line-number="36">## suppressWarnings(summary(regression2_large))$coefficients</a>
<a class="sourceLine" id="cb23-37" data-line-number="37"></a>
<a class="sourceLine" id="cb23-38" data-line-number="38"><span class="kw">deps_code</span>(my_plan<span class="op">$</span>command[<span class="kw">nrow</span>(my_plan)])</a>
<a class="sourceLine" id="cb23-39" data-line-number="39">## $globals</a>
<a class="sourceLine" id="cb23-40" data-line-number="40">## [1] &quot;suppressWarnings&quot;  &quot;summary&quot;           &quot;regression2_large&quot;</a></code></pre></div>
<p>With <code>deps_target()</code>, you can see the dependencies that <code>drake</code> has already detected for your targets and imports.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">deps_target</span>(<span class="st">&quot;simulate&quot;</span>, config)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">## $globals</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">## [1] &quot;random_rows&quot;</a>
<a class="sourceLine" id="cb24-4" data-line-number="4"></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="kw">deps_target</span>(<span class="st">&quot;small&quot;</span>, config)</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">## $globals</a>
<a class="sourceLine" id="cb24-7" data-line-number="7">## [1] &quot;simulate&quot;</a>
<a class="sourceLine" id="cb24-8" data-line-number="8"></a>
<a class="sourceLine" id="cb24-9" data-line-number="9"><span class="kw">deps_target</span>(<span class="st">&quot;report&quot;</span>, config)</a>
<a class="sourceLine" id="cb24-10" data-line-number="10">## $knitr_in</a>
<a class="sourceLine" id="cb24-11" data-line-number="11">## [1] &quot;\&quot;report.Rmd\&quot;&quot;</a>
<a class="sourceLine" id="cb24-12" data-line-number="12">## </a>
<a class="sourceLine" id="cb24-13" data-line-number="13">## $file_out</a>
<a class="sourceLine" id="cb24-14" data-line-number="14">## [1] &quot;\&quot;report.md\&quot;&quot;</a>
<a class="sourceLine" id="cb24-15" data-line-number="15">## </a>
<a class="sourceLine" id="cb24-16" data-line-number="16">## $readd</a>
<a class="sourceLine" id="cb24-17" data-line-number="17">## [1] &quot;small&quot;                  &quot;coef_regression2_small&quot;</a>
<a class="sourceLine" id="cb24-18" data-line-number="18">## </a>
<a class="sourceLine" id="cb24-19" data-line-number="19">## $loadd</a>
<a class="sourceLine" id="cb24-20" data-line-number="20">## [1] &quot;large&quot;                  &quot;coef_regression2_small&quot;</a>
<a class="sourceLine" id="cb24-21" data-line-number="21">## [3] &quot;small&quot;</a></code></pre></div>
<p>And with <code>tracked()</code>, you can list all the reproducibly tracked objects and files.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">tracked</span>(config)</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">##  [1] &quot;\&quot;report.md\&quot;&quot;          &quot;\&quot;report.Rmd\&quot;&quot;        </a>
<a class="sourceLine" id="cb25-3" data-line-number="3">##  [3] &quot;coef_regression1_large&quot; &quot;coef_regression1_small&quot;</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">##  [5] &quot;coef_regression2_large&quot; &quot;coef_regression2_small&quot;</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">##  [7] &quot;large&quot;                  &quot;random_rows&quot;           </a>
<a class="sourceLine" id="cb25-6" data-line-number="6">##  [9] &quot;reg1&quot;                   &quot;reg2&quot;                  </a>
<a class="sourceLine" id="cb25-7" data-line-number="7">## [11] &quot;regression1_large&quot;      &quot;regression1_small&quot;     </a>
<a class="sourceLine" id="cb25-8" data-line-number="8">## [13] &quot;regression2_large&quot;      &quot;regression2_small&quot;     </a>
<a class="sourceLine" id="cb25-9" data-line-number="9">## [15] &quot;report&quot;                 &quot;simulate&quot;              </a>
<a class="sourceLine" id="cb25-10" data-line-number="10">## [17] &quot;small&quot;                  &quot;summ_regression1_large&quot;</a>
<a class="sourceLine" id="cb25-11" data-line-number="11">## [19] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;</a>
<a class="sourceLine" id="cb25-12" data-line-number="12">## [21] &quot;summ_regression2_small&quot;</a></code></pre></div>
</div>
<div id="outdated-targets-and-missing-dependencies" class="section level3">
<h3><span class="header-section-number">B.1.3</span> Outdated targets and missing dependencies</h3>
<p><code>missed()</code> shows any imports missing from your environment</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">missed</span>(config) <span class="co"># Nothing is missing right now.</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">## character(0)</a></code></pre></div>
<p><code>outdated()</code> reports any targets that are outdated.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw">outdated</span>(config)</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">##  [1] &quot;coef_regression1_large&quot; &quot;coef_regression1_small&quot;</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">##  [3] &quot;coef_regression2_large&quot; &quot;coef_regression2_small&quot;</a>
<a class="sourceLine" id="cb27-4" data-line-number="4">##  [5] &quot;large&quot;                  &quot;regression1_large&quot;     </a>
<a class="sourceLine" id="cb27-5" data-line-number="5">##  [7] &quot;regression1_small&quot;      &quot;regression2_large&quot;     </a>
<a class="sourceLine" id="cb27-6" data-line-number="6">##  [9] &quot;regression2_small&quot;      &quot;report&quot;                </a>
<a class="sourceLine" id="cb27-7" data-line-number="7">## [11] &quot;small&quot;                  &quot;summ_regression1_large&quot;</a>
<a class="sourceLine" id="cb27-8" data-line-number="8">## [13] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;</a>
<a class="sourceLine" id="cb27-9" data-line-number="9">## [15] &quot;summ_regression2_small&quot;</a>
<a class="sourceLine" id="cb27-10" data-line-number="10"></a>
<a class="sourceLine" id="cb27-11" data-line-number="11"><span class="kw">make</span>(my_plan)</a>
<a class="sourceLine" id="cb27-12" data-line-number="12">## target large</a>
<a class="sourceLine" id="cb27-13" data-line-number="13">## target small</a>
<a class="sourceLine" id="cb27-14" data-line-number="14">## target regression1_large</a>
<a class="sourceLine" id="cb27-15" data-line-number="15">## target regression2_large</a>
<a class="sourceLine" id="cb27-16" data-line-number="16">## target regression1_small</a>
<a class="sourceLine" id="cb27-17" data-line-number="17">## target regression2_small</a>
<a class="sourceLine" id="cb27-18" data-line-number="18">## target summ_regression1_large</a>
<a class="sourceLine" id="cb27-19" data-line-number="19">## target coef_regression1_large</a>
<a class="sourceLine" id="cb27-20" data-line-number="20">## target summ_regression2_large</a>
<a class="sourceLine" id="cb27-21" data-line-number="21">## target coef_regression2_large</a>
<a class="sourceLine" id="cb27-22" data-line-number="22">## target summ_regression1_small</a>
<a class="sourceLine" id="cb27-23" data-line-number="23">## target coef_regression1_small</a>
<a class="sourceLine" id="cb27-24" data-line-number="24">## target coef_regression2_small</a>
<a class="sourceLine" id="cb27-25" data-line-number="25">## target summ_regression2_small</a>
<a class="sourceLine" id="cb27-26" data-line-number="26">## target report</a>
<a class="sourceLine" id="cb27-27" data-line-number="27"></a>
<a class="sourceLine" id="cb27-28" data-line-number="28"><span class="kw">outdated</span>(config)</a>
<a class="sourceLine" id="cb27-29" data-line-number="29">## character(0)</a></code></pre></div>
</div>
<div id="but-why-are-my-targets-out-of-date" class="section level3">
<h3><span class="header-section-number">B.1.4</span> But <em>why</em> are my targets out of date?</h3>
<p><code>drake</code> has the option to produce a cache log with the fingerprint of every target and import.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">head</span>(<span class="kw">drake_cache_log</span>())</a>
<a class="sourceLine" id="cb28-2" data-line-number="2">## # A tibble: 6 x 3</a>
<a class="sourceLine" id="cb28-3" data-line-number="3">##   hash             type   name                  </a>
<a class="sourceLine" id="cb28-4" data-line-number="4">##   &lt;chr&gt;            &lt;chr&gt;  &lt;chr&gt;                 </a>
<a class="sourceLine" id="cb28-5" data-line-number="5">## 1 c7e850cdf32cafe0 target &quot;\&quot;report.md\&quot;&quot;       </a>
<a class="sourceLine" id="cb28-6" data-line-number="6">## 2 a2e1a7be9a4b1a24 import &quot;\&quot;report.Rmd\&quot;&quot;      </a>
<a class="sourceLine" id="cb28-7" data-line-number="7">## 3 4e6e4d4c0bcda263 target coef_regression1_large</a>
<a class="sourceLine" id="cb28-8" data-line-number="8">## 4 5ad25785a84e0cac target coef_regression1_small</a>
<a class="sourceLine" id="cb28-9" data-line-number="9">## 5 b2662785d55b28c1 target coef_regression2_large</a>
<a class="sourceLine" id="cb28-10" data-line-number="10">## 6 23c66b36be56905b target coef_regression2_small</a></code></pre></div>
<p>We highly recommend that you automatically produce a cache log file on every <code>make()</code> and put it under <a href="https://github.com">version control</a> with the rest of your project.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">make</span>(my_plan, <span class="dt">cache_log_file =</span> <span class="st">&quot;cache_log.txt&quot;</span>)</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">## All targets are already up to date.</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="kw">read.table</span>(<span class="st">&quot;cache_log.txt&quot;</span>, <span class="dt">nrows =</span> <span class="dv">6</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">##               hash   type                   name</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">## 1 c7e850cdf32cafe0 target              report.md</a>
<a class="sourceLine" id="cb29-7" data-line-number="7">## 2 a2e1a7be9a4b1a24 import             report.Rmd</a>
<a class="sourceLine" id="cb29-8" data-line-number="8">## 3 4e6e4d4c0bcda263 target coef_regression1_large</a>
<a class="sourceLine" id="cb29-9" data-line-number="9">## 4 5ad25785a84e0cac target coef_regression1_small</a>
<a class="sourceLine" id="cb29-10" data-line-number="10">## 5 b2662785d55b28c1 target coef_regression2_large</a>
<a class="sourceLine" id="cb29-11" data-line-number="11">## 6 23c66b36be56905b target coef_regression2_small</a></code></pre></div>
<p>Suppose we go back and add input checking to one of our functions.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">print</span>(random_rows)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">## function (data, n) </a>
<a class="sourceLine" id="cb30-3" data-line-number="3">## {</a>
<a class="sourceLine" id="cb30-4" data-line-number="4">##     data[sample.int(n = nrow(data), size = n, replace = TRUE), </a>
<a class="sourceLine" id="cb30-5" data-line-number="5">##         ]</a>
<a class="sourceLine" id="cb30-6" data-line-number="6">## }</a>
<a class="sourceLine" id="cb30-7" data-line-number="7">## &lt;bytecode: 0xaf51c78&gt;</a>
<a class="sourceLine" id="cb30-8" data-line-number="8"></a>
<a class="sourceLine" id="cb30-9" data-line-number="9">random_rows &lt;-<span class="st"> </span><span class="cf">function</span>(data, n){</a>
<a class="sourceLine" id="cb30-10" data-line-number="10">  <span class="kw">stopifnot</span>(n <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb30-11" data-line-number="11">  data[<span class="kw">sample.int</span>(<span class="dt">n =</span> <span class="kw">nrow</span>(data), <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>), ]</a>
<a class="sourceLine" id="cb30-12" data-line-number="12">}</a></code></pre></div>
<p>Then, we forget to run <code>make()</code> again, and we leave the the project for several months. When we come back, all our targets are suddenly out of date.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">outdated</span>(config)</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">##  [1] &quot;coef_regression1_large&quot; &quot;coef_regression1_small&quot;</a>
<a class="sourceLine" id="cb31-3" data-line-number="3">##  [3] &quot;coef_regression2_large&quot; &quot;coef_regression2_small&quot;</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">##  [5] &quot;large&quot;                  &quot;regression1_large&quot;     </a>
<a class="sourceLine" id="cb31-5" data-line-number="5">##  [7] &quot;regression1_small&quot;      &quot;regression2_large&quot;     </a>
<a class="sourceLine" id="cb31-6" data-line-number="6">##  [9] &quot;regression2_small&quot;      &quot;report&quot;                </a>
<a class="sourceLine" id="cb31-7" data-line-number="7">## [11] &quot;small&quot;                  &quot;summ_regression1_large&quot;</a>
<a class="sourceLine" id="cb31-8" data-line-number="8">## [13] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;</a>
<a class="sourceLine" id="cb31-9" data-line-number="9">## [15] &quot;summ_regression2_small&quot;</a></code></pre></div>
<p>At first, we may not know why all our targets are outdated. But we can generate another cache log and check any hashes that changed. Our call to <code>outdated()</code> already re-cached the imports, so any changed imports will show up in the new log file.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">drake_cache_log_file</span>(<span class="dt">file =</span> <span class="st">&quot;cache_log2.txt&quot;</span>)</a>
<a class="sourceLine" id="cb32-2" data-line-number="2"></a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="kw">system2</span>(<span class="st">&quot;diff&quot;</span>, <span class="st">&quot;cache_log.txt cache_log2.txt&quot;</span>, <span class="dt">stdout =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb32-4" data-line-number="4"><span class="st">  </span><span class="kw">cat</span>(<span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb32-5" data-line-number="5">## Warning in system2(&quot;diff&quot;, &quot;cache_log.txt cache_log2.txt&quot;, stdout = TRUE):</a>
<a class="sourceLine" id="cb32-6" data-line-number="6">## running command &#39;&#39;diff&#39; cache_log.txt cache_log2.txt&#39; had status 1</a>
<a class="sourceLine" id="cb32-7" data-line-number="7">## 9c9</a>
<a class="sourceLine" id="cb32-8" data-line-number="8">## &lt; 44b898f3c687ee02 import random_rows</a>
<a class="sourceLine" id="cb32-9" data-line-number="9">## ---</a>
<a class="sourceLine" id="cb32-10" data-line-number="10">## &gt; a2ed0494ada81cff import random_rows</a>
<a class="sourceLine" id="cb32-11" data-line-number="11">## 17c17</a>
<a class="sourceLine" id="cb32-12" data-line-number="12">## &lt; 4acbf8bf5b7452c9 import simulate</a>
<a class="sourceLine" id="cb32-13" data-line-number="13">## ---</a>
<a class="sourceLine" id="cb32-14" data-line-number="14">## &gt; 0f44eb1457517517 import simulate</a></code></pre></div>
<p>Now, we see that <code>random_rows()</code> has changed since last time, and we have a new dependency <code>stopifnot()</code>. <code>simulate()</code> shows up in the changes too, but only because <code>random_rows()</code> is nested in the body of <code>simulate()</code>. If we revert <code>random_rows()</code> to its original state, all our targets are up to date again.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">random_rows &lt;-<span class="st"> </span><span class="cf">function</span>(data, n){</a>
<a class="sourceLine" id="cb33-2" data-line-number="2">  data[<span class="kw">sample.int</span>(<span class="dt">n =</span> <span class="kw">nrow</span>(data), <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>), ]</a>
<a class="sourceLine" id="cb33-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb33-4" data-line-number="4"></a>
<a class="sourceLine" id="cb33-5" data-line-number="5"><span class="kw">outdated</span>(config)</a>
<a class="sourceLine" id="cb33-6" data-line-number="6">## character(0)</a>
<a class="sourceLine" id="cb33-7" data-line-number="7"></a>
<a class="sourceLine" id="cb33-8" data-line-number="8"><span class="kw">drake_cache_log_file</span>(<span class="dt">file =</span> <span class="st">&quot;cache_log3.txt&quot;</span>)</a>
<a class="sourceLine" id="cb33-9" data-line-number="9"></a>
<a class="sourceLine" id="cb33-10" data-line-number="10"><span class="kw">system2</span>(<span class="st">&quot;diff&quot;</span>, <span class="st">&quot;cache_log.txt cache_log3.txt&quot;</span>, <span class="dt">stdout =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb33-11" data-line-number="11">## character(0)</a></code></pre></div>
</div>
</div>
<div id="diagnose-failures." class="section level2">
<h2><span class="header-section-number">B.2</span> Diagnose failures.</h2>
<p><code>drake</code> records diagnostic metadata on all your targets, including the latest errors, warnings, messages, and other bits of context.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb34-2" data-line-number="2">  <span class="cf">if</span> (x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">    <span class="kw">stop</span>(<span class="st">&quot;`x` cannot be negative.&quot;</span>)</a>
<a class="sourceLine" id="cb34-4" data-line-number="4">  }</a>
<a class="sourceLine" id="cb34-5" data-line-number="5">  x</a>
<a class="sourceLine" id="cb34-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb34-7" data-line-number="7">bad_plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(</a>
<a class="sourceLine" id="cb34-8" data-line-number="8">  <span class="dt">a =</span> <span class="dv">12</span>,</a>
<a class="sourceLine" id="cb34-9" data-line-number="9">  <span class="dt">b =</span> <span class="op">-</span>a,</a>
<a class="sourceLine" id="cb34-10" data-line-number="10">  <span class="dt">my_target =</span> <span class="kw">f</span>(b)</a>
<a class="sourceLine" id="cb34-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb34-12" data-line-number="12"></a>
<a class="sourceLine" id="cb34-13" data-line-number="13">bad_plan</a>
<a class="sourceLine" id="cb34-14" data-line-number="14">## # A tibble: 3 x 2</a>
<a class="sourceLine" id="cb34-15" data-line-number="15">##   target    command</a>
<a class="sourceLine" id="cb34-16" data-line-number="16">##   &lt;chr&gt;     &lt;chr&gt;  </a>
<a class="sourceLine" id="cb34-17" data-line-number="17">## 1 a         12     </a>
<a class="sourceLine" id="cb34-18" data-line-number="18">## 2 b         -a     </a>
<a class="sourceLine" id="cb34-19" data-line-number="19">## 3 my_target f(b)</a>
<a class="sourceLine" id="cb34-20" data-line-number="20"></a>
<a class="sourceLine" id="cb34-21" data-line-number="21">withr<span class="op">::</span><span class="kw">with_message_sink</span>(</a>
<a class="sourceLine" id="cb34-22" data-line-number="22">  <span class="dt">new =</span> <span class="kw">stdout</span>(),</a>
<a class="sourceLine" id="cb34-23" data-line-number="23">  <span class="kw">make</span>(bad_plan)</a>
<a class="sourceLine" id="cb34-24" data-line-number="24">)</a>
<a class="sourceLine" id="cb34-25" data-line-number="25">## target a</a>
<a class="sourceLine" id="cb34-26" data-line-number="26">## target b</a>
<a class="sourceLine" id="cb34-27" data-line-number="27">## target my_target</a>
<a class="sourceLine" id="cb34-28" data-line-number="28">## fail my_target</a>
<a class="sourceLine" id="cb34-29" data-line-number="29">## Error: Target `my_target` failed. Call `diagnose(my_target)` for details. Error message:</a>
<a class="sourceLine" id="cb34-30" data-line-number="30">##   `x` cannot be negative.</a>
<a class="sourceLine" id="cb34-31" data-line-number="31">## Warning: No message sink to remove.</a>
<a class="sourceLine" id="cb34-32" data-line-number="32"></a>
<a class="sourceLine" id="cb34-33" data-line-number="33"><span class="kw">failed</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) <span class="co"># from the last make() only</span></a>
<a class="sourceLine" id="cb34-34" data-line-number="34">## [1] &quot;my_target&quot;</a>
<a class="sourceLine" id="cb34-35" data-line-number="35"></a>
<a class="sourceLine" id="cb34-36" data-line-number="36"><span class="co"># See also warnings and messages.</span></a>
<a class="sourceLine" id="cb34-37" data-line-number="37">error &lt;-<span class="st"> </span><span class="kw">diagnose</span>(my_target, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)<span class="op">$</span>error</a>
<a class="sourceLine" id="cb34-38" data-line-number="38"></a>
<a class="sourceLine" id="cb34-39" data-line-number="39">error<span class="op">$</span>message</a>
<a class="sourceLine" id="cb34-40" data-line-number="40">## [1] &quot;`x` cannot be negative.&quot;</a>
<a class="sourceLine" id="cb34-41" data-line-number="41"></a>
<a class="sourceLine" id="cb34-42" data-line-number="42">error<span class="op">$</span>call</a>
<a class="sourceLine" id="cb34-43" data-line-number="43">## f(b)</a>
<a class="sourceLine" id="cb34-44" data-line-number="44"></a>
<a class="sourceLine" id="cb34-45" data-line-number="45"><span class="kw">str</span>(error<span class="op">$</span>calls) <span class="co"># View the traceback.</span></a>
<a class="sourceLine" id="cb34-46" data-line-number="46">## List of 8</a>
<a class="sourceLine" id="cb34-47" data-line-number="47">##  $ : language local({     f(b) ...</a>
<a class="sourceLine" id="cb34-48" data-line-number="48">##  $ : language eval.parent(substitute(eval(quote(expr), envir)))</a>
<a class="sourceLine" id="cb34-49" data-line-number="49">##  $ : language eval(expr, p)</a>
<a class="sourceLine" id="cb34-50" data-line-number="50">##  $ : language eval(expr, p)</a>
<a class="sourceLine" id="cb34-51" data-line-number="51">##  $ : language eval(quote({     f(b) ...</a>
<a class="sourceLine" id="cb34-52" data-line-number="52">##  $ : language eval(quote({     f(b) ...</a>
<a class="sourceLine" id="cb34-53" data-line-number="53">##  $ : language f(b)</a>
<a class="sourceLine" id="cb34-54" data-line-number="54">##  $ : language stop(&quot;`x` cannot be negative.&quot;)</a>
<a class="sourceLine" id="cb34-55" data-line-number="55">##   ..- attr(*, &quot;srcref&quot;)= &#39;srcref&#39; int [1:8] 3 5 3 35 5 35 3 3</a>
<a class="sourceLine" id="cb34-56" data-line-number="56">##   .. ..- attr(*, &quot;srcfile&quot;)=Classes &#39;srcfilecopy&#39;, &#39;srcfile&#39; &lt;environment: 0x93585e8&gt;</a></code></pre></div>
<p>To figure out what went wrong, you could try to build the failed target interactively. To do that, simply call <code>drake_build()</code> or <code>drake_debug()</code>. These functions first call <code>loadd(deps = TRUE)</code> to load any missing dependencies (see the <code>replace</code> argument here) and then build your target. <code>drake_build()</code> simply runs the command, and <code>drake_debug()</code> runs the command in debug mode using <code>debugonce()</code>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="co"># Pretend we just opened a new R session.</span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="kw">library</span>(drake)</a>
<a class="sourceLine" id="cb35-3" data-line-number="3"></a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="co"># Unloads target `b`.</span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5">config &lt;-<span class="st"> </span><span class="kw">drake_config</span>(<span class="dt">plan =</span> bad_plan)</a>
<a class="sourceLine" id="cb35-6" data-line-number="6">## Unloading targets from environment:</a>
<a class="sourceLine" id="cb35-7" data-line-number="7">##   b</a>
<a class="sourceLine" id="cb35-8" data-line-number="8"></a>
<a class="sourceLine" id="cb35-9" data-line-number="9"><span class="co"># my_target depends on b.</span></a>
<a class="sourceLine" id="cb35-10" data-line-number="10"><span class="st">&quot;b&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">ls</span>()</a>
<a class="sourceLine" id="cb35-11" data-line-number="11">## [1] FALSE</a>
<a class="sourceLine" id="cb35-12" data-line-number="12"></a>
<a class="sourceLine" id="cb35-13" data-line-number="13"><span class="co"># Try to build my_target until the error is fixed.</span></a>
<a class="sourceLine" id="cb35-14" data-line-number="14"><span class="co"># Skip all that pesky work checking dependencies.</span></a>
<a class="sourceLine" id="cb35-15" data-line-number="15"><span class="kw">drake_build</span>(my_target, <span class="dt">config =</span> config) <span class="co"># See also drake_debug().</span></a>
<a class="sourceLine" id="cb35-16" data-line-number="16">## target my_target</a>
<a class="sourceLine" id="cb35-17" data-line-number="17">## fail my_target</a>
<a class="sourceLine" id="cb35-18" data-line-number="18">## Error: Target `my_target` failed. Call `diagnose(my_target)` for details. Error message:</a>
<a class="sourceLine" id="cb35-19" data-line-number="19">##   `x` cannot be negative.</a>
<a class="sourceLine" id="cb35-20" data-line-number="20"></a>
<a class="sourceLine" id="cb35-21" data-line-number="21"><span class="co"># The target failed, but the dependency was loaded.</span></a>
<a class="sourceLine" id="cb35-22" data-line-number="22"><span class="st">&quot;b&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">ls</span>()</a>
<a class="sourceLine" id="cb35-23" data-line-number="23">## [1] TRUE</a>
<a class="sourceLine" id="cb35-24" data-line-number="24"></a>
<a class="sourceLine" id="cb35-25" data-line-number="25"><span class="co"># What was `b` again?</span></a>
<a class="sourceLine" id="cb35-26" data-line-number="26">b</a>
<a class="sourceLine" id="cb35-27" data-line-number="27">## [1] -12</a>
<a class="sourceLine" id="cb35-28" data-line-number="28"></a>
<a class="sourceLine" id="cb35-29" data-line-number="29"><span class="co"># How was `b` used?</span></a>
<a class="sourceLine" id="cb35-30" data-line-number="30"><span class="kw">diagnose</span>(my_target)<span class="op">$</span>message</a>
<a class="sourceLine" id="cb35-31" data-line-number="31">## NULL</a>
<a class="sourceLine" id="cb35-32" data-line-number="32"></a>
<a class="sourceLine" id="cb35-33" data-line-number="33"><span class="kw">diagnose</span>(my_target)<span class="op">$</span>call</a>
<a class="sourceLine" id="cb35-34" data-line-number="34">## NULL</a>
<a class="sourceLine" id="cb35-35" data-line-number="35"></a>
<a class="sourceLine" id="cb35-36" data-line-number="36">f</a>
<a class="sourceLine" id="cb35-37" data-line-number="37">## function(x){</a>
<a class="sourceLine" id="cb35-38" data-line-number="38">##   if (x &lt; 0){</a>
<a class="sourceLine" id="cb35-39" data-line-number="39">##     stop(&quot;`x` cannot be negative.&quot;)</a>
<a class="sourceLine" id="cb35-40" data-line-number="40">##   }</a>
<a class="sourceLine" id="cb35-41" data-line-number="41">##   x</a>
<a class="sourceLine" id="cb35-42" data-line-number="42">## }</a>
<a class="sourceLine" id="cb35-43" data-line-number="43">## &lt;bytecode: 0x849e6e8&gt;</a>
<a class="sourceLine" id="cb35-44" data-line-number="44"></a>
<a class="sourceLine" id="cb35-45" data-line-number="45"><span class="co"># Aha! The error was in f(). Let&#39;s fix it and try again.</span></a>
<a class="sourceLine" id="cb35-46" data-line-number="46">f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb35-47" data-line-number="47">  x &lt;-<span class="st"> </span><span class="kw">abs</span>(x)</a>
<a class="sourceLine" id="cb35-48" data-line-number="48">  <span class="cf">if</span> (x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb35-49" data-line-number="49">    <span class="kw">stop</span>(<span class="st">&quot;`x` cannot be negative.&quot;</span>)</a>
<a class="sourceLine" id="cb35-50" data-line-number="50">  }</a>
<a class="sourceLine" id="cb35-51" data-line-number="51">  x</a>
<a class="sourceLine" id="cb35-52" data-line-number="52">}</a>
<a class="sourceLine" id="cb35-53" data-line-number="53"></a>
<a class="sourceLine" id="cb35-54" data-line-number="54"><span class="co"># Now it works!</span></a>
<a class="sourceLine" id="cb35-55" data-line-number="55"><span class="co"># Since you called make() previously, `config` is read from the cache</span></a>
<a class="sourceLine" id="cb35-56" data-line-number="56"><span class="co"># if you do not supply it.</span></a>
<a class="sourceLine" id="cb35-57" data-line-number="57"><span class="kw">drake_build</span>(my_target) <span class="co"># See also drake_debug().</span></a>
<a class="sourceLine" id="cb35-58" data-line-number="58">## target my_target</a>
<a class="sourceLine" id="cb35-59" data-line-number="59"></a>
<a class="sourceLine" id="cb35-60" data-line-number="60"><span class="kw">readd</span>(my_target)</a>
<a class="sourceLine" id="cb35-61" data-line-number="61">## [1] 12</a></code></pre></div>
</div>
<div id="timeouts-and-retries" class="section level2">
<h2><span class="header-section-number">B.3</span> Timeouts and retries</h2>
<p>See the <code>timeout</code>, <code>cpu</code>, <code>elapsed</code>, and <code>retries</code> argument to <code>make()</code>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">clean</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb36-2" data-line-number="2">f &lt;-<span class="st"> </span><span class="cf">function</span>(...){</a>
<a class="sourceLine" id="cb36-3" data-line-number="3">  <span class="kw">Sys.sleep</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb36-4" data-line-number="4">}</a>
<a class="sourceLine" id="cb36-5" data-line-number="5">debug_plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="kw">f</span>(x))</a>
<a class="sourceLine" id="cb36-6" data-line-number="6">debug_plan</a>
<a class="sourceLine" id="cb36-7" data-line-number="7">## # A tibble: 2 x 2</a>
<a class="sourceLine" id="cb36-8" data-line-number="8">##   target command</a>
<a class="sourceLine" id="cb36-9" data-line-number="9">##   &lt;chr&gt;  &lt;chr&gt;  </a>
<a class="sourceLine" id="cb36-10" data-line-number="10">## 1 x      1      </a>
<a class="sourceLine" id="cb36-11" data-line-number="11">## 2 y      f(x)</a>
<a class="sourceLine" id="cb36-12" data-line-number="12"></a>
<a class="sourceLine" id="cb36-13" data-line-number="13">withr<span class="op">::</span><span class="kw">with_message_sink</span>(</a>
<a class="sourceLine" id="cb36-14" data-line-number="14">  <span class="kw">stdout</span>(),</a>
<a class="sourceLine" id="cb36-15" data-line-number="15">  <span class="kw">make</span>(debug_plan, <span class="dt">timeout =</span> <span class="fl">1e-3</span>, <span class="dt">retries =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb36-16" data-line-number="16">)</a>
<a class="sourceLine" id="cb36-17" data-line-number="17">## target x</a>
<a class="sourceLine" id="cb36-18" data-line-number="18">## target y</a>
<a class="sourceLine" id="cb36-19" data-line-number="19">## retry y: 1 of 2</a>
<a class="sourceLine" id="cb36-20" data-line-number="20">## Warning: No message sink to remove.</a></code></pre></div>
<p>To tailor these settings to each individual target, create new <code>timeout</code>, <code>cpu</code>, <code>elapsed</code>, or <code>retries</code> columns in your workflow plan. These columns override the analogous arguments to <code>make()</code>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">clean</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb37-2" data-line-number="2">debug_plan<span class="op">$</span>timeout &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1e-3</span>, <span class="fl">2e-3</span>)</a>
<a class="sourceLine" id="cb37-3" data-line-number="3">debug_plan<span class="op">$</span>retries &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"></a>
<a class="sourceLine" id="cb37-5" data-line-number="5">debug_plan</a>
<a class="sourceLine" id="cb37-6" data-line-number="6">## # A tibble: 2 x 4</a>
<a class="sourceLine" id="cb37-7" data-line-number="7">##   target command timeout retries</a>
<a class="sourceLine" id="cb37-8" data-line-number="8">##   &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;   &lt;int&gt;</a>
<a class="sourceLine" id="cb37-9" data-line-number="9">## 1 x      1         0.001       1</a>
<a class="sourceLine" id="cb37-10" data-line-number="10">## 2 y      f(x)      0.002       2</a>
<a class="sourceLine" id="cb37-11" data-line-number="11"></a>
<a class="sourceLine" id="cb37-12" data-line-number="12">withr<span class="op">::</span><span class="kw">with_message_sink</span>(</a>
<a class="sourceLine" id="cb37-13" data-line-number="13">  <span class="dt">new =</span> <span class="kw">stdout</span>(),</a>
<a class="sourceLine" id="cb37-14" data-line-number="14">  <span class="kw">make</span>(debug_plan, <span class="dt">timeout =</span> <span class="ot">Inf</span>, <span class="dt">retries =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb37-15" data-line-number="15">)</a>
<a class="sourceLine" id="cb37-16" data-line-number="16">## target x</a>
<a class="sourceLine" id="cb37-17" data-line-number="17">## target y</a>
<a class="sourceLine" id="cb37-18" data-line-number="18">## fail y</a>
<a class="sourceLine" id="cb37-19" data-line-number="19">## Error: Target `y` failed. Call `diagnose(y)` for details. Error message:</a>
<a class="sourceLine" id="cb37-20" data-line-number="20">##   reached elapsed time limit</a>
<a class="sourceLine" id="cb37-21" data-line-number="21">## Warning: No message sink to remove.</a></code></pre></div>
</div>
<div id="consider-hasty-mode" class="section level2">
<h2><span class="header-section-number">B.4</span> Consider hasty mode</h2>
<p>In hasty mode, <code>drake</code> acts as a job scheduler without watching dependencies. In other words, <code>make(parallelism = &quot;hasty&quot;)</code> always runs all the targets, and computational overhead is dramatically reduced. Because it helps deploy targets much faster, hasty mode may be a nice way to test a workflow before running it in production. Read more <a href="https://ropenscilabs.github.io/drake-manual/hpc.html#hasty-mode">here</a>.</p>
</div>
<div id="more-help" class="section level2">
<h2><span class="header-section-number">B.5</span> More help</h2>
<p>Please also see the <a href="caution.html#caution">compendium of cautionary notes</a>, which addresses <code>drake</code>’s known edge cases, pitfalls, and weaknesses that may or may not be fixed in future releases. For the most up-to-date information on unhandled edge cases, please visit the <a href="https://github.com/ropensci/drake/issues">issue tracker</a>, where you can submit your own bug reports as well. Be sure to search the closed issues too, especially if you are not using the most up-to-date development version.</p>

</div>
</div>



</div>
<div style = "background: #1C356D; color: white; padding: 10px 10px 10px 25px; font-size: 1em; width: 100%;">
  Copyright Eli Lilly and Company
</div>
            </section>

          </div>
        </div>
      </div>
<a href="caution.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="faq.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
