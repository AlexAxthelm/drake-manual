<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>The User Manual of the drake R Package</title>
  <meta name="description" content="The User Manual of the drake R Package">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="The User Manual of the drake R Package" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="The User Manual of the drake R Package" />
  
  
  

<meta name="author" content="Will Landau, Alex Axthelm, Jasper Clarkberg, Kirill Müller, Lorenz Walthert, Ben Marwick, and Peter Slaughter">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="time.html">
<link rel="next" href="caution.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.4/visNetwork.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-drake-r-package"><i class="fa fa-check"></i><b>1.1</b> The drake R package</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#why-drake"><i class="fa fa-check"></i><b>1.3</b> Why drake?</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#what-gets-done-stays-done."><i class="fa fa-check"></i><b>1.3.1</b> What gets done stays done.</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#reproducibility-with-confidence"><i class="fa fa-check"></i><b>1.3.2</b> Reproducibility with confidence</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#aggressively-scale-up."><i class="fa fa-check"></i><b>1.3.3</b> Aggressively scale up.</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#documentation"><i class="fa fa-check"></i><b>1.4</b> Documentation</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#cheat-sheet"><i class="fa fa-check"></i><b>1.4.1</b> Cheat sheet</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#frequently-asked-questions"><i class="fa fa-check"></i><b>1.4.2</b> Frequently asked questions</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#function-reference"><i class="fa fa-check"></i><b>1.4.3</b> Function reference</a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#tutorials"><i class="fa fa-check"></i><b>1.4.4</b> Tutorials</a></li>
<li class="chapter" data-level="1.4.5" data-path="index.html"><a href="index.html#examples"><i class="fa fa-check"></i><b>1.4.5</b> Examples</a></li>
<li class="chapter" data-level="1.4.6" data-path="index.html"><a href="index.html#presentations"><i class="fa fa-check"></i><b>1.4.6</b> Presentations</a></li>
<li class="chapter" data-level="1.4.7" data-path="index.html"><a href="index.html#real-example-projects"><i class="fa fa-check"></i><b>1.4.7</b> Real example projects</a></li>
<li class="chapter" data-level="1.4.8" data-path="index.html"><a href="index.html#context-and-history"><i class="fa fa-check"></i><b>1.4.8</b> Context and history</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#help-and-troubleshooting"><i class="fa fa-check"></i><b>1.5</b> Help and troubleshooting</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#similar-work"><i class="fa fa-check"></i><b>1.6</b> Similar work</a><ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#gnu-make"><i class="fa fa-check"></i><b>1.6.1</b> GNU Make</a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#remake"><i class="fa fa-check"></i><b>1.6.2</b> Remake</a></li>
<li class="chapter" data-level="1.6.3" data-path="index.html"><a href="index.html#memoise"><i class="fa fa-check"></i><b>1.6.3</b> Memoise</a></li>
<li class="chapter" data-level="1.6.4" data-path="index.html"><a href="index.html#knitr-and-r-markdown"><i class="fa fa-check"></i><b>1.6.4</b> Knitr and R Markdown</a></li>
<li class="chapter" data-level="1.6.5" data-path="index.html"><a href="index.html#factuals-drake"><i class="fa fa-check"></i><b>1.6.5</b> Factual’s Drake</a></li>
<li class="chapter" data-level="1.6.6" data-path="index.html"><a href="index.html#other-pipeline-toolkits"><i class="fa fa-check"></i><b>1.6.6</b> Other pipeline toolkits</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.7</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="example-main.html"><a href="example-main.html"><i class="fa fa-check"></i><b>2</b> The main example</a><ul>
<li class="chapter" data-level="2.1" data-path="example-main.html"><a href="example-main.html#set-the-stage."><i class="fa fa-check"></i><b>2.1</b> Set the stage.</a></li>
<li class="chapter" data-level="2.2" data-path="example-main.html"><a href="example-main.html#make-your-results."><i class="fa fa-check"></i><b>2.2</b> Make your results.</a></li>
<li class="chapter" data-level="2.3" data-path="example-main.html"><a href="example-main.html#go-back-and-fix-things."><i class="fa fa-check"></i><b>2.3</b> Go back and fix things.</a></li>
<li class="chapter" data-level="2.4" data-path="example-main.html"><a href="example-main.html#try-it-yourself"><i class="fa fa-check"></i><b>2.4</b> Try it yourself!</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="plans.html"><a href="plans.html"><i class="fa fa-check"></i><b>3</b> Workflow data frames</a><ul>
<li class="chapter" data-level="3.1" data-path="plans.html"><a href="plans.html#what-is-a-workflow-plan-data-frame"><i class="fa fa-check"></i><b>3.1</b> What is a workflow plan data frame?</a></li>
<li class="chapter" data-level="3.2" data-path="plans.html"><a href="plans.html#rationale"><i class="fa fa-check"></i><b>3.2</b> Rationale</a><ul>
<li class="chapter" data-level="3.2.1" data-path="plans.html"><a href="plans.html#you-can-skip-up-to-date-work."><i class="fa fa-check"></i><b>3.2.1</b> You can skip up-to-date work.</a></li>
<li class="chapter" data-level="3.2.2" data-path="plans.html"><a href="plans.html#you-do-not-need-to-worry-about-which-targets-run-first."><i class="fa fa-check"></i><b>3.2.2</b> You do not need to worry about which targets run first.</a></li>
<li class="chapter" data-level="3.2.3" data-path="plans.html"><a href="plans.html#data-frames-scale-well."><i class="fa fa-check"></i><b>3.2.3</b> Data frames scale well.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="plans.html"><a href="plans.html#generating-large-workflow-plans"><i class="fa fa-check"></i><b>3.3</b> Generating large workflow plans</a><ul>
<li class="chapter" data-level="3.3.1" data-path="plans.html"><a href="plans.html#wildcard-templating"><i class="fa fa-check"></i><b>3.3.1</b> Wildcard templating</a></li>
<li class="chapter" data-level="3.3.2" data-path="plans.html"><a href="plans.html#specialized-wildcard-functionality"><i class="fa fa-check"></i><b>3.3.2</b> Specialized wildcard functionality</a></li>
<li class="chapter" data-level="3.3.3" data-path="plans.html"><a href="plans.html#non-wildcard-functions"><i class="fa fa-check"></i><b>3.3.3</b> Non-wildcard functions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="plans.html"><a href="plans.html#optional-columns-in-your-plan."><i class="fa fa-check"></i><b>3.4</b> Optional columns in your plan.</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="example-packages.html"><a href="example-packages.html"><i class="fa fa-check"></i><b>4</b> Example: R package download trends</a><ul>
<li class="chapter" data-level="4.1" data-path="example-packages.html"><a href="example-packages.html#get-the-code."><i class="fa fa-check"></i><b>4.1</b> Get the code.</a></li>
<li class="chapter" data-level="4.2" data-path="example-packages.html"><a href="example-packages.html#overview"><i class="fa fa-check"></i><b>4.2</b> Overview</a></li>
<li class="chapter" data-level="4.3" data-path="example-packages.html"><a href="example-packages.html#analysis"><i class="fa fa-check"></i><b>4.3</b> Analysis</a></li>
<li class="chapter" data-level="4.4" data-path="example-packages.html"><a href="example-packages.html#what-remote-data-sources-in-general"><i class="fa fa-check"></i><b>4.4</b> What remote data sources in general?</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="example-gsp.html"><a href="example-gsp.html"><i class="fa fa-check"></i><b>5</b> Example: gross state products</a><ul>
<li class="chapter" data-level="5.1" data-path="example-gsp.html"><a href="example-gsp.html#get-the-code.-1"><i class="fa fa-check"></i><b>5.1</b> Get the code.</a></li>
<li class="chapter" data-level="5.2" data-path="example-gsp.html"><a href="example-gsp.html#objective-and-methods"><i class="fa fa-check"></i><b>5.2</b> Objective and methods</a></li>
<li class="chapter" data-level="5.3" data-path="example-gsp.html"><a href="example-gsp.html#data"><i class="fa fa-check"></i><b>5.3</b> Data</a></li>
<li class="chapter" data-level="5.4" data-path="example-gsp.html"><a href="example-gsp.html#analysis-1"><i class="fa fa-check"></i><b>5.4</b> Analysis</a></li>
<li class="chapter" data-level="5.5" data-path="example-gsp.html"><a href="example-gsp.html#results"><i class="fa fa-check"></i><b>5.5</b> Results</a></li>
<li class="chapter" data-level="5.6" data-path="example-gsp.html"><a href="example-gsp.html#comparison-with-gnu-make"><i class="fa fa-check"></i><b>5.6</b> Comparison with GNU Make</a></li>
<li class="chapter" data-level="5.7" data-path="example-gsp.html"><a href="example-gsp.html#references"><i class="fa fa-check"></i><b>5.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mtcars.html"><a href="mtcars.html"><i class="fa fa-check"></i><b>6</b> The mtcars example and workflow plan generation</a><ul>
<li class="chapter" data-level="6.1" data-path="mtcars.html"><a href="mtcars.html#get-the-code.-2"><i class="fa fa-check"></i><b>6.1</b> Get the code.</a></li>
<li class="chapter" data-level="6.2" data-path="mtcars.html"><a href="mtcars.html#quick-examples"><i class="fa fa-check"></i><b>6.2</b> Quick examples</a></li>
<li class="chapter" data-level="6.3" data-path="mtcars.html"><a href="mtcars.html#the-motivation-of-the-mtcars-example"><i class="fa fa-check"></i><b>6.3</b> The motivation of the mtcars example</a></li>
<li class="chapter" data-level="6.4" data-path="mtcars.html"><a href="mtcars.html#set-up-the-mtcars-example"><i class="fa fa-check"></i><b>6.4</b> Set up the mtcars example</a></li>
<li class="chapter" data-level="6.5" data-path="mtcars.html"><a href="mtcars.html#the-workflow-plan-data-frame"><i class="fa fa-check"></i><b>6.5</b> The workflow plan data frame</a></li>
<li class="chapter" data-level="6.6" data-path="mtcars.html"><a href="mtcars.html#generate-the-workflow-plan"><i class="fa fa-check"></i><b>6.6</b> Generate the workflow plan</a></li>
<li class="chapter" data-level="6.7" data-path="mtcars.html"><a href="mtcars.html#flexible-workflow-plan-generation"><i class="fa fa-check"></i><b>6.7</b> Flexible workflow plan generation</a></li>
<li class="chapter" data-level="6.8" data-path="mtcars.html"><a href="mtcars.html#run-the-workflow"><i class="fa fa-check"></i><b>6.8</b> Run the workflow</a></li>
<li class="chapter" data-level="6.9" data-path="mtcars.html"><a href="mtcars.html#automatic-watching-for-changed-dependencies"><i class="fa fa-check"></i><b>6.9</b> Automatic watching for changed dependencies</a></li>
<li class="chapter" data-level="6.10" data-path="mtcars.html"><a href="mtcars.html#a-note-on-tidy-evaluation"><i class="fa fa-check"></i><b>6.10</b> A note on tidy evaluation</a></li>
<li class="chapter" data-level="6.11" data-path="mtcars.html"><a href="mtcars.html#need-more-speed"><i class="fa fa-check"></i><b>6.11</b> Need more speed?</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="best-practices.html"><a href="best-practices.html"><i class="fa fa-check"></i><b>7</b> General best practices for drake projects</a><ul>
<li class="chapter" data-level="7.1" data-path="best-practices.html"><a href="best-practices.html#how-to-organize-your-files"><i class="fa fa-check"></i><b>7.1</b> How to organize your files</a><ul>
<li class="chapter" data-level="7.1.1" data-path="best-practices.html"><a href="best-practices.html#examples-1"><i class="fa fa-check"></i><b>7.1.1</b> Examples</a></li>
<li class="chapter" data-level="7.1.2" data-path="best-practices.html"><a href="best-practices.html#where-do-you-put-your-code"><i class="fa fa-check"></i><b>7.1.2</b> Where do you put your code?</a></li>
<li class="chapter" data-level="7.1.3" data-path="best-practices.html"><a href="best-practices.html#remember-your-commands-are-code-chunks-not-r-scripts"><i class="fa fa-check"></i><b>7.1.3</b> Remember: your commands are code chunks, not R scripts</a></li>
<li class="chapter" data-level="7.1.4" data-path="best-practices.html"><a href="best-practices.html#file-output-targets"><i class="fa fa-check"></i><b>7.1.4</b> File output targets</a></li>
<li class="chapter" data-level="7.1.5" data-path="best-practices.html"><a href="best-practices.html#r-markdown-and-knitr-reports"><i class="fa fa-check"></i><b>7.1.5</b> R Markdown and knitr reports</a></li>
<li class="chapter" data-level="7.1.6" data-path="best-practices.html"><a href="best-practices.html#workflows-as-r-packages"><i class="fa fa-check"></i><b>7.1.6</b> Workflows as R packages</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="best-practices.html"><a href="best-practices.html#remote-data-sources"><i class="fa fa-check"></i><b>7.2</b> Remote data sources</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="vis.html"><a href="vis.html"><i class="fa fa-check"></i><b>8</b> Visualization with drake</a><ul>
<li class="chapter" data-level="8.1" data-path="vis.html"><a href="vis.html#dependency-reactivity"><i class="fa fa-check"></i><b>8.1</b> Dependency reactivity</a></li>
<li class="chapter" data-level="8.2" data-path="vis.html"><a href="vis.html#subgraphs"><i class="fa fa-check"></i><b>8.2</b> Subgraphs</a></li>
<li class="chapter" data-level="8.3" data-path="vis.html"><a href="vis.html#control-the-legend."><i class="fa fa-check"></i><b>8.3</b> Control the legend.</a></li>
<li class="chapter" data-level="8.4" data-path="vis.html"><a href="vis.html#more-flexibility"><i class="fa fa-check"></i><b>8.4</b> More flexibility</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="debug.html"><a href="debug.html"><i class="fa fa-check"></i><b>9</b> Debugging and testing drake projects</a><ul>
<li class="chapter" data-level="9.1" data-path="debug.html"><a href="debug.html#the-configuration-list"><i class="fa fa-check"></i><b>9.1</b> The configuration list</a></li>
<li class="chapter" data-level="9.2" data-path="debug.html"><a href="debug.html#plan-your-work."><i class="fa fa-check"></i><b>9.2</b> Plan your work.</a><ul>
<li class="chapter" data-level="9.2.1" data-path="debug.html"><a href="debug.html#workflow-plan-data-frames"><i class="fa fa-check"></i><b>9.2.1</b> Workflow plan data frames</a></li>
<li class="chapter" data-level="9.2.2" data-path="debug.html"><a href="debug.html#visualize-your-workflow."><i class="fa fa-check"></i><b>9.2.2</b> Visualize your workflow.</a></li>
<li class="chapter" data-level="9.2.3" data-path="debug.html"><a href="debug.html#check-dependency-relationships."><i class="fa fa-check"></i><b>9.2.3</b> Check dependency relationships.</a></li>
<li class="chapter" data-level="9.2.4" data-path="debug.html"><a href="debug.html#outdated-up-to-date-and-missing-items"><i class="fa fa-check"></i><b>9.2.4</b> Outdated, up to date, and missing items</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="debug.html"><a href="debug.html#test-with-triggers."><i class="fa fa-check"></i><b>9.3</b> Test with triggers.</a></li>
<li class="chapter" data-level="9.4" data-path="debug.html"><a href="debug.html#skipping-imports"><i class="fa fa-check"></i><b>9.4</b> Skipping imports</a></li>
<li class="chapter" data-level="9.5" data-path="debug.html"><a href="debug.html#impose-timeouts-and-retries"><i class="fa fa-check"></i><b>9.5</b> Impose timeouts and retries</a></li>
<li class="chapter" data-level="9.6" data-path="debug.html"><a href="debug.html#diagnose-failures."><i class="fa fa-check"></i><b>9.6</b> Diagnose failures.</a><ul>
<li class="chapter" data-level="9.6.1" data-path="debug.html"><a href="debug.html#tidy-evaluation-a-caveat-to-diagnosing-interactively"><i class="fa fa-check"></i><b>9.6.1</b> Tidy evaluation: a caveat to diagnosing interactively</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="debug.html"><a href="debug.html#debrief-a-build-session."><i class="fa fa-check"></i><b>9.7</b> Debrief a build session.</a></li>
<li class="chapter" data-level="9.8" data-path="debug.html"><a href="debug.html#start-tinkering."><i class="fa fa-check"></i><b>9.8</b> Start tinkering.</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="hpc.html"><a href="hpc.html"><i class="fa fa-check"></i><b>10</b> High-performance computing with drake</a><ul>
<li class="chapter" data-level="10.1" data-path="hpc.html"><a href="hpc.html#batch-mode-for-long-workflows"><i class="fa fa-check"></i><b>10.1</b> Batch mode for long workflows</a></li>
<li class="chapter" data-level="10.2" data-path="hpc.html"><a href="hpc.html#let-drake-schedule-your-targets."><i class="fa fa-check"></i><b>10.2</b> Let drake schedule your targets.</a></li>
<li class="chapter" data-level="10.3" data-path="hpc.html"><a href="hpc.html#parallel-backends"><i class="fa fa-check"></i><b>10.3</b> Parallel backends</a></li>
<li class="chapter" data-level="10.4" data-path="hpc.html"><a href="hpc.html#local-workers"><i class="fa fa-check"></i><b>10.4</b> Local workers</a></li>
<li class="chapter" data-level="10.5" data-path="hpc.html"><a href="hpc.html#remote-workers"><i class="fa fa-check"></i><b>10.5</b> Remote workers</a><ul>
<li class="chapter" data-level="10.5.1" data-path="hpc.html"><a href="hpc.html#future-future_lapply-and-future_lapply_staged"><i class="fa fa-check"></i><b>10.5.1</b> <code>&quot;future&quot;</code>, <code>&quot;future_lapply&quot;</code>, and <code>&quot;future_lapply_staged&quot;</code></a></li>
<li class="chapter" data-level="10.5.2" data-path="hpc.html"><a href="hpc.html#clustermq_staged"><i class="fa fa-check"></i><b>10.5.2</b> <code>&quot;clustermq_staged&quot;</code></a></li>
<li class="chapter" data-level="10.5.3" data-path="hpc.html"><a href="hpc.html#makefile"><i class="fa fa-check"></i><b>10.5.3</b> <code>&quot;Makefile&quot;</code></a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="hpc.html"><a href="hpc.html#scheduling-algorithms"><i class="fa fa-check"></i><b>10.6</b> Scheduling algorithms</a><ul>
<li class="chapter" data-level="10.6.1" data-path="hpc.html"><a href="hpc.html#persistent-scheduling"><i class="fa fa-check"></i><b>10.6.1</b> Persistent scheduling</a></li>
<li class="chapter" data-level="10.6.2" data-path="hpc.html"><a href="hpc.html#transient-scheduling"><i class="fa fa-check"></i><b>10.6.2</b> Transient scheduling</a></li>
<li class="chapter" data-level="10.6.3" data-path="hpc.html"><a href="hpc.html#staged-scheduling"><i class="fa fa-check"></i><b>10.6.3</b> Staged scheduling</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="hpc.html"><a href="hpc.html#final-thoughts"><i class="fa fa-check"></i><b>10.7</b> Final thoughts</a><ul>
<li class="chapter" data-level="10.7.1" data-path="hpc.html"><a href="hpc.html#debugging"><i class="fa fa-check"></i><b>10.7.1</b> Debugging</a></li>
<li class="chapter" data-level="10.7.2" data-path="hpc.html"><a href="hpc.html#drake-as-an-ordinary-job-scheduler"><i class="fa fa-check"></i><b>10.7.2</b> Drake as an ordinary job scheduler</a></li>
<li class="chapter" data-level="10.7.3" data-path="hpc.html"><a href="hpc.html#more-resources"><i class="fa fa-check"></i><b>10.7.3</b> More resources</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="hpc.html"><a href="hpc.html#footnotes"><i class="fa fa-check"></i><b>10.8</b> Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="time.html"><a href="time.html"><i class="fa fa-check"></i><b>11</b> Time: logging, prediction, and strategy</a><ul>
<li class="chapter" data-level="11.1" data-path="time.html"><a href="time.html#predict-total-runtime"><i class="fa fa-check"></i><b>11.1</b> Predict total runtime</a></li>
<li class="chapter" data-level="11.2" data-path="time.html"><a href="time.html#strategize-your-high-performance-computing"><i class="fa fa-check"></i><b>11.2</b> Strategize your high-performance computing</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="store.html"><a href="store.html"><i class="fa fa-check"></i><b>12</b> Storage</a><ul>
<li class="chapter" data-level="12.1" data-path="store.html"><a href="store.html#caches"><i class="fa fa-check"></i><b>12.1</b> Caches</a></li>
<li class="chapter" data-level="12.2" data-path="store.html"><a href="store.html#hash-algorithms"><i class="fa fa-check"></i><b>12.2</b> Hash algorithms</a></li>
<li class="chapter" data-level="12.3" data-path="store.html"><a href="store.html#which-hash-algorithm-should-you-choose"><i class="fa fa-check"></i><b>12.3</b> Which hash algorithm should you choose?</a></li>
<li class="chapter" data-level="12.4" data-path="store.html"><a href="store.html#select-the-hash-algorithms-of-the-cache"><i class="fa fa-check"></i><b>12.4</b> Select the hash algorithms of the cache</a></li>
<li class="chapter" data-level="12.5" data-path="store.html"><a href="store.html#using-storr-directly"><i class="fa fa-check"></i><b>12.5</b> Using <code>storr</code> directly</a></li>
<li class="chapter" data-level="12.6" data-path="store.html"><a href="store.html#cleaning-up"><i class="fa fa-check"></i><b>12.6</b> Cleaning up</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="caution.html"><a href="caution.html"><i class="fa fa-check"></i><b>13</b> Cautionary notes</a><ul>
<li class="chapter" data-level="13.1" data-path="caution.html"><a href="caution.html#projects-built-with-drake-4.4.0-are-not-back-compatible-with-drake-4.4.0."><i class="fa fa-check"></i><b>13.1</b> Projects built with drake &lt;= 4.4.0 are not back compatible with drake &gt; 4.4.0.</a></li>
<li class="chapter" data-level="13.2" data-path="caution.html"><a href="caution.html#workflow-plans"><i class="fa fa-check"></i><b>13.2</b> Workflow plans</a><ul>
<li class="chapter" data-level="13.2.1" data-path="caution.html"><a href="caution.html#externalizing-commands-in-r-script-files"><i class="fa fa-check"></i><b>13.2.1</b> Externalizing commands in R script files</a></li>
<li class="chapter" data-level="13.2.2" data-path="caution.html"><a href="caution.html#commands-are-not-perfectly-flexible."><i class="fa fa-check"></i><b>13.2.2</b> Commands are NOT perfectly flexible.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="caution.html"><a href="caution.html#execution"><i class="fa fa-check"></i><b>13.3</b> Execution</a><ul>
<li class="chapter" data-level="13.3.1" data-path="caution.html"><a href="caution.html#install-drake-properly."><i class="fa fa-check"></i><b>13.3.1</b> Install <code>drake</code> properly.</a></li>
<li class="chapter" data-level="13.3.2" data-path="caution.html"><a href="caution.html#install-all-your-packages."><i class="fa fa-check"></i><b>13.3.2</b> Install all your packages.</a></li>
<li class="chapter" data-level="13.3.3" data-path="caution.html"><a href="caution.html#a-note-on-tidy-evaluation-1"><i class="fa fa-check"></i><b>13.3.3</b> A note on tidy evaluation</a></li>
<li class="chapter" data-level="13.3.4" data-path="caution.html"><a href="caution.html#find-and-diagnose-your-errors."><i class="fa fa-check"></i><b>13.3.4</b> Find and diagnose your errors.</a></li>
<li class="chapter" data-level="13.3.5" data-path="caution.html"><a href="caution.html#refresh-the-drake_config-list-early-and-often."><i class="fa fa-check"></i><b>13.3.5</b> Refresh the <code>drake_config()</code> list early and often.</a></li>
<li class="chapter" data-level="13.3.6" data-path="caution.html"><a href="caution.html#workflows-as-r-packages."><i class="fa fa-check"></i><b>13.3.6</b> Workflows as R packages.</a></li>
<li class="chapter" data-level="13.3.7" data-path="caution.html"><a href="caution.html#the-lazy_load-flag-does-not-work-with-parlapply-parallelism."><i class="fa fa-check"></i><b>13.3.7</b> The <code>lazy_load</code> flag does not work with <code>&quot;parLapply&quot;</code> parallelism.</a></li>
<li class="chapter" data-level="13.3.8" data-path="caution.html"><a href="caution.html#timeouts-may-be-unreliable."><i class="fa fa-check"></i><b>13.3.8</b> Timeouts may be unreliable.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="caution.html"><a href="caution.html#dependencies"><i class="fa fa-check"></i><b>13.4</b> Dependencies</a><ul>
<li class="chapter" data-level="13.4.1" data-path="caution.html"><a href="caution.html#objects-that-contain-functions-may-trigger-unwanted-builds"><i class="fa fa-check"></i><b>13.4.1</b> Objects that contain functions may trigger unwanted builds</a></li>
<li class="chapter" data-level="13.4.2" data-path="caution.html"><a href="caution.html#the-magrittr-dot-.-is-always-ignored."><i class="fa fa-check"></i><b>13.4.2</b> The <code>magrittr</code> dot (<code>.</code>) is always ignored.</a></li>
<li class="chapter" data-level="13.4.3" data-path="caution.html"><a href="caution.html#triggers-and-skipped-imports"><i class="fa fa-check"></i><b>13.4.3</b> Triggers and skipped imports</a></li>
<li class="chapter" data-level="13.4.4" data-path="caution.html"><a href="caution.html#dependencies-are-not-tracked-in-some-edge-cases."><i class="fa fa-check"></i><b>13.4.4</b> Dependencies are not tracked in some edge cases.</a></li>
<li class="chapter" data-level="13.4.5" data-path="caution.html"><a href="caution.html#dependencies-of-knitr-reports"><i class="fa fa-check"></i><b>13.4.5</b> Dependencies of <code>knitr</code> reports</a></li>
<li class="chapter" data-level="13.4.6" data-path="caution.html"><a href="caution.html#knitr-inputs-and-file-outputs-in-imported-functions."><i class="fa fa-check"></i><b>13.4.6</b> Knitr inputs and file outputs in imported functions.</a></li>
<li class="chapter" data-level="13.4.7" data-path="caution.html"><a href="caution.html#functions-produced-by-vectorize"><i class="fa fa-check"></i><b>13.4.7</b> Functions produced by <code>Vectorize()</code></a></li>
<li class="chapter" data-level="13.4.8" data-path="caution.html"><a href="caution.html#compiled-code-is-not-reproducibly-tracked."><i class="fa fa-check"></i><b>13.4.8</b> Compiled code is not reproducibly tracked.</a></li>
<li class="chapter" data-level="13.4.9" data-path="caution.html"><a href="caution.html#directories-folders-are-not-reproducibly-tracked."><i class="fa fa-check"></i><b>13.4.9</b> Directories (folders) are not reproducibly tracked.</a></li>
<li class="chapter" data-level="13.4.10" data-path="caution.html"><a href="caution.html#packages-are-not-tracked-as-dependencies."><i class="fa fa-check"></i><b>13.4.10</b> Packages are not tracked as dependencies.</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="caution.html"><a href="caution.html#high-performance-computing"><i class="fa fa-check"></i><b>13.5</b> High-performance computing</a><ul>
<li class="chapter" data-level="13.5.1" data-path="caution.html"><a href="caution.html#the-practical-utility-of-parallel-computing"><i class="fa fa-check"></i><b>13.5.1</b> The practical utility of parallel computing</a></li>
<li class="chapter" data-level="13.5.2" data-path="caution.html"><a href="caution.html#maximum-number-of-simultaneous-jobs"><i class="fa fa-check"></i><b>13.5.2</b> Maximum number of simultaneous jobs</a></li>
<li class="chapter" data-level="13.5.3" data-path="caution.html"><a href="caution.html#parallel-computing-on-windows"><i class="fa fa-check"></i><b>13.5.3</b> Parallel computing on Windows</a></li>
<li class="chapter" data-level="13.5.4" data-path="caution.html"><a href="caution.html#configuring-futurebatchtools-parallelism-for-clusters"><i class="fa fa-check"></i><b>13.5.4</b> Configuring <a href="https://github.com/HenrikBengtsson/future">future</a>/<a href="https://github.com/mllg/batchtools">batchtools</a> parallelism for clusters</a></li>
<li class="chapter" data-level="13.5.5" data-path="caution.html"><a href="caution.html#proper-makefiles-are-not-standalone."><i class="fa fa-check"></i><b>13.5.5</b> Proper Makefiles are not standalone.</a></li>
<li class="chapter" data-level="13.5.6" data-path="caution.html"><a href="caution.html#makefile-level-parallelism-for-imported-objects-and-files"><i class="fa fa-check"></i><b>13.5.6</b> Makefile-level parallelism for imported objects and files</a></li>
<li class="chapter" data-level="13.5.7" data-path="caution.html"><a href="caution.html#zombie-processes"><i class="fa fa-check"></i><b>13.5.7</b> Zombie processes</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="caution.html"><a href="caution.html#storage"><i class="fa fa-check"></i><b>13.6</b> Storage</a><ul>
<li class="chapter" data-level="13.6.1" data-path="caution.html"><a href="caution.html#projects-hosted-on-dropbox-and-similar-platforms"><i class="fa fa-check"></i><b>13.6.1</b> Projects hosted on Dropbox and similar platforms</a></li>
<li class="chapter" data-level="13.6.2" data-path="caution.html"><a href="caution.html#cache-customization-is-limited"><i class="fa fa-check"></i><b>13.6.2</b> Cache customization is limited</a></li>
<li class="chapter" data-level="13.6.3" data-path="caution.html"><a href="caution.html#runtime-predictions"><i class="fa fa-check"></i><b>13.6.3</b> Runtime predictions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>14</b> Frequently-asked questions</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The User Manual of the drake R Package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="store" class="section level1">
<h1><span class="header-section-number">Chapter 12</span> Storage</h1>
<p><code>Drake</code>’s <code>make()</code> function generates your project’s output, and <code>drake</code> takes storing this output seriously. This guide explains how <code>drake</code> caches and hashes its data, and describes customization options that can increase convenience and speed.</p>
<div id="caches" class="section level2">
<h2><span class="header-section-number">12.1</span> Caches</h2>
<p>When you run <code>make()</code>, <code>drake</code> stores your imports and targets in a hidden cache.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" data-line-number="1"><span class="kw">library</span>(drake)</a>
<a class="sourceLine" id="cb212-2" data-line-number="2"><span class="kw">load_mtcars_example</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) <span class="co"># Get the code with drake_example(&quot;mtcars&quot;).</span></a>
<a class="sourceLine" id="cb212-3" data-line-number="3">## Error in load_mtcars_example(verbose = FALSE): unused argument (verbose = FALSE)</a>
<a class="sourceLine" id="cb212-4" data-line-number="4">config &lt;-<span class="st"> </span><span class="kw">make</span>(my_plan)</a>
<a class="sourceLine" id="cb212-5" data-line-number="5">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb212-6" data-line-number="6">## inspected for dependencies.</a>
<a class="sourceLine" id="cb212-7" data-line-number="7"></a>
<a class="sourceLine" id="cb212-8" data-line-number="8">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb212-9" data-line-number="9">## inspected for dependencies.</a>
<a class="sourceLine" id="cb212-10" data-line-number="10"></a>
<a class="sourceLine" id="cb212-11" data-line-number="11">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb212-12" data-line-number="12">## inspected for dependencies.</a>
<a class="sourceLine" id="cb212-13" data-line-number="13"></a>
<a class="sourceLine" id="cb212-14" data-line-number="14">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb212-15" data-line-number="15">## inspected for dependencies.</a>
<a class="sourceLine" id="cb212-16" data-line-number="16"></a>
<a class="sourceLine" id="cb212-17" data-line-number="17">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb212-18" data-line-number="18">## inspected for dependencies.</a>
<a class="sourceLine" id="cb212-19" data-line-number="19">## Warning: missing input files:</a>
<a class="sourceLine" id="cb212-20" data-line-number="20">##   report.Rmd</a>
<a class="sourceLine" id="cb212-21" data-line-number="21">## Warning: File &quot;report.Rmd&quot; was built or processed,</a>
<a class="sourceLine" id="cb212-22" data-line-number="22">## but the file itself does not exist.</a>
<a class="sourceLine" id="cb212-23" data-line-number="23">## target file &quot;report.md&quot;</a>
<a class="sourceLine" id="cb212-24" data-line-number="24">## Warning in readLines(if (is.character(input2)) {: cannot open file</a>
<a class="sourceLine" id="cb212-25" data-line-number="25">## &#39;report.Rmd&#39;: No such file or directory</a>
<a class="sourceLine" id="cb212-26" data-line-number="26">## Warning: File &quot;report.md&quot; was built or processed,</a>
<a class="sourceLine" id="cb212-27" data-line-number="27">## but the file itself does not exist.</a>
<a class="sourceLine" id="cb212-28" data-line-number="28">## Warning: target &quot;report.md&quot; warnings:</a>
<a class="sourceLine" id="cb212-29" data-line-number="29">##   cannot open file &#39;report.Rmd&#39;: No such file or directory</a>
<a class="sourceLine" id="cb212-30" data-line-number="30">## fail &quot;report.md&quot;</a>
<a class="sourceLine" id="cb212-31" data-line-number="31">## Error: Target `&quot;report.md&quot;` failed. Call `diagnose(&quot;report.md&quot;)` for details. Error message:</a>
<a class="sourceLine" id="cb212-32" data-line-number="32">##   cannot open the connection</a></code></pre></div>
<p>You can explore your cached data using functions <code>loadd()</code>, <code>readd()</code>, <code>cached()</code>, and others.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" data-line-number="1"><span class="kw">head</span>(<span class="kw">cached</span>())</a>
<a class="sourceLine" id="cb213-2" data-line-number="2">## [1] &quot;\&quot;report.Rmd\&quot;&quot; &quot;data.frame&quot;     &quot;knit&quot;           &quot;lm&quot;            </a>
<a class="sourceLine" id="cb213-3" data-line-number="3">## [5] &quot;mtcars&quot;         &quot;nrow&quot;</a>
<a class="sourceLine" id="cb213-4" data-line-number="4"></a>
<a class="sourceLine" id="cb213-5" data-line-number="5"><span class="kw">head</span>(<span class="kw">readd</span>(small))</a>
<a class="sourceLine" id="cb213-6" data-line-number="6">## Error: key &#39;small&#39; (&#39;objects&#39;) not found</a>
<a class="sourceLine" id="cb213-7" data-line-number="7"></a>
<a class="sourceLine" id="cb213-8" data-line-number="8"><span class="kw">loadd</span>(large)</a>
<a class="sourceLine" id="cb213-9" data-line-number="9"></a>
<a class="sourceLine" id="cb213-10" data-line-number="10"><span class="kw">head</span>(large)</a>
<a class="sourceLine" id="cb213-11" data-line-number="11">## Error in head(large): object &#39;large&#39; not found</a>
<a class="sourceLine" id="cb213-12" data-line-number="12"></a>
<a class="sourceLine" id="cb213-13" data-line-number="13"><span class="kw">rm</span>(large) <span class="co"># Does not remove `large` from the cache.</span></a>
<a class="sourceLine" id="cb213-14" data-line-number="14">## Warning in rm(large): object &#39;large&#39; not found</a></code></pre></div>
<p>By default, these objects live in a hidden <code>.drake</code> folder in your working directory.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" data-line-number="1"><span class="kw">find_cache</span>()</a>
<a class="sourceLine" id="cb214-2" data-line-number="2">### [1] &quot;/home/you/project/.drake&quot;</a>
<a class="sourceLine" id="cb214-3" data-line-number="3"></a>
<a class="sourceLine" id="cb214-4" data-line-number="4"><span class="kw">find_project</span>()</a>
<a class="sourceLine" id="cb214-5" data-line-number="5">### [1] &quot;/home/you/project&quot;</a></code></pre></div>
<p><code>Drake</code> (via <a href="https://github.com/richfitz/storr">storr</a>) has an object-like interface to these caches.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" data-line-number="1">cache &lt;-<span class="st"> </span><span class="kw">get_cache</span>()</a>
<a class="sourceLine" id="cb215-2" data-line-number="2"></a>
<a class="sourceLine" id="cb215-3" data-line-number="3">cache<span class="op">$</span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb215-4" data-line-number="4">##  [1] &quot;\&quot;report.Rmd\&quot;&quot;   &quot;data.frame&quot;       &quot;knit&quot;            </a>
<a class="sourceLine" id="cb215-5" data-line-number="5">##  [4] &quot;lm&quot;               &quot;mtcars&quot;           &quot;nrow&quot;            </a>
<a class="sourceLine" id="cb215-6" data-line-number="6">##  [7] &quot;random_rows&quot;      &quot;reg1&quot;             &quot;reg2&quot;            </a>
<a class="sourceLine" id="cb215-7" data-line-number="7">## [10] &quot;sample.int&quot;       &quot;summary&quot;          &quot;suppressWarnings&quot;</a>
<a class="sourceLine" id="cb215-8" data-line-number="8"></a>
<a class="sourceLine" id="cb215-9" data-line-number="9"><span class="kw">head</span>(cache<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;small&quot;</span>))</a>
<a class="sourceLine" id="cb215-10" data-line-number="10">## Error: key &#39;small&#39; (&#39;objects&#39;) not found</a>
<a class="sourceLine" id="cb215-11" data-line-number="11"></a>
<a class="sourceLine" id="cb215-12" data-line-number="12"><span class="kw">tail</span>(cache<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;small&quot;</span>, <span class="dt">namespace =</span> <span class="st">&quot;meta&quot;</span>))</a>
<a class="sourceLine" id="cb215-13" data-line-number="13">## Error: key &#39;small&#39; (&#39;meta&#39;) not found</a>
<a class="sourceLine" id="cb215-14" data-line-number="14"></a>
<a class="sourceLine" id="cb215-15" data-line-number="15">cache<span class="op">$</span><span class="kw">list_namespaces</span>()</a>
<a class="sourceLine" id="cb215-16" data-line-number="16">## [1] &quot;common&quot;   &quot;config&quot;   &quot;kernels&quot;  &quot;meta&quot;     &quot;objects&quot;  &quot;progress&quot;</a>
<a class="sourceLine" id="cb215-17" data-line-number="17">## [7] &quot;session&quot;</a></code></pre></div>
<p>Create a new cache of your own with <code>new_cache()</code>.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" data-line-number="1">cache2 &lt;-<span class="st"> </span><span class="kw">new_cache</span>(<span class="dt">path =</span> <span class="st">&quot;cache2&quot;</span>)</a>
<a class="sourceLine" id="cb216-2" data-line-number="2"><span class="kw">file.exists</span>(<span class="st">&quot;cache2&quot;</span>)</a>
<a class="sourceLine" id="cb216-3" data-line-number="3">## [1] TRUE</a></code></pre></div>
<p>You can use multiple caches simultaneously, default and non-default alike.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" data-line-number="1">config  &lt;-<span class="st"> </span><span class="kw">drake_config</span>(<span class="dt">cache =</span> cache)</a>
<a class="sourceLine" id="cb217-2" data-line-number="2">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-3" data-line-number="3">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-4" data-line-number="4"></a>
<a class="sourceLine" id="cb217-5" data-line-number="5">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-6" data-line-number="6">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-7" data-line-number="7"></a>
<a class="sourceLine" id="cb217-8" data-line-number="8">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-9" data-line-number="9">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-10" data-line-number="10"></a>
<a class="sourceLine" id="cb217-11" data-line-number="11">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-12" data-line-number="12">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-13" data-line-number="13"></a>
<a class="sourceLine" id="cb217-14" data-line-number="14">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-15" data-line-number="15">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-16" data-line-number="16">config2 &lt;-<span class="st"> </span><span class="kw">drake_config</span>(<span class="dt">cache =</span> cache2)</a>
<a class="sourceLine" id="cb217-17" data-line-number="17">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-18" data-line-number="18">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-19" data-line-number="19"></a>
<a class="sourceLine" id="cb217-20" data-line-number="20">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-21" data-line-number="21">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-22" data-line-number="22"></a>
<a class="sourceLine" id="cb217-23" data-line-number="23">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-24" data-line-number="24">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-25" data-line-number="25"></a>
<a class="sourceLine" id="cb217-26" data-line-number="26">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-27" data-line-number="27">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-28" data-line-number="28"></a>
<a class="sourceLine" id="cb217-29" data-line-number="29">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-30" data-line-number="30">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-31" data-line-number="31"><span class="kw">outdated</span>(config)</a>
<a class="sourceLine" id="cb217-32" data-line-number="32">## Warning: File &quot;report.Rmd&quot; was built or processed,</a>
<a class="sourceLine" id="cb217-33" data-line-number="33">## but the file itself does not exist.</a>
<a class="sourceLine" id="cb217-34" data-line-number="34">##  [1] &quot;\&quot;report.md\&quot;&quot;          &quot;coef_regression1_large&quot;</a>
<a class="sourceLine" id="cb217-35" data-line-number="35">##  [3] &quot;coef_regression1_small&quot; &quot;coef_regression2_large&quot;</a>
<a class="sourceLine" id="cb217-36" data-line-number="36">##  [5] &quot;coef_regression2_small&quot; &quot;large&quot;                 </a>
<a class="sourceLine" id="cb217-37" data-line-number="37">##  [7] &quot;regression1_large&quot;      &quot;regression1_small&quot;     </a>
<a class="sourceLine" id="cb217-38" data-line-number="38">##  [9] &quot;regression2_large&quot;      &quot;regression2_small&quot;     </a>
<a class="sourceLine" id="cb217-39" data-line-number="39">## [11] &quot;small&quot;                  &quot;summ_regression1_large&quot;</a>
<a class="sourceLine" id="cb217-40" data-line-number="40">## [13] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;</a>
<a class="sourceLine" id="cb217-41" data-line-number="41">## [15] &quot;summ_regression2_small&quot;</a>
<a class="sourceLine" id="cb217-42" data-line-number="42"><span class="kw">outdated</span>(config2)</a>
<a class="sourceLine" id="cb217-43" data-line-number="43">## Warning: File &quot;report.Rmd&quot; was built or processed,</a>
<a class="sourceLine" id="cb217-44" data-line-number="44">## but the file itself does not exist.</a>
<a class="sourceLine" id="cb217-45" data-line-number="45">##  [1] &quot;\&quot;report.md\&quot;&quot;          &quot;coef_regression1_large&quot;</a>
<a class="sourceLine" id="cb217-46" data-line-number="46">##  [3] &quot;coef_regression1_small&quot; &quot;coef_regression2_large&quot;</a>
<a class="sourceLine" id="cb217-47" data-line-number="47">##  [5] &quot;coef_regression2_small&quot; &quot;large&quot;                 </a>
<a class="sourceLine" id="cb217-48" data-line-number="48">##  [7] &quot;regression1_large&quot;      &quot;regression1_small&quot;     </a>
<a class="sourceLine" id="cb217-49" data-line-number="49">##  [9] &quot;regression2_large&quot;      &quot;regression2_small&quot;     </a>
<a class="sourceLine" id="cb217-50" data-line-number="50">## [11] &quot;small&quot;                  &quot;summ_regression1_large&quot;</a>
<a class="sourceLine" id="cb217-51" data-line-number="51">## [13] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;</a>
<a class="sourceLine" id="cb217-52" data-line-number="52">## [15] &quot;summ_regression2_small&quot;</a>
<a class="sourceLine" id="cb217-53" data-line-number="53"><span class="kw">make</span>(my_plan, <span class="dt">cache =</span> cache)</a>
<a class="sourceLine" id="cb217-54" data-line-number="54">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-55" data-line-number="55">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-56" data-line-number="56"></a>
<a class="sourceLine" id="cb217-57" data-line-number="57">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-58" data-line-number="58">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-59" data-line-number="59"></a>
<a class="sourceLine" id="cb217-60" data-line-number="60">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-61" data-line-number="61">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-62" data-line-number="62"></a>
<a class="sourceLine" id="cb217-63" data-line-number="63">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-64" data-line-number="64">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-65" data-line-number="65"></a>
<a class="sourceLine" id="cb217-66" data-line-number="66">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-67" data-line-number="67">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-68" data-line-number="68">## Warning: missing input files:</a>
<a class="sourceLine" id="cb217-69" data-line-number="69">##   report.Rmd</a>
<a class="sourceLine" id="cb217-70" data-line-number="70">## Warning: File &quot;report.Rmd&quot; was built or processed,</a>
<a class="sourceLine" id="cb217-71" data-line-number="71">## but the file itself does not exist.</a>
<a class="sourceLine" id="cb217-72" data-line-number="72">## target file &quot;report.md&quot;</a>
<a class="sourceLine" id="cb217-73" data-line-number="73">## Warning in readLines(if (is.character(input2)) {: cannot open file</a>
<a class="sourceLine" id="cb217-74" data-line-number="74">## &#39;report.Rmd&#39;: No such file or directory</a>
<a class="sourceLine" id="cb217-75" data-line-number="75">## Warning: File &quot;report.md&quot; was built or processed,</a>
<a class="sourceLine" id="cb217-76" data-line-number="76">## but the file itself does not exist.</a>
<a class="sourceLine" id="cb217-77" data-line-number="77">## Warning: target &quot;report.md&quot; warnings:</a>
<a class="sourceLine" id="cb217-78" data-line-number="78">##   cannot open file &#39;report.Rmd&#39;: No such file or directory</a>
<a class="sourceLine" id="cb217-79" data-line-number="79">## fail &quot;report.md&quot;</a>
<a class="sourceLine" id="cb217-80" data-line-number="80">## Error: Target `&quot;report.md&quot;` failed. Call `diagnose(&quot;report.md&quot;)` for details. Error message:</a>
<a class="sourceLine" id="cb217-81" data-line-number="81">##   cannot open the connection</a>
<a class="sourceLine" id="cb217-82" data-line-number="82"><span class="kw">make</span>(my_plan, <span class="dt">cache =</span> cache2)</a>
<a class="sourceLine" id="cb217-83" data-line-number="83">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-84" data-line-number="84">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-85" data-line-number="85">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-86" data-line-number="86">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-87" data-line-number="87"></a>
<a class="sourceLine" id="cb217-88" data-line-number="88">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-89" data-line-number="89">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-90" data-line-number="90"></a>
<a class="sourceLine" id="cb217-91" data-line-number="91">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-92" data-line-number="92">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-93" data-line-number="93"></a>
<a class="sourceLine" id="cb217-94" data-line-number="94">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb217-95" data-line-number="95">## inspected for dependencies.</a>
<a class="sourceLine" id="cb217-96" data-line-number="96">## Warning: missing input files:</a>
<a class="sourceLine" id="cb217-97" data-line-number="97">##   report.Rmd</a>
<a class="sourceLine" id="cb217-98" data-line-number="98">## Warning: File &quot;report.Rmd&quot; was built or processed,</a>
<a class="sourceLine" id="cb217-99" data-line-number="99">## but the file itself does not exist.</a>
<a class="sourceLine" id="cb217-100" data-line-number="100">## target file &quot;report.md&quot;</a>
<a class="sourceLine" id="cb217-101" data-line-number="101">## Warning in readLines(if (is.character(input2)) {: cannot open file</a>
<a class="sourceLine" id="cb217-102" data-line-number="102">## &#39;report.Rmd&#39;: No such file or directory</a>
<a class="sourceLine" id="cb217-103" data-line-number="103">## Warning: File &quot;report.md&quot; was built or processed,</a>
<a class="sourceLine" id="cb217-104" data-line-number="104">## but the file itself does not exist.</a>
<a class="sourceLine" id="cb217-105" data-line-number="105">## Warning: target &quot;report.md&quot; warnings:</a>
<a class="sourceLine" id="cb217-106" data-line-number="106">##   cannot open file &#39;report.Rmd&#39;: No such file or directory</a>
<a class="sourceLine" id="cb217-107" data-line-number="107">## fail &quot;report.md&quot;</a>
<a class="sourceLine" id="cb217-108" data-line-number="108">## Error: Target `&quot;report.md&quot;` failed. Call `diagnose(&quot;report.md&quot;)` for details. Error message:</a>
<a class="sourceLine" id="cb217-109" data-line-number="109">##   cannot open the connection</a></code></pre></div>
<p>There are a couple different ways to retrieve caches.</p>
<ul>
<li><code>get_cache(path = &quot;my_path&quot;)</code> assumes <code>my_path</code> is a project root containing a <code>.drake</code> folder. If it does not find a <code>.drake</code> folder in <code>my_path</code>, it searches up through the ancestors of <code>my_path</code> until it finds one.</li>
<li><code>this_cache(path = &quot;my_path&quot;)</code> literally assumes <code>my_path</code> is the path to the cache, <code>.drake</code> folder or not.</li>
<li><code>storr::storr_rds(&quot;my_path&quot;, mangle_key = TRUE)</code> is analogous to <code>this_cache(path = &quot;my_path&quot;)</code>.</li>
</ul>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" data-line-number="1">cache3 &lt;-<span class="st"> </span><span class="kw">get_cache</span>(<span class="dt">path =</span> <span class="kw">getwd</span>()) <span class="co"># Finds the .drake folder in your directory.</span></a>
<a class="sourceLine" id="cb218-2" data-line-number="2"><span class="kw">head</span>(cache3<span class="op">$</span><span class="kw">list</span>())</a>
<a class="sourceLine" id="cb218-3" data-line-number="3">## [1] &quot;\&quot;report.Rmd\&quot;&quot; &quot;data.frame&quot;     &quot;knit&quot;           &quot;lm&quot;            </a>
<a class="sourceLine" id="cb218-4" data-line-number="4">## [5] &quot;mtcars&quot;         &quot;nrow&quot;</a>
<a class="sourceLine" id="cb218-5" data-line-number="5">cache4 &lt;-<span class="st"> </span><span class="kw">this_cache</span>(<span class="dt">path =</span> <span class="st">&quot;cache2&quot;</span>) <span class="co"># The cache folder is literally called cache2.</span></a>
<a class="sourceLine" id="cb218-6" data-line-number="6"><span class="kw">head</span>(cache4<span class="op">$</span><span class="kw">list</span>())</a>
<a class="sourceLine" id="cb218-7" data-line-number="7">## [1] &quot;\&quot;report.Rmd\&quot;&quot; &quot;data.frame&quot;     &quot;knit&quot;           &quot;lm&quot;            </a>
<a class="sourceLine" id="cb218-8" data-line-number="8">## [5] &quot;mtcars&quot;         &quot;nrow&quot;</a></code></pre></div>
<p>Destroy caches to remove them from your file system.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" data-line-number="1">cache4<span class="op">$</span><span class="kw">destroy</span>()</a>
<a class="sourceLine" id="cb219-2" data-line-number="2">cache2<span class="op">$</span><span class="kw">list</span>() <span class="co"># Same folder as cache4.</span></a>
<a class="sourceLine" id="cb219-3" data-line-number="3">## character(0)</a></code></pre></div>
<p>See <a href="https://github.com/richfitz/storr">storr</a> for more on <code>drake</code>’s caching infrastructure.</p>
</div>
<div id="hash-algorithms" class="section level2">
<h2><span class="header-section-number">12.2</span> Hash algorithms</h2>
<p>The concept of <a href="https://en.wikipedia.org/wiki/Hash_function">hashing</a> is central to <a href="https://github.com/richfitz/storr">storr</a>’s internals. <a href="https://github.com/richfitz/storr">Storr</a> uses hashes to label stored objects, and <code>drake</code> leverages these hashes to figure out which targets are up to date and which ones are outdated. A hash is like a target’s fingerprint, so the hash changes when the target changes. Regardless of the target’s size, the hash is always the same number of characters.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb220-1" data-line-number="1"><span class="kw">library</span>(digest) <span class="co"># package for hashing objects and files</span></a>
<a class="sourceLine" id="cb220-2" data-line-number="2">smaller_data &lt;-<span class="st"> </span><span class="dv">12</span></a>
<a class="sourceLine" id="cb220-3" data-line-number="3">larger_data &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb220-4" data-line-number="4"></a>
<a class="sourceLine" id="cb220-5" data-line-number="5"><span class="kw">digest</span>(smaller_data) <span class="co"># compute the hash</span></a>
<a class="sourceLine" id="cb220-6" data-line-number="6">## [1] &quot;23c80a31c0713176016e6e18d76a5f31&quot;</a>
<a class="sourceLine" id="cb220-7" data-line-number="7"></a>
<a class="sourceLine" id="cb220-8" data-line-number="8"><span class="kw">digest</span>(larger_data)</a>
<a class="sourceLine" id="cb220-9" data-line-number="9">## [1] &quot;cb54a6632ac538fa46c25412e70dfa23&quot;</a></code></pre></div>
<p>However, different hash algorithms vary in length.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" data-line-number="1"><span class="kw">digest</span>(larger_data, <span class="dt">algo =</span> <span class="st">&quot;sha512&quot;</span>)</a>
<a class="sourceLine" id="cb221-2" data-line-number="2">## [1] &quot;390ba2d7a380c1dabfbbff95d4de4a236c174b0b061332325af6f7e2ac8835c87d03c76412db7d7cb0986cfa92fedfc7cf5d5f9a3cb0a526596960e0a3c9aa63&quot;</a>
<a class="sourceLine" id="cb221-3" data-line-number="3"></a>
<a class="sourceLine" id="cb221-4" data-line-number="4"><span class="kw">digest</span>(larger_data, <span class="dt">algo =</span> <span class="st">&quot;md5&quot;</span>)</a>
<a class="sourceLine" id="cb221-5" data-line-number="5">## [1] &quot;cb54a6632ac538fa46c25412e70dfa23&quot;</a>
<a class="sourceLine" id="cb221-6" data-line-number="6"></a>
<a class="sourceLine" id="cb221-7" data-line-number="7"><span class="kw">digest</span>(larger_data, <span class="dt">algo =</span> <span class="st">&quot;xxhash64&quot;</span>)</a>
<a class="sourceLine" id="cb221-8" data-line-number="8">## [1] &quot;81920a97e7c39893&quot;</a>
<a class="sourceLine" id="cb221-9" data-line-number="9"></a>
<a class="sourceLine" id="cb221-10" data-line-number="10"><span class="kw">digest</span>(larger_data, <span class="dt">algo =</span> <span class="st">&quot;murmur32&quot;</span>)</a>
<a class="sourceLine" id="cb221-11" data-line-number="11">## [1] &quot;d5201830&quot;</a></code></pre></div>
</div>
<div id="which-hash-algorithm-should-you-choose" class="section level2">
<h2><span class="header-section-number">12.3</span> Which hash algorithm should you choose?</h2>
<p>Hashing is expensive, and unsurprisingly, shorter hashes are usually faster to compute. So why not always use <code>murmur32</code>? One reason is the risk of collisions: that is, when two different objects have the same hash. In general, shorter hashes have more frequent collisions. On the other hand, a longer hash is not always the answer. Besides the loss of speed, <code>drake</code> and <a href="https://github.com/richfitz/storr">storr</a> sometimes use hash keys as file names, and long hashes could violate the 260-character cap on Windows file paths. That is why <code>drake</code> uses a shorter hash algorithm for internal cache-related file names and a longer hash algorithm for everything else.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb222-1" data-line-number="1"><span class="kw">default_short_hash_algo</span>()</a>
<a class="sourceLine" id="cb222-2" data-line-number="2">## [1] &quot;xxhash64&quot;</a>
<a class="sourceLine" id="cb222-3" data-line-number="3"></a>
<a class="sourceLine" id="cb222-4" data-line-number="4"><span class="kw">default_long_hash_algo</span>()</a>
<a class="sourceLine" id="cb222-5" data-line-number="5">## [1] &quot;sha256&quot;</a>
<a class="sourceLine" id="cb222-6" data-line-number="6"></a>
<a class="sourceLine" id="cb222-7" data-line-number="7"><span class="kw">short_hash</span>(cache)</a>
<a class="sourceLine" id="cb222-8" data-line-number="8">## [1] &quot;xxhash64&quot;</a>
<a class="sourceLine" id="cb222-9" data-line-number="9"></a>
<a class="sourceLine" id="cb222-10" data-line-number="10"><span class="kw">long_hash</span>(cache)</a>
<a class="sourceLine" id="cb222-11" data-line-number="11">## [1] &quot;sha256&quot;</a></code></pre></div>
</div>
<div id="select-the-hash-algorithms-of-the-cache" class="section level2">
<h2><span class="header-section-number">12.4</span> Select the hash algorithms of the cache</h2>
<p>If you want to set the hash algorithms, do so right when the cache is first created.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" data-line-number="1">## cache_path(cache) # Default cache from before. # nolint</a>
<a class="sourceLine" id="cb223-2" data-line-number="2"></a>
<a class="sourceLine" id="cb223-3" data-line-number="3">## Start from scratch to reset both hash algorithms.</a>
<a class="sourceLine" id="cb223-4" data-line-number="4"><span class="kw">clean</span>(<span class="dt">destroy =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb223-5" data-line-number="5"></a>
<a class="sourceLine" id="cb223-6" data-line-number="6">tmp &lt;-<span class="st"> </span><span class="kw">new_cache</span>(</a>
<a class="sourceLine" id="cb223-7" data-line-number="7">  <span class="dt">path =</span> <span class="kw">default_cache_path</span>(), <span class="co"># The `.drake/` folder.</span></a>
<a class="sourceLine" id="cb223-8" data-line-number="8">  <span class="dt">short_hash_algo =</span> <span class="st">&quot;crc32&quot;</span>,</a>
<a class="sourceLine" id="cb223-9" data-line-number="9">  <span class="dt">long_hash_algo =</span> <span class="st">&quot;sha1&quot;</span></a>
<a class="sourceLine" id="cb223-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb223-11" data-line-number="11"></a>
<a class="sourceLine" id="cb223-12" data-line-number="12">config &lt;-<span class="st"> </span><span class="kw">make</span>(my_plan, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb223-13" data-line-number="13">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb223-14" data-line-number="14">## inspected for dependencies.</a>
<a class="sourceLine" id="cb223-15" data-line-number="15"></a>
<a class="sourceLine" id="cb223-16" data-line-number="16">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb223-17" data-line-number="17">## inspected for dependencies.</a>
<a class="sourceLine" id="cb223-18" data-line-number="18"></a>
<a class="sourceLine" id="cb223-19" data-line-number="19">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb223-20" data-line-number="20">## inspected for dependencies.</a>
<a class="sourceLine" id="cb223-21" data-line-number="21"></a>
<a class="sourceLine" id="cb223-22" data-line-number="22">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb223-23" data-line-number="23">## inspected for dependencies.</a>
<a class="sourceLine" id="cb223-24" data-line-number="24"></a>
<a class="sourceLine" id="cb223-25" data-line-number="25">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb223-26" data-line-number="26">## inspected for dependencies.</a>
<a class="sourceLine" id="cb223-27" data-line-number="27">## Warning: missing input files:</a>
<a class="sourceLine" id="cb223-28" data-line-number="28">##   report.Rmd</a>
<a class="sourceLine" id="cb223-29" data-line-number="29">## Warning: File &quot;report.Rmd&quot; was built or processed,</a>
<a class="sourceLine" id="cb223-30" data-line-number="30">## but the file itself does not exist.</a>
<a class="sourceLine" id="cb223-31" data-line-number="31">## Warning in readLines(if (is.character(input2)) {: cannot open file</a>
<a class="sourceLine" id="cb223-32" data-line-number="32">## &#39;report.Rmd&#39;: No such file or directory</a>
<a class="sourceLine" id="cb223-33" data-line-number="33">## Warning: File &quot;report.md&quot; was built or processed,</a>
<a class="sourceLine" id="cb223-34" data-line-number="34">## but the file itself does not exist.</a>
<a class="sourceLine" id="cb223-35" data-line-number="35">## Error: Target `&quot;report.md&quot;` failed. Call `diagnose(&quot;report.md&quot;)` for details. Error message:</a>
<a class="sourceLine" id="cb223-36" data-line-number="36">##   cannot open the connection</a>
<a class="sourceLine" id="cb223-37" data-line-number="37"></a>
<a class="sourceLine" id="cb223-38" data-line-number="38"><span class="kw">short_hash</span>(config<span class="op">$</span>cache) <span class="co"># xxhash64 is the default_short_hash_algo()</span></a>
<a class="sourceLine" id="cb223-39" data-line-number="39">## Warning: The storr-based cache actually uses xxhash64 for the short hash</a>
<a class="sourceLine" id="cb223-40" data-line-number="40">## algorithm, but crc32 was also supplied. Reverting to xxhash64.</a>
<a class="sourceLine" id="cb223-41" data-line-number="41">## [1] &quot;xxhash64&quot;</a>
<a class="sourceLine" id="cb223-42" data-line-number="42"></a>
<a class="sourceLine" id="cb223-43" data-line-number="43"><span class="kw">long_hash</span>(config<span class="op">$</span>cache) <span class="co"># sha256 is the default_long_hash_algo()</span></a>
<a class="sourceLine" id="cb223-44" data-line-number="44">## [1] &quot;sha1&quot;</a></code></pre></div>
<p>You can change the long hash algorithm without throwing away the cache, but your project will rebuild from scratch. As for the short hash, you are committed until you delete the cache and all its supporting files.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" data-line-number="1"><span class="kw">outdated</span>(config) <span class="co"># empty</span></a>
<a class="sourceLine" id="cb224-2" data-line-number="2">## Warning: File &quot;report.Rmd&quot; was built or processed,</a>
<a class="sourceLine" id="cb224-3" data-line-number="3">## but the file itself does not exist.</a>
<a class="sourceLine" id="cb224-4" data-line-number="4">##  [1] &quot;\&quot;report.md\&quot;&quot;          &quot;coef_regression1_large&quot;</a>
<a class="sourceLine" id="cb224-5" data-line-number="5">##  [3] &quot;coef_regression1_small&quot; &quot;coef_regression2_large&quot;</a>
<a class="sourceLine" id="cb224-6" data-line-number="6">##  [5] &quot;coef_regression2_small&quot; &quot;large&quot;                 </a>
<a class="sourceLine" id="cb224-7" data-line-number="7">##  [7] &quot;regression1_large&quot;      &quot;regression1_small&quot;     </a>
<a class="sourceLine" id="cb224-8" data-line-number="8">##  [9] &quot;regression2_large&quot;      &quot;regression2_small&quot;     </a>
<a class="sourceLine" id="cb224-9" data-line-number="9">## [11] &quot;small&quot;                  &quot;summ_regression1_large&quot;</a>
<a class="sourceLine" id="cb224-10" data-line-number="10">## [13] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;</a>
<a class="sourceLine" id="cb224-11" data-line-number="11">## [15] &quot;summ_regression2_small&quot;</a>
<a class="sourceLine" id="cb224-12" data-line-number="12"></a>
<a class="sourceLine" id="cb224-13" data-line-number="13">config<span class="op">$</span>cache &lt;-<span class="st"> </span><span class="kw">configure_cache</span>(</a>
<a class="sourceLine" id="cb224-14" data-line-number="14">  config<span class="op">$</span>cache,</a>
<a class="sourceLine" id="cb224-15" data-line-number="15">  <span class="dt">long_hash_algo =</span> <span class="st">&quot;murmur32&quot;</span>,</a>
<a class="sourceLine" id="cb224-16" data-line-number="16">  <span class="dt">overwrite_hash_algos =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb224-17" data-line-number="17">)</a></code></pre></div>
<p>Below, the targets become outdated because the existing hash keys do not match the new hash algorithm.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" data-line-number="1">config &lt;-<span class="st"> </span><span class="kw">drake_config</span>(my_plan, <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">cache =</span> config<span class="op">$</span>cache)</a>
<a class="sourceLine" id="cb225-2" data-line-number="2">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb225-3" data-line-number="3">## inspected for dependencies.</a>
<a class="sourceLine" id="cb225-4" data-line-number="4"></a>
<a class="sourceLine" id="cb225-5" data-line-number="5">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb225-6" data-line-number="6">## inspected for dependencies.</a>
<a class="sourceLine" id="cb225-7" data-line-number="7"></a>
<a class="sourceLine" id="cb225-8" data-line-number="8">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb225-9" data-line-number="9">## inspected for dependencies.</a>
<a class="sourceLine" id="cb225-10" data-line-number="10"></a>
<a class="sourceLine" id="cb225-11" data-line-number="11">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb225-12" data-line-number="12">## inspected for dependencies.</a>
<a class="sourceLine" id="cb225-13" data-line-number="13"></a>
<a class="sourceLine" id="cb225-14" data-line-number="14">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb225-15" data-line-number="15">## inspected for dependencies.</a>
<a class="sourceLine" id="cb225-16" data-line-number="16"><span class="kw">outdated</span>(config)</a>
<a class="sourceLine" id="cb225-17" data-line-number="17">## Warning: File &quot;report.Rmd&quot; was built or processed,</a>
<a class="sourceLine" id="cb225-18" data-line-number="18">## but the file itself does not exist.</a>
<a class="sourceLine" id="cb225-19" data-line-number="19">##  [1] &quot;\&quot;report.md\&quot;&quot;          &quot;coef_regression1_large&quot;</a>
<a class="sourceLine" id="cb225-20" data-line-number="20">##  [3] &quot;coef_regression1_small&quot; &quot;coef_regression2_large&quot;</a>
<a class="sourceLine" id="cb225-21" data-line-number="21">##  [5] &quot;coef_regression2_small&quot; &quot;large&quot;                 </a>
<a class="sourceLine" id="cb225-22" data-line-number="22">##  [7] &quot;regression1_large&quot;      &quot;regression1_small&quot;     </a>
<a class="sourceLine" id="cb225-23" data-line-number="23">##  [9] &quot;regression2_large&quot;      &quot;regression2_small&quot;     </a>
<a class="sourceLine" id="cb225-24" data-line-number="24">## [11] &quot;small&quot;                  &quot;summ_regression1_large&quot;</a>
<a class="sourceLine" id="cb225-25" data-line-number="25">## [13] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;</a>
<a class="sourceLine" id="cb225-26" data-line-number="26">## [15] &quot;summ_regression2_small&quot;</a>
<a class="sourceLine" id="cb225-27" data-line-number="27"></a>
<a class="sourceLine" id="cb225-28" data-line-number="28">config &lt;-<span class="st"> </span><span class="kw">make</span>(my_plan, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb225-29" data-line-number="29">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb225-30" data-line-number="30">## inspected for dependencies.</a>
<a class="sourceLine" id="cb225-31" data-line-number="31"></a>
<a class="sourceLine" id="cb225-32" data-line-number="32">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb225-33" data-line-number="33">## inspected for dependencies.</a>
<a class="sourceLine" id="cb225-34" data-line-number="34"></a>
<a class="sourceLine" id="cb225-35" data-line-number="35">## Warning: knitr/rmarkdown report &#39;report.Rmd&#39; does not exist and cannot be</a>
<a class="sourceLine" id="cb225-36" data-line-number="36">## inspected for dependencies.</a>
<a class="sourceLine" id="cb225-37" data-line-number="37">## Error: hash &#39;989f3eade99b7b1b&#39; not found</a>
<a class="sourceLine" id="cb225-38" data-line-number="38"></a>
<a class="sourceLine" id="cb225-39" data-line-number="39"><span class="kw">short_hash</span>(config<span class="op">$</span>cache) <span class="co"># same as before</span></a>
<a class="sourceLine" id="cb225-40" data-line-number="40">## [1] &quot;xxhash64&quot;</a>
<a class="sourceLine" id="cb225-41" data-line-number="41"></a>
<a class="sourceLine" id="cb225-42" data-line-number="42"><span class="kw">long_hash</span>(config<span class="op">$</span>cache) <span class="co"># different from before</span></a>
<a class="sourceLine" id="cb225-43" data-line-number="43">## [1] &quot;murmur32&quot;</a></code></pre></div>
</div>
<div id="using-storr-directly" class="section level2">
<h2><span class="header-section-number">12.5</span> Using <code>storr</code> directly</h2>
<p>If you want bypass <code>drake</code> and generate a cache directly from <a href="https://github.com/richfitz/storr">storr</a>, it is best to do so right from the beginning.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" data-line-number="1"><span class="kw">library</span>(storr)</a>
<a class="sourceLine" id="cb226-2" data-line-number="2">my_storr &lt;-<span class="st"> </span><span class="kw">storr_rds</span>(<span class="st">&quot;my_storr&quot;</span>, <span class="dt">mangle_key =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb226-3" data-line-number="3">new_plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(<span class="dt">simple =</span> <span class="kw">sqrt</span>(<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb226-4" data-line-number="4"><span class="kw">make</span>(new_plan, <span class="dt">cache =</span> my_storr)</a>
<a class="sourceLine" id="cb226-5" data-line-number="5">## target simple</a>
<a class="sourceLine" id="cb226-6" data-line-number="6"></a>
<a class="sourceLine" id="cb226-7" data-line-number="7"><span class="kw">cached</span>(<span class="dt">cache =</span> my_storr)</a>
<a class="sourceLine" id="cb226-8" data-line-number="8">## [1] &quot;simple&quot; &quot;sqrt&quot;</a>
<a class="sourceLine" id="cb226-9" data-line-number="9"></a>
<a class="sourceLine" id="cb226-10" data-line-number="10"><span class="kw">readd</span>(simple, <span class="dt">cache =</span> my_storr)</a>
<a class="sourceLine" id="cb226-11" data-line-number="11">## [1] 2</a></code></pre></div>
<p>In addition to <code>storr_rds()</code>, <code>drake</code> supports in-memory caches created from <code>storr_environment()</code>. However, parallel computing is not supported these caches. The <code>jobs</code> argument must be 1, and the <code>parallelism</code> argument must be either <code>&quot;mclapply&quot;</code> or <code>&quot;parLapply&quot;</code>. (It is sufficient to leave the default values alone.)</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" data-line-number="1">memory_cache &lt;-<span class="st"> </span><span class="kw">storr_environment</span>()</a>
<a class="sourceLine" id="cb227-2" data-line-number="2">other_plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(</a>
<a class="sourceLine" id="cb227-3" data-line-number="3">  <span class="dt">some_data =</span> <span class="kw">rnorm</span>(<span class="dv">50</span>),</a>
<a class="sourceLine" id="cb227-4" data-line-number="4">  <span class="dt">more_data =</span> <span class="kw">rpois</span>(<span class="dv">75</span>, <span class="dt">lambda =</span> <span class="dv">10</span>),</a>
<a class="sourceLine" id="cb227-5" data-line-number="5">  <span class="dt">result =</span> <span class="kw">mean</span>(<span class="kw">c</span>(some_data, more_data))</a>
<a class="sourceLine" id="cb227-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb227-7" data-line-number="7"></a>
<a class="sourceLine" id="cb227-8" data-line-number="8"><span class="kw">make</span>(other_plan, <span class="dt">cache =</span> memory_cache)</a>
<a class="sourceLine" id="cb227-9" data-line-number="9">## target some_data</a>
<a class="sourceLine" id="cb227-10" data-line-number="10">## target more_data</a>
<a class="sourceLine" id="cb227-11" data-line-number="11">## target result</a>
<a class="sourceLine" id="cb227-12" data-line-number="12"></a>
<a class="sourceLine" id="cb227-13" data-line-number="13"><span class="kw">cached</span>(<span class="dt">cache =</span> memory_cache)</a>
<a class="sourceLine" id="cb227-14" data-line-number="14">## [1] &quot;c&quot;         &quot;mean&quot;      &quot;more_data&quot; &quot;result&quot;    &quot;rnorm&quot;     &quot;rpois&quot;    </a>
<a class="sourceLine" id="cb227-15" data-line-number="15">## [7] &quot;some_data&quot;</a>
<a class="sourceLine" id="cb227-16" data-line-number="16"></a>
<a class="sourceLine" id="cb227-17" data-line-number="17"><span class="kw">readd</span>(result, <span class="dt">cache =</span> memory_cache)</a>
<a class="sourceLine" id="cb227-18" data-line-number="18">## [1] 6.232917</a></code></pre></div>
<p>In theory, it should be possible to leverage serious databases using <code>storr_dbi()</code>. However, if you use such caches, please heed the following.</p>
<ol style="list-style-type: decimal">
<li>Be sure you have <a href="https://github.com/richfitz/storr">storr</a> version 1.1.3 or greater installed.</li>
<li>Be careful about parallel computing. For example the <code>storr::storr_dbi()</code> cache is not thread-safe. Either use no parallel computing at all or set <code>parallelism = &quot;future&quot;</code> with <code>caching = &quot;master&quot;</code>. The <code>&quot;future&quot;</code> backend is currently experimental, but it allows the master process to do all the caching in order to avoid race conditions.</li>
</ol>
<p>The following example requires the <code>DBI</code> and <code>RSQLite</code> packages.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" data-line-number="1">mydb &lt;-<span class="st"> </span>DBI<span class="op">::</span><span class="kw">dbConnect</span>(RSQLite<span class="op">::</span><span class="kw">SQLite</span>(), <span class="st">&quot;my-db.sqlite&quot;</span>)</a>
<a class="sourceLine" id="cb228-2" data-line-number="2">cache &lt;-<span class="st"> </span>storr<span class="op">::</span><span class="kw">storr_dbi</span>(</a>
<a class="sourceLine" id="cb228-3" data-line-number="3">  <span class="dt">tbl_data =</span> <span class="st">&quot;data&quot;</span>,</a>
<a class="sourceLine" id="cb228-4" data-line-number="4">  <span class="dt">tbl_keys =</span> <span class="st">&quot;keys&quot;</span>,</a>
<a class="sourceLine" id="cb228-5" data-line-number="5">  <span class="dt">con =</span> mydb</a>
<a class="sourceLine" id="cb228-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb228-7" data-line-number="7"><span class="kw">load_mtcars_example</span>() <span class="co"># Get the code with drake_example(&quot;mtcars&quot;).</span></a>
<a class="sourceLine" id="cb228-8" data-line-number="8"><span class="kw">unlink</span>(<span class="st">&quot;.drake&quot;</span>, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb228-9" data-line-number="9"><span class="kw">make</span>(my_plan, <span class="dt">cache =</span> cache)</a></code></pre></div>
</div>
<div id="cleaning-up" class="section level2">
<h2><span class="header-section-number">12.6</span> Cleaning up</h2>
<p>If you want to start from scratch, you can <code>clean()</code> the cache. Use the <code>destroy</code> argument to remove it completely. <code>cache$del()</code> and <code>cache$destroy()</code> are also options, but they leave output file targets dangling. By contrast, <code>clean(destroy = TRUE)</code> removes file targets generated by <code>drake::make()</code>. <code>drake_gc()</code> and <code>clean(..., garbage_collection = TRUE)</code> do garbage collection, and <code>clean(purge = TRUE)</code> removes all target-level data, not just the final output values.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" data-line-number="1"><span class="kw">clean</span>(small, large)</a>
<a class="sourceLine" id="cb229-2" data-line-number="2">## Error: hash &#39;989f3eade99b7b1b&#39; not found</a>
<a class="sourceLine" id="cb229-3" data-line-number="3"></a>
<a class="sourceLine" id="cb229-4" data-line-number="4"><span class="kw">cached</span>() <span class="co"># &#39;small&#39; and &#39;large&#39; are gone</span></a>
<a class="sourceLine" id="cb229-5" data-line-number="5">## Error: hash &#39;989f3eade99b7b1b&#39; not found</a>
<a class="sourceLine" id="cb229-6" data-line-number="6"></a>
<a class="sourceLine" id="cb229-7" data-line-number="7"><span class="kw">clean</span>(<span class="dt">destroy =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb229-8" data-line-number="8">## Error: hash &#39;989f3eade99b7b1b&#39; not found</a>
<a class="sourceLine" id="cb229-9" data-line-number="9"></a>
<a class="sourceLine" id="cb229-10" data-line-number="10"><span class="kw">clean</span>(<span class="dt">destroy =</span> <span class="ot">TRUE</span>, <span class="dt">cache =</span> my_storr)</a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="time.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="caution.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
