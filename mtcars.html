<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 5 The mtcars example and workflow plan generation | The drake R Package User Manual</title>
  <meta name="description" content="Chapter 5 The mtcars example and workflow plan generation | The drake R Package User Manual>
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 5 The mtcars example and workflow plan generation | The drake R Package User Manual />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 The mtcars example and workflow plan generation | The drake R Package User Manual />
  
  
  

<meta name="author" content="Will Landau, Kirill Müller, Alex Axthelm, Jasper Clarkberg, Lorenz Walthert">
<meta name="author" content="Copyright Eli Lilly and Company">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="gsp.html">
<link rel="next" href="plans.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.5/visNetwork.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/sankey-1/sankey.js"></script>
<script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-drake-r-package"><i class="fa fa-check"></i><b>1.1</b> The drake R package</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#why-drake"><i class="fa fa-check"></i><b>1.3</b> Why drake?</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#what-gets-done-stays-done."><i class="fa fa-check"></i><b>1.3.1</b> What gets done stays done.</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#reproducibility-with-confidence"><i class="fa fa-check"></i><b>1.3.2</b> Reproducibility with confidence</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#aggressively-scale-up."><i class="fa fa-check"></i><b>1.3.3</b> Aggressively scale up.</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#documentation"><i class="fa fa-check"></i><b>1.4</b> Documentation</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#cheat-sheet"><i class="fa fa-check"></i><b>1.4.1</b> Cheat sheet</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#frequently-asked-questions"><i class="fa fa-check"></i><b>1.4.2</b> Frequently asked questions</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#function-reference"><i class="fa fa-check"></i><b>1.4.3</b> Function reference</a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#tutorials"><i class="fa fa-check"></i><b>1.4.4</b> Tutorials</a></li>
<li class="chapter" data-level="1.4.5" data-path="index.html"><a href="index.html#examples"><i class="fa fa-check"></i><b>1.4.5</b> Examples</a></li>
<li class="chapter" data-level="1.4.6" data-path="index.html"><a href="index.html#presentations"><i class="fa fa-check"></i><b>1.4.6</b> Presentations</a></li>
<li class="chapter" data-level="1.4.7" data-path="index.html"><a href="index.html#real-example-projects"><i class="fa fa-check"></i><b>1.4.7</b> Real example projects</a></li>
<li class="chapter" data-level="1.4.8" data-path="index.html"><a href="index.html#context-and-history"><i class="fa fa-check"></i><b>1.4.8</b> Context and history</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#help-and-troubleshooting"><i class="fa fa-check"></i><b>1.5</b> Help and troubleshooting</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#similar-work"><i class="fa fa-check"></i><b>1.6</b> Similar work</a><ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#gnu-make"><i class="fa fa-check"></i><b>1.6.1</b> GNU Make</a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#remake"><i class="fa fa-check"></i><b>1.6.2</b> Remake</a></li>
<li class="chapter" data-level="1.6.3" data-path="index.html"><a href="index.html#memoise"><i class="fa fa-check"></i><b>1.6.3</b> Memoise</a></li>
<li class="chapter" data-level="1.6.4" data-path="index.html"><a href="index.html#knitr-and-r-markdown"><i class="fa fa-check"></i><b>1.6.4</b> Knitr and R Markdown</a></li>
<li class="chapter" data-level="1.6.5" data-path="index.html"><a href="index.html#factuals-drake"><i class="fa fa-check"></i><b>1.6.5</b> Factual’s Drake</a></li>
<li class="chapter" data-level="1.6.6" data-path="index.html"><a href="index.html#other-pipeline-toolkits"><i class="fa fa-check"></i><b>1.6.6</b> Other pipeline toolkits</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.7</b> Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>I Examples</b></span></li>
<li class="chapter" data-level="2" data-path="main.html"><a href="main.html"><i class="fa fa-check"></i><b>2</b> The main example</a><ul>
<li class="chapter" data-level="2.1" data-path="main.html"><a href="main.html#set-the-stage."><i class="fa fa-check"></i><b>2.1</b> Set the stage.</a></li>
<li class="chapter" data-level="2.2" data-path="main.html"><a href="main.html#make-your-results."><i class="fa fa-check"></i><b>2.2</b> Make your results.</a></li>
<li class="chapter" data-level="2.3" data-path="main.html"><a href="main.html#go-back-and-fix-things."><i class="fa fa-check"></i><b>2.3</b> Go back and fix things.</a></li>
<li class="chapter" data-level="2.4" data-path="main.html"><a href="main.html#try-it-yourself"><i class="fa fa-check"></i><b>2.4</b> Try it yourself!</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>3</b> An analysis of R package download trends</a><ul>
<li class="chapter" data-level="3.1" data-path="packages.html"><a href="packages.html#get-the-code."><i class="fa fa-check"></i><b>3.1</b> Get the code.</a></li>
<li class="chapter" data-level="3.2" data-path="packages.html"><a href="packages.html#overview"><i class="fa fa-check"></i><b>3.2</b> Overview</a></li>
<li class="chapter" data-level="3.3" data-path="packages.html"><a href="packages.html#analysis"><i class="fa fa-check"></i><b>3.3</b> Analysis</a></li>
<li class="chapter" data-level="3.4" data-path="packages.html"><a href="packages.html#other-ways-to-trigger-downloads"><i class="fa fa-check"></i><b>3.4</b> Other ways to trigger downloads</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="gsp.html"><a href="gsp.html"><i class="fa fa-check"></i><b>4</b> Finding the best model of gross state product</a><ul>
<li class="chapter" data-level="4.1" data-path="gsp.html"><a href="gsp.html#get-the-code.-1"><i class="fa fa-check"></i><b>4.1</b> Get the code.</a></li>
<li class="chapter" data-level="4.2" data-path="gsp.html"><a href="gsp.html#objective-and-methods"><i class="fa fa-check"></i><b>4.2</b> Objective and methods</a></li>
<li class="chapter" data-level="4.3" data-path="gsp.html"><a href="gsp.html#data"><i class="fa fa-check"></i><b>4.3</b> Data</a></li>
<li class="chapter" data-level="4.4" data-path="gsp.html"><a href="gsp.html#analysis-1"><i class="fa fa-check"></i><b>4.4</b> Analysis</a></li>
<li class="chapter" data-level="4.5" data-path="gsp.html"><a href="gsp.html#results"><i class="fa fa-check"></i><b>4.5</b> Results</a></li>
<li class="chapter" data-level="4.6" data-path="gsp.html"><a href="gsp.html#comparison-with-gnu-make"><i class="fa fa-check"></i><b>4.6</b> Comparison with GNU Make</a></li>
<li class="chapter" data-level="4.7" data-path="gsp.html"><a href="gsp.html#references"><i class="fa fa-check"></i><b>4.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mtcars.html"><a href="mtcars.html"><i class="fa fa-check"></i><b>5</b> The mtcars example and workflow plan generation</a><ul>
<li class="chapter" data-level="5.1" data-path="mtcars.html"><a href="mtcars.html#get-the-code.-2"><i class="fa fa-check"></i><b>5.1</b> Get the code.</a></li>
<li class="chapter" data-level="5.2" data-path="mtcars.html"><a href="mtcars.html#quick-examples"><i class="fa fa-check"></i><b>5.2</b> Quick examples</a></li>
<li class="chapter" data-level="5.3" data-path="mtcars.html"><a href="mtcars.html#the-motivation-of-the-mtcars-example"><i class="fa fa-check"></i><b>5.3</b> The motivation of the mtcars example</a></li>
<li class="chapter" data-level="5.4" data-path="mtcars.html"><a href="mtcars.html#set-up-the-mtcars-example"><i class="fa fa-check"></i><b>5.4</b> Set up the mtcars example</a></li>
<li class="chapter" data-level="5.5" data-path="mtcars.html"><a href="mtcars.html#the-workflow-plan-data-frame"><i class="fa fa-check"></i><b>5.5</b> The workflow plan data frame</a></li>
<li class="chapter" data-level="5.6" data-path="mtcars.html"><a href="mtcars.html#generate-the-workflow-plan"><i class="fa fa-check"></i><b>5.6</b> Generate the workflow plan</a></li>
<li class="chapter" data-level="5.7" data-path="mtcars.html"><a href="mtcars.html#run-the-workflow"><i class="fa fa-check"></i><b>5.7</b> Run the workflow</a></li>
</ul></li>
<li class="part"><span><b>II Functionality</b></span></li>
<li class="chapter" data-level="6" data-path="plans.html"><a href="plans.html"><i class="fa fa-check"></i><b>6</b> Workflow plan data frames</a><ul>
<li class="chapter" data-level="6.1" data-path="plans.html"><a href="plans.html#what-is-a-workflow-plan-data-frame"><i class="fa fa-check"></i><b>6.1</b> What is a workflow plan data frame?</a></li>
<li class="chapter" data-level="6.2" data-path="plans.html"><a href="plans.html#plans-are-like-r-scripts."><i class="fa fa-check"></i><b>6.2</b> Plans are like R scripts.</a></li>
<li class="chapter" data-level="6.3" data-path="plans.html"><a href="plans.html#so-why-do-we-use-plans"><i class="fa fa-check"></i><b>6.3</b> So why do we use plans?</a><ul>
<li class="chapter" data-level="6.3.1" data-path="plans.html"><a href="plans.html#you-can-skip-up-to-date-work."><i class="fa fa-check"></i><b>6.3.1</b> You can skip up-to-date work.</a></li>
<li class="chapter" data-level="6.3.2" data-path="plans.html"><a href="plans.html#data-frames-scale-well."><i class="fa fa-check"></i><b>6.3.2</b> Data frames scale well.</a></li>
<li class="chapter" data-level="6.3.3" data-path="plans.html"><a href="plans.html#you-do-not-need-to-worry-about-which-targets-run-first."><i class="fa fa-check"></i><b>6.3.3</b> You do not need to worry about which targets run first.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="plans.html"><a href="plans.html#automatic-dependency-detection"><i class="fa fa-check"></i><b>6.4</b> Automatic dependency detection</a></li>
<li class="chapter" data-level="6.5" data-path="plans.html"><a href="plans.html#automatically-generating-workflow-plans"><i class="fa fa-check"></i><b>6.5</b> Automatically generating workflow plans</a><ul>
<li class="chapter" data-level="6.5.1" data-path="plans.html"><a href="plans.html#map_plan"><i class="fa fa-check"></i><b>6.5.1</b> <code>map_plan()</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="plans.html"><a href="plans.html#wildcard-templating"><i class="fa fa-check"></i><b>6.5.2</b> Wildcard templating</a></li>
<li class="chapter" data-level="6.5.3" data-path="plans.html"><a href="plans.html#wildcard-clusters"><i class="fa fa-check"></i><b>6.5.3</b> Wildcard clusters</a></li>
<li class="chapter" data-level="6.5.4" data-path="plans.html"><a href="plans.html#specialized-wildcard-functionality"><i class="fa fa-check"></i><b>6.5.4</b> Specialized wildcard functionality</a></li>
<li class="chapter" data-level="6.5.5" data-path="plans.html"><a href="plans.html#non-wildcard-functions"><i class="fa fa-check"></i><b>6.5.5</b> Non-wildcard functions</a></li>
<li class="chapter" data-level="6.5.6" data-path="plans.html"><a href="plans.html#custom-metaprogramming"><i class="fa fa-check"></i><b>6.5.6</b> Custom metaprogramming</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="plans.html"><a href="plans.html#optional-columns-in-your-plan."><i class="fa fa-check"></i><b>6.6</b> Optional columns in your plan.</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="organize.html"><a href="organize.html"><i class="fa fa-check"></i><b>7</b> How to organize the files of drake projects</a><ul>
<li class="chapter" data-level="7.1" data-path="organize.html"><a href="organize.html#examples-1"><i class="fa fa-check"></i><b>7.1</b> Examples</a></li>
<li class="chapter" data-level="7.2" data-path="organize.html"><a href="organize.html#where-do-you-put-your-code"><i class="fa fa-check"></i><b>7.2</b> Where do you put your code?</a></li>
<li class="chapter" data-level="7.3" data-path="organize.html"><a href="organize.html#your-commands-are-code-chunks-not-r-scripts"><i class="fa fa-check"></i><b>7.3</b> Your commands are code chunks, not R scripts</a></li>
<li class="chapter" data-level="7.4" data-path="organize.html"><a href="organize.html#workflows-as-r-packages"><i class="fa fa-check"></i><b>7.4</b> Workflows as R packages</a><ul>
<li class="chapter" data-level="7.4.1" data-path="organize.html"><a href="organize.html#advantages-of-putting-workflows-in-r-packages"><i class="fa fa-check"></i><b>7.4.1</b> Advantages of putting workflows in R packages</a></li>
<li class="chapter" data-level="7.4.2" data-path="organize.html"><a href="organize.html#the-problem"><i class="fa fa-check"></i><b>7.4.2</b> The problem</a></li>
<li class="chapter" data-level="7.4.3" data-path="organize.html"><a href="organize.html#the-solution"><i class="fa fa-check"></i><b>7.4.3</b> The solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="vis.html"><a href="vis.html"><i class="fa fa-check"></i><b>8</b> Visualization with drake</a><ul>
<li class="chapter" data-level="8.0.1" data-path="vis.html"><a href="vis.html#vis_drake_graph"><i class="fa fa-check"></i><b>8.0.1</b> <code>vis_drake_graph()</code></a></li>
<li class="chapter" data-level="8.0.2" data-path="vis.html"><a href="vis.html#sankey_drake_graph"><i class="fa fa-check"></i><b>8.0.2</b> <code>sankey_drake_graph()</code></a></li>
<li class="chapter" data-level="8.0.3" data-path="vis.html"><a href="vis.html#drake_ggraph"><i class="fa fa-check"></i><b>8.0.3</b> <code>drake_ggraph()</code></a></li>
<li class="chapter" data-level="8.1" data-path="vis.html"><a href="vis.html#underlying-graph-data-node-and-edge-data-frames"><i class="fa fa-check"></i><b>8.1</b> Underlying graph data: node and edge data frames</a></li>
<li class="chapter" data-level="8.2" data-path="vis.html"><a href="vis.html#visualizing-target-status"><i class="fa fa-check"></i><b>8.2</b> Visualizing target status</a></li>
<li class="chapter" data-level="8.3" data-path="vis.html"><a href="vis.html#subgraphs"><i class="fa fa-check"></i><b>8.3</b> Subgraphs</a></li>
<li class="chapter" data-level="8.4" data-path="vis.html"><a href="vis.html#control-the-vis_drake_graph-legend."><i class="fa fa-check"></i><b>8.4</b> Control the <code>vis_drake_graph()</code> legend.</a></li>
<li class="chapter" data-level="8.5" data-path="vis.html"><a href="vis.html#clusters"><i class="fa fa-check"></i><b>8.5</b> Clusters</a></li>
<li class="chapter" data-level="8.6" data-path="vis.html"><a href="vis.html#output-files"><i class="fa fa-check"></i><b>8.6</b> Output files</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="debug.html"><a href="debug.html"><i class="fa fa-check"></i><b>9</b> Debugging and testing drake projects</a><ul>
<li class="chapter" data-level="9.1" data-path="debug.html"><a href="debug.html#dependencies"><i class="fa fa-check"></i><b>9.1</b> Dependencies</a><ul>
<li class="chapter" data-level="9.1.1" data-path="debug.html"><a href="debug.html#visualize-your-dependency-graph."><i class="fa fa-check"></i><b>9.1.1</b> Visualize your dependency graph.</a></li>
<li class="chapter" data-level="9.1.2" data-path="debug.html"><a href="debug.html#check-specific-dependency-information."><i class="fa fa-check"></i><b>9.1.2</b> Check specific dependency information.</a></li>
<li class="chapter" data-level="9.1.3" data-path="debug.html"><a href="debug.html#outdated-targets-and-missing-dependencies"><i class="fa fa-check"></i><b>9.1.3</b> Outdated targets and missing dependencies</a></li>
<li class="chapter" data-level="9.1.4" data-path="debug.html"><a href="debug.html#but-why-are-my-targets-out-of-date"><i class="fa fa-check"></i><b>9.1.4</b> But <em>why</em> are my targets out of date?</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="debug.html"><a href="debug.html#diagnose-failures."><i class="fa fa-check"></i><b>9.2</b> Diagnose failures.</a></li>
<li class="chapter" data-level="9.3" data-path="debug.html"><a href="debug.html#timeouts-and-retries"><i class="fa fa-check"></i><b>9.3</b> Timeouts and retries</a></li>
<li class="chapter" data-level="9.4" data-path="debug.html"><a href="debug.html#consider-hasty-mode"><i class="fa fa-check"></i><b>9.4</b> Consider hasty mode</a></li>
<li class="chapter" data-level="9.5" data-path="debug.html"><a href="debug.html#more-help"><i class="fa fa-check"></i><b>9.5</b> More help</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="hpc.html"><a href="hpc.html"><i class="fa fa-check"></i><b>10</b> High-performance computing</a><ul>
<li class="chapter" data-level="10.1" data-path="hpc.html"><a href="hpc.html#batch-mode-for-long-workflows"><i class="fa fa-check"></i><b>10.1</b> Batch mode for long workflows</a></li>
<li class="chapter" data-level="10.2" data-path="hpc.html"><a href="hpc.html#let-make-schedule-your-targets."><i class="fa fa-check"></i><b>10.2</b> Let <code>make()</code> schedule your targets.</a></li>
<li class="chapter" data-level="10.3" data-path="hpc.html"><a href="hpc.html#parallel-backends"><i class="fa fa-check"></i><b>10.3</b> Parallel backends</a></li>
<li class="chapter" data-level="10.4" data-path="hpc.html"><a href="hpc.html#the-clustermq-backend"><i class="fa fa-check"></i><b>10.4</b> The <a href="https://github.com/mschubert/clustermq"><code>clustermq</code></a> backend</a><ul>
<li class="chapter" data-level="10.4.1" data-path="hpc.html"><a href="hpc.html#the-idea-persistent-workers"><i class="fa fa-check"></i><b>10.4.1</b> The idea: persistent workers</a></li>
<li class="chapter" data-level="10.4.2" data-path="hpc.html"><a href="hpc.html#installation-1"><i class="fa fa-check"></i><b>10.4.2</b> Installation</a></li>
<li class="chapter" data-level="10.4.3" data-path="hpc.html"><a href="hpc.html#local-parallelism"><i class="fa fa-check"></i><b>10.4.3</b> Local parallelism</a></li>
<li class="chapter" data-level="10.4.4" data-path="hpc.html"><a href="hpc.html#on-a-cluster"><i class="fa fa-check"></i><b>10.4.4</b> On a cluster</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="hpc.html"><a href="hpc.html#the-future-backend"><i class="fa fa-check"></i><b>10.5</b> The <a href="https://github.com/HenrikBengtsson/future"><code>future</code></a> backend</a><ul>
<li class="chapter" data-level="10.5.1" data-path="hpc.html"><a href="hpc.html#the-idea-transient-workers"><i class="fa fa-check"></i><b>10.5.1</b> The idea: transient workers</a></li>
<li class="chapter" data-level="10.5.2" data-path="hpc.html"><a href="hpc.html#installation-2"><i class="fa fa-check"></i><b>10.5.2</b> Installation</a></li>
<li class="chapter" data-level="10.5.3" data-path="hpc.html"><a href="hpc.html#local-parallelism-1"><i class="fa fa-check"></i><b>10.5.3</b> Local parallelism</a></li>
<li class="chapter" data-level="10.5.4" data-path="hpc.html"><a href="hpc.html#on-a-cluster-1"><i class="fa fa-check"></i><b>10.5.4</b> On a cluster</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="hpc.html"><a href="hpc.html#advanced-options"><i class="fa fa-check"></i><b>10.6</b> Advanced options</a><ul>
<li class="chapter" data-level="10.6.1" data-path="hpc.html"><a href="hpc.html#who-stores-the-targets"><i class="fa fa-check"></i><b>10.6.1</b> Who stores the targets?</a></li>
<li class="chapter" data-level="10.6.2" data-path="hpc.html"><a href="hpc.html#the-template-argument-of-make"><i class="fa fa-check"></i><b>10.6.2</b> The <code>template</code> argument of <code>make()</code></a></li>
<li class="chapter" data-level="10.6.3" data-path="hpc.html"><a href="hpc.html#hasty-mode"><i class="fa fa-check"></i><b>10.6.3</b> Hasty mode</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="triggers.html"><a href="triggers.html"><i class="fa fa-check"></i><b>11</b> Triggers: decision rules for building targets</a><ul>
<li class="chapter" data-level="11.1" data-path="triggers.html"><a href="triggers.html#what-are-triggers"><i class="fa fa-check"></i><b>11.1</b> What are triggers?</a></li>
<li class="chapter" data-level="11.2" data-path="triggers.html"><a href="triggers.html#customization"><i class="fa fa-check"></i><b>11.2</b> Customization</a></li>
<li class="chapter" data-level="11.3" data-path="triggers.html"><a href="triggers.html#alternative-trigger-modes"><i class="fa fa-check"></i><b>11.3</b> Alternative trigger modes</a></li>
<li class="chapter" data-level="11.4" data-path="triggers.html"><a href="triggers.html#consider-hasty-mode-1"><i class="fa fa-check"></i><b>11.4</b> Consider hasty mode</a></li>
<li class="chapter" data-level="11.5" data-path="triggers.html"><a href="triggers.html#a-more-practical-example"><i class="fa fa-check"></i><b>11.5</b> A more practical example</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="time.html"><a href="time.html"><i class="fa fa-check"></i><b>12</b> Time: logging, prediction, and strategy</a><ul>
<li class="chapter" data-level="12.1" data-path="time.html"><a href="time.html#predict-total-runtime"><i class="fa fa-check"></i><b>12.1</b> Predict total runtime</a></li>
<li class="chapter" data-level="12.2" data-path="time.html"><a href="time.html#strategize-your-high-performance-computing"><i class="fa fa-check"></i><b>12.2</b> Strategize your high-performance computing</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="store.html"><a href="store.html"><i class="fa fa-check"></i><b>13</b> Storage</a><ul>
<li class="chapter" data-level="13.1" data-path="store.html"><a href="store.html#cache-formats"><i class="fa fa-check"></i><b>13.1</b> Cache formats</a><ul>
<li class="chapter" data-level="13.1.1" data-path="store.html"><a href="store.html#rds-caches"><i class="fa fa-check"></i><b>13.1.1</b> RDS caches</a></li>
<li class="chapter" data-level="13.1.2" data-path="store.html"><a href="store.html#database-caches"><i class="fa fa-check"></i><b>13.1.2</b> Database caches</a></li>
<li class="chapter" data-level="13.1.3" data-path="store.html"><a href="store.html#environment-caches"><i class="fa fa-check"></i><b>13.1.3</b> Environment caches</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="store.html"><a href="store.html#hash-algorithms"><i class="fa fa-check"></i><b>13.2</b> Hash algorithms</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>A</b> Frequently-asked questions</a></li>
<li class="chapter" data-level="B" data-path="caution.html"><a href="caution.html"><i class="fa fa-check"></i><b>B</b> Cautionary notes</a><ul>
<li class="chapter" data-level="B.1" data-path="caution.html"><a href="caution.html#projects-built-with-drake-4.4.0-are-not-back-compatible-with-drake-4.4.0."><i class="fa fa-check"></i><b>B.1</b> Projects built with drake &lt;= 4.4.0 are not back compatible with drake &gt; 4.4.0.</a></li>
<li class="chapter" data-level="B.2" data-path="caution.html"><a href="caution.html#workflow-plans"><i class="fa fa-check"></i><b>B.2</b> Workflow plans</a><ul>
<li class="chapter" data-level="B.2.1" data-path="caution.html"><a href="caution.html#externalizing-commands-in-r-script-files"><i class="fa fa-check"></i><b>B.2.1</b> Externalizing commands in R script files</a></li>
<li class="chapter" data-level="B.2.2" data-path="caution.html"><a href="caution.html#commands-are-not-perfectly-flexible."><i class="fa fa-check"></i><b>B.2.2</b> Commands are NOT perfectly flexible.</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="caution.html"><a href="caution.html#execution"><i class="fa fa-check"></i><b>B.3</b> Execution</a><ul>
<li class="chapter" data-level="B.3.1" data-path="caution.html"><a href="caution.html#install-drake-properly."><i class="fa fa-check"></i><b>B.3.1</b> Install <code>drake</code> properly.</a></li>
<li class="chapter" data-level="B.3.2" data-path="caution.html"><a href="caution.html#install-all-your-packages."><i class="fa fa-check"></i><b>B.3.2</b> Install all your packages.</a></li>
<li class="chapter" data-level="B.3.3" data-path="caution.html"><a href="caution.html#a-note-on-tidy-evaluation"><i class="fa fa-check"></i><b>B.3.3</b> A note on tidy evaluation</a></li>
<li class="chapter" data-level="B.3.4" data-path="caution.html"><a href="caution.html#find-and-diagnose-your-errors."><i class="fa fa-check"></i><b>B.3.4</b> Find and diagnose your errors.</a></li>
<li class="chapter" data-level="B.3.5" data-path="caution.html"><a href="caution.html#refresh-the-drake_config-list-early-and-often."><i class="fa fa-check"></i><b>B.3.5</b> Refresh the <code>drake_config()</code> list early and often.</a></li>
<li class="chapter" data-level="B.3.6" data-path="caution.html"><a href="caution.html#workflows-as-r-packages."><i class="fa fa-check"></i><b>B.3.6</b> Workflows as R packages.</a></li>
<li class="chapter" data-level="B.3.7" data-path="caution.html"><a href="caution.html#the-lazy_load-flag-does-not-work-with-parlapply-parallelism."><i class="fa fa-check"></i><b>B.3.7</b> The <code>lazy_load</code> flag does not work with <code>&quot;parLapply&quot;</code> parallelism.</a></li>
<li class="chapter" data-level="B.3.8" data-path="caution.html"><a href="caution.html#timeouts-may-be-unreliable."><i class="fa fa-check"></i><b>B.3.8</b> Timeouts may be unreliable.</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="caution.html"><a href="caution.html#dependencies-1"><i class="fa fa-check"></i><b>B.4</b> Dependencies</a><ul>
<li class="chapter" data-level="B.4.1" data-path="caution.html"><a href="caution.html#objects-that-contain-functions-may-rebuild-too-often"><i class="fa fa-check"></i><b>B.4.1</b> Objects that contain functions may rebuild too often</a></li>
<li class="chapter" data-level="B.4.2" data-path="caution.html"><a href="caution.html#the-magrittr-dot-.-is-always-ignored."><i class="fa fa-check"></i><b>B.4.2</b> The <code>magrittr</code> dot (<code>.</code>) is always ignored.</a></li>
<li class="chapter" data-level="B.4.3" data-path="caution.html"><a href="caution.html#dependencies-are-not-tracked-in-some-edge-cases."><i class="fa fa-check"></i><b>B.4.3</b> Dependencies are not tracked in some edge cases.</a></li>
<li class="chapter" data-level="B.4.4" data-path="caution.html"><a href="caution.html#dependencies-of-knitr-reports"><i class="fa fa-check"></i><b>B.4.4</b> Dependencies of <code>knitr</code> reports</a></li>
<li class="chapter" data-level="B.4.5" data-path="caution.html"><a href="caution.html#file-outputs-in-imported-functions."><i class="fa fa-check"></i><b>B.4.5</b> File outputs in imported functions.</a></li>
<li class="chapter" data-level="B.4.6" data-path="caution.html"><a href="caution.html#functions-produced-by-vectorize"><i class="fa fa-check"></i><b>B.4.6</b> Functions produced by <code>Vectorize()</code></a></li>
<li class="chapter" data-level="B.4.7" data-path="caution.html"><a href="caution.html#compiled-code-is-not-reproducibly-tracked."><i class="fa fa-check"></i><b>B.4.7</b> Compiled code is not reproducibly tracked.</a></li>
<li class="chapter" data-level="B.4.8" data-path="caution.html"><a href="caution.html#directories-folders-are-not-reproducibly-tracked."><i class="fa fa-check"></i><b>B.4.8</b> Directories (folders) are not reproducibly tracked.</a></li>
<li class="chapter" data-level="B.4.9" data-path="caution.html"><a href="caution.html#packages-are-not-tracked-as-dependencies."><i class="fa fa-check"></i><b>B.4.9</b> Packages are not tracked as dependencies.</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="caution.html"><a href="caution.html#high-performance-computing"><i class="fa fa-check"></i><b>B.5</b> High-performance computing</a><ul>
<li class="chapter" data-level="B.5.1" data-path="caution.html"><a href="caution.html#the-practical-utility-of-parallel-computing"><i class="fa fa-check"></i><b>B.5.1</b> The practical utility of parallel computing</a></li>
<li class="chapter" data-level="B.5.2" data-path="caution.html"><a href="caution.html#maximum-number-of-simultaneous-jobs"><i class="fa fa-check"></i><b>B.5.2</b> Maximum number of simultaneous jobs</a></li>
<li class="chapter" data-level="B.5.3" data-path="caution.html"><a href="caution.html#parallel-computing-on-windows"><i class="fa fa-check"></i><b>B.5.3</b> Parallel computing on Windows</a></li>
<li class="chapter" data-level="B.5.4" data-path="caution.html"><a href="caution.html#configuring-futurebatchtools-parallelism-for-clusters"><i class="fa fa-check"></i><b>B.5.4</b> Configuring <a href="https://github.com/HenrikBengtsson/future">future</a>/<a href="https://github.com/mllg/batchtools">batchtools</a> parallelism for clusters</a></li>
<li class="chapter" data-level="B.5.5" data-path="caution.html"><a href="caution.html#proper-makefiles-are-not-standalone."><i class="fa fa-check"></i><b>B.5.5</b> Proper Makefiles are not standalone.</a></li>
<li class="chapter" data-level="B.5.6" data-path="caution.html"><a href="caution.html#makefile-level-parallelism-for-imported-objects-and-files"><i class="fa fa-check"></i><b>B.5.6</b> Makefile-level parallelism for imported objects and files</a></li>
<li class="chapter" data-level="B.5.7" data-path="caution.html"><a href="caution.html#zombie-processes"><i class="fa fa-check"></i><b>B.5.7</b> Zombie processes</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="caution.html"><a href="caution.html#storage"><i class="fa fa-check"></i><b>B.6</b> Storage</a><ul>
<li class="chapter" data-level="B.6.1" data-path="caution.html"><a href="caution.html#projects-hosted-on-dropbox-and-similar-platforms"><i class="fa fa-check"></i><b>B.6.1</b> Projects hosted on Dropbox and similar platforms</a></li>
<li class="chapter" data-level="B.6.2" data-path="caution.html"><a href="caution.html#cache-customization-is-limited"><i class="fa fa-check"></i><b>B.6.2</b> Cache customization is limited</a></li>
<li class="chapter" data-level="B.6.3" data-path="caution.html"><a href="caution.html#runtime-predictions"><i class="fa fa-check"></i><b>B.6.3</b> Runtime predictions</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The drake R Package User Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mtcars" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> The mtcars example and workflow plan generation</h1>
<p>This chapter is a walkthrough of <code>drake</code>’s main functionality based on the mtcars example. It sets up the project and runs it repeatedly to demonstrate <code>drake</code>’s most important functionality.</p>
<div id="get-the-code.-2" class="section level2">
<h2><span class="header-section-number">5.1</span> Get the code.</h2>
<p>Write the code files to your workspace.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">drake_example</span>(<span class="st">&quot;mtcars&quot;</span>)</code></pre>
<p>The new <code>mtcars</code> folder now includes a file structure of a serious <code>drake</code> project, plus an <code>interactive-tutorial.R</code> to narrate the example. The code is also <a href="https://github.com/wlandau/drake-examples/tree/master/mtcars">online here</a>.</p>
</div>
<div id="quick-examples" class="section level2">
<h2><span class="header-section-number">5.2</span> Quick examples</h2>
<p>Inspect and run your project.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(drake)
<span class="kw">load_mtcars_example</span>()            <span class="co"># Get the code with drake_example(&quot;mtcars&quot;).</span>
config &lt;-<span class="st"> </span><span class="kw">drake_config</span>(my_plan) <span class="co"># Master configuration list</span>
<span class="kw">vis_drake_graph</span>(config)         <span class="co"># Hover, click, drag, zoom, pan.</span>
<span class="kw">make</span>(my_plan)                   <span class="co"># Run the workflow.</span>
<span class="kw">outdated</span>(config)                <span class="co"># Everything is up to date.</span></code></pre>
<p>Debug errors.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">failed</span>()                   <span class="co"># Targets that failed in the most recent `make()`</span>
context &lt;-<span class="st"> </span><span class="kw">diagnose</span>(large) <span class="co"># Diagnostic metadata: errors, warnings, etc.</span>
error &lt;-<span class="st"> </span>context<span class="op">$</span>error
<span class="kw">str</span>(error)                 <span class="co"># Object of class &quot;error&quot;</span>
error<span class="op">$</span>message
error<span class="op">$</span>call
error<span class="op">$</span>calls                <span class="co"># Full traceback of nested calls leading up to the error. # nolint</span></code></pre>
<p>Dive deeper into the built-in examples.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">drake_example</span>(<span class="st">&quot;mtcars&quot;</span>) <span class="co"># Write the code files.</span>
<span class="kw">drake_examples</span>()        <span class="co"># List the other examples.</span></code></pre>
</div>
<div id="the-motivation-of-the-mtcars-example" class="section level2">
<h2><span class="header-section-number">5.3</span> The motivation of the mtcars example</h2>
<p>Is there an association between the weight and the fuel efficiency of cars? To find out, we use the <code>mtcars</code> dataset from the <code>datasets</code> package. The <code>mtcars</code> dataset originally came from the 1974 Motor Trend US magazine, and it contains design and performance data on 32 models of automobile.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ?mtcars # more info</span>
<span class="kw">head</span>(mtcars)
##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<p>Here, <code>wt</code> is weight in tons, and <code>mpg</code> is fuel efficiency in miles per gallon. We want to figure out if there is an association between <code>wt</code> and <code>mpg</code>. The <code>mtcars</code> dataset itself only has 32 rows, so we generate two larger bootstrapped datasets and then analyze them with regression models. We summarize the regression models to see if there is an association.</p>
</div>
<div id="set-up-the-mtcars-example" class="section level2">
<h2><span class="header-section-number">5.4</span> Set up the mtcars example</h2>
<p>Before you run your project, you need to set up the workspace. In other words, you need to gather the “imports”: functions, pre-loaded data objects, and saved files that you want to be available before the real work begins.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(knitr) <span class="co"># drake knows which packages you load.</span>
<span class="kw">library</span>(drake)</code></pre>
<p>We need a function to bootstrap larger datasets from <code>mtcars</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Pick a random subset of n rows from a dataset</span>
random_rows &lt;-<span class="st"> </span><span class="cf">function</span>(data, n){
  data[<span class="kw">sample.int</span>(<span class="dt">n =</span> <span class="kw">nrow</span>(data), <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>), ]
}

<span class="co"># Bootstrapped datasets from mtcars.</span>
simulate &lt;-<span class="st"> </span><span class="cf">function</span>(n){
  <span class="co"># Pick a random set of cars to bootstrap from the mtcars data.</span>
  data &lt;-<span class="st"> </span><span class="kw">random_rows</span>(<span class="dt">data =</span> mtcars, <span class="dt">n =</span> n)

  <span class="co"># x is the car&#39;s weight, and y is the fuel efficiency.</span>
  <span class="kw">data.frame</span>(
    <span class="dt">x =</span> data<span class="op">$</span>wt,
    <span class="dt">y =</span> data<span class="op">$</span>mpg
  )
}</code></pre>
<p>We also need functions to apply the regression models we need for detecting associations.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Is fuel efficiency linearly related to weight?</span>
reg1 &lt;-<span class="st"> </span><span class="cf">function</span>(d){
  <span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="op">+</span><span class="st"> </span>x, <span class="dt">data =</span> d)
}

<span class="co"># Is fuel efficiency related to the SQUARE of the weight?</span>
reg2 &lt;-<span class="st"> </span><span class="cf">function</span>(d){
  d<span class="op">$</span>x2 &lt;-<span class="st"> </span>d<span class="op">$</span>x <span class="op">^</span><span class="st"> </span><span class="dv">2</span>
  <span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x2, <span class="dt">data =</span> d)
}</code></pre>
<p>We want to summarize the final results in an R Markdown report, so we need the the <code>report.Rmd</code> source file. You can get it with <code>drake_example(&quot;mtcars&quot;)</code> or <code>load_mtcars_example()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">drake_example</span>(<span class="st">&quot;mtcars&quot;</span>, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)
<span class="kw">file.copy</span>(<span class="st">&quot;mtcars/report.Rmd&quot;</span>, <span class="st">&quot;.&quot;</span>, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)
## [1] TRUE</code></pre>
<p>Here are the contents of the report. It will serve as a final summary of our work, and we will process it at the very end. Admittedly, some of the text spoils the punch line.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="kw">readLines</span>(<span class="st">&quot;report.Rmd&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
## ---
## title: &quot;Final results report for the mtcars example&quot;
## author: You
## output: html_document
## ---
## 
## # The weight and fuel efficiency of cars
## 
## Is there an association between the weight and the fuel efficiency of cars? To find out, we use the `mtcars` dataset from the `datasets` package. The `mtcars` data originally came from the 1974 Motor Trend US magazine, and it contains design and performance data on 32 models of automobile.
## 
## ```{r showmtcars}
## # ?mtcars # more info
## head(mtcars)
## ```
## 
## Here, `wt` is weight in tons, and `mpg` is fuel efficiency in miles per gallon. We want to figure out if there is an association between `wt` and `mpg`. The `mtcars` dataset itself only has 32 rows, so we generated two larger bootstrapped datasets. We called them `small` and `large`.
## 
## ```{r example_chunk}
## library(drake)
## head(readd(small)) # 48 rows
## loadd(large)       # 64 rows
## head(large)
## ```
## 
## Then, we fit a couple regression models to the `small` and `large` to try to detect an association between `wt` and `mpg`. Here are the coefficients and p-values from one of the model fits.
## 
## ```{r second_example_chunk}
## readd(coef_regression2_small)
## ```
## 
## Since the p-value on `x2` is so small, there may be an association between weight and fuel efficiency after all.
## 
## # A note on knitr reports in drake projects.
## 
## Because of the calls to `readd()` and `loadd()`, `drake` knows that `small`, `large`, and `coef_regression2_small` are dependencies of this R Markdown report. This dependency relationship is what causes the report to be processed at the very end.</code></pre>
<p>Now, all our imports are set up. When the real work begins, <code>drake</code> will import functions and data objects from your R session environment</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ls</span>()
##  [1] &quot;combos&quot;             &quot;config&quot;             &quot;create_plot&quot;       
##  [4] &quot;data_plan&quot;          &quot;fit_gsp_model&quot;      &quot;get_logs&quot;          
##  [7] &quot;get_rmspe&quot;          &quot;hist&quot;               &quot;latest_log_date&quot;   
## [10] &quot;make_my_plot&quot;       &quot;make_my_table&quot;      &quot;model_plan&quot;        
## [13] &quot;output_plan&quot;        &quot;output_types&quot;       &quot;package_list&quot;      
## [16] &quot;plan&quot;               &quot;plot_rmspe&quot;         &quot;predictors&quot;        
## [19] &quot;Produc&quot;             &quot;random_rows&quot;        &quot;reg1&quot;              
## [22] &quot;reg2&quot;               &quot;report_plan&quot;        &quot;results&quot;           
## [25] &quot;rmspe_args&quot;         &quot;rmspe_plan&quot;         &quot;rmspe_results_plan&quot;
## [28] &quot;simulate&quot;           &quot;url&quot;                &quot;whole_plan&quot;</code></pre>
<p>and saved files from your file system.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list.files</span>()
##  [1] &quot;_book&quot;              &quot;_bookdown.yml&quot;      &quot;appendix.Rmd&quot;      
##  [4] &quot;build.R&quot;            &quot;caution.Rmd&quot;        &quot;CONDUCT.md&quot;        
##  [7] &quot;debug.Rmd&quot;          &quot;deploy.sh&quot;          &quot;DESCRIPTION&quot;       
## [10] &quot;drake-manual_files&quot; &quot;drake-manual.Rmd&quot;   &quot;drake-manual.Rproj&quot;
## [13] &quot;examples.Rmd&quot;       &quot;faq.R&quot;              &quot;faq.Rmd&quot;           
## [16] &quot;footer.html&quot;        &quot;functionality.Rmd&quot;  &quot;gsp.Rmd&quot;           
## [19] &quot;hpc.Rmd&quot;            &quot;images&quot;             &quot;index.Rmd&quot;         
## [22] &quot;LICENSE&quot;            &quot;main.Rmd&quot;           &quot;mtcars&quot;            
## [25] &quot;mtcars.Rmd&quot;         &quot;NEWS.md&quot;            &quot;organize.Rmd&quot;      
## [28] &quot;packages.Rmd&quot;       &quot;plans.Rmd&quot;          &quot;README.md&quot;         
## [31] &quot;report.Rmd&quot;         &quot;store.Rmd&quot;          &quot;time.Rmd&quot;          
## [34] &quot;triggers.Rmd&quot;       &quot;visuals.Rmd&quot;</code></pre>
</div>
<div id="the-workflow-plan-data-frame" class="section level2">
<h2><span class="header-section-number">5.5</span> The workflow plan data frame</h2>
<p>Now that your workspace of imports is prepared, we can outline the real work step by step in a workflow plan data frame.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load_mtcars_example</span>() <span class="co"># Get the code with drake_example(&quot;mtcars&quot;).</span>
my_plan
## # A tibble: 15 x 2
##    target             command                                              
##    &lt;chr&gt;              &lt;chr&gt;                                                
##  1 report             &quot;knit(knitr_in(\&quot;report.Rmd\&quot;), file_out(\&quot;report.md…
##  2 small              simulate(48)                                         
##  3 large              simulate(64)                                         
##  4 regression1_small  reg1(small)                                          
##  5 regression1_large  reg1(large)                                          
##  6 regression2_small  reg2(small)                                          
##  7 regression2_large  reg2(large)                                          
##  8 summ_regression1_… suppressWarnings(summary(regression1_small$residuals…
##  9 summ_regression1_… suppressWarnings(summary(regression1_large$residuals…
## 10 summ_regression2_… suppressWarnings(summary(regression2_small$residuals…
## 11 summ_regression2_… suppressWarnings(summary(regression2_large$residuals…
## 12 coef_regression1_… suppressWarnings(summary(regression1_small))$coeffic…
## 13 coef_regression1_… suppressWarnings(summary(regression1_large))$coeffic…
## 14 coef_regression2_… suppressWarnings(summary(regression2_small))$coeffic…
## 15 coef_regression2_… suppressWarnings(summary(regression2_large))$coeffic…</code></pre>
<p>Each row is an intermediate step, and each <strong>command</strong> generates a single <strong>target</strong>. A target is an output R object (cached when generated) or an output file (specified with single quotes), and a command just an ordinary piece of R code (not necessarily a single function call). Commands make use of targets generated by other commands, objects your environment, input files, and namespaced objects/functions from packages (referenced with <code>::</code> or <code>:::</code>). These dependencies give your project an underlying network representation.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Hover, click, drag, zoom, and pan.</span>
config &lt;-<span class="st"> </span><span class="kw">drake_config</span>(my_plan)
<span class="kw">vis_drake_graph</span>(config, <span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>, <span class="dt">height =</span> <span class="st">&quot;500px&quot;</span>) <span class="co"># Also drake_graph()</span></code></pre>
<div id="htmlwidget-8e993214f8820cacc6c0" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-8e993214f8820cacc6c0">{"x":{"nodes":{"id":["\"report.md\"","\"report.Rmd\"","coef_regression1_large","coef_regression1_small","coef_regression2_large","coef_regression2_small","large","random_rows","reg1","reg2","regression1_large","regression1_small","regression2_large","regression2_small","report","simulate","small","summ_regression1_large","summ_regression1_small","summ_regression2_large","summ_regression2_small"],"label":["\"report.md\"\n0.001s","\"report.Rmd\"\n0.002s","coef_regression1_large","coef_regression1_small","coef_regression2_large","coef_regression2_small","large","random_rows\n0.001s","reg1\n0.001s","reg2\n0.002s","regression1_large","regression1_small","regression2_large","regression2_small","report","simulate\n0.002s","small","summ_regression1_large","summ_regression1_small","summ_regression2_large","summ_regression2_small"],"command":["knit(knitr_in(\"report.Rmd\"), file_out(\"report.md\"), quiet = TRUE)",null,"suppressWarnings(summary(regression1_large))$coefficients","suppressWarnings(summary(regression1_small))$coefficients","suppressWarnings(summary(regression2_large))$coefficients","suppressWarnings(summary(regression2_small))$coefficients","simulate(64)",null,null,null,"reg1(large)","reg1(small)","reg2(large)","reg2(small)","knit(knitr_in(\"report.Rmd\"), file_out(\"report.md\"), quiet = TRUE)",null,"simulate(48)","suppressWarnings(summary(regression1_large$residuals))","suppressWarnings(summary(regression1_small$residuals))","suppressWarnings(summary(regression2_large$residuals))","suppressWarnings(summary(regression2_small$residuals))"],"status":["outdated","imported","outdated","outdated","outdated","outdated","outdated","imported","imported","imported","outdated","outdated","outdated","outdated","outdated","imported","outdated","outdated","outdated","outdated","outdated"],"type":["object","file","object","object","object","object","object","function","function","function","object","object","object","object","object","function","object","object","object","object","object"],"font.size":[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],"color":["#000000","#1874CD","#000000","#000000","#000000","#000000","#000000","#1874CD","#1874CD","#1874CD","#000000","#000000","#000000","#000000","#000000","#1874CD","#000000","#000000","#000000","#000000","#000000"],"shape":["square","square","dot","dot","dot","dot","dot","triangle","triangle","triangle","dot","dot","dot","dot","dot","triangle","dot","dot","dot","dot","dot"],"level":[7,1,5,5,5,5,3,1,1,1,4,4,4,4,6,2,3,5,5,5,5],"title":["knit(knitr_in(\"report.Rmd\"),&nbsp;file_out(\"report....","---<br>title: \"Final results report for the mtcars ex...<br>author: You<br>output: html_document<br>---<br><br># The weight and fuel efficiency of cars<br><br>Is there an association between the weight and...<br>...","suppressWarnings(summary(regression1_large))$c...","suppressWarnings(summary(regression1_small))$c...","suppressWarnings(summary(regression2_large))$c...","suppressWarnings(summary(regression2_small))$c...","simulate(64)","function&nbsp;(data,&nbsp;n)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;data[sample.int(n&nbsp;=&nbsp;nrow(data),&nbsp;size&nbsp;=&nbsp;n,&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br>}","function&nbsp;(d)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;lm(y&nbsp;~&nbsp;+x,&nbsp;data&nbsp;=&nbsp;d)<br>}","function&nbsp;(d)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;d$x2&nbsp;<-&nbsp;d$x^2<br>&nbsp;&nbsp;&nbsp;&nbsp;lm(y&nbsp;~&nbsp;x2,&nbsp;data&nbsp;=&nbsp;d)<br>}","reg1(large)","reg1(small)","reg2(large)","reg2(small)","knit(knitr_in(\"report.Rmd\"),&nbsp;file_out(\"report....","function&nbsp;(n)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;<-&nbsp;random_rows(data&nbsp;=&nbsp;mtcars,&nbsp;n&nbsp;=&nbsp;n)<br>&nbsp;&nbsp;&nbsp;&nbsp;data.frame(x&nbsp;=&nbsp;data$wt,&nbsp;y&nbsp;=&nbsp;data$mpg)<br>}","simulate(48)","suppressWarnings(summary(regression1_large$res...","suppressWarnings(summary(regression1_small$res...","suppressWarnings(summary(regression2_large$res...","suppressWarnings(summary(regression2_small$res..."],"x":[-1,-0.545454545454545,-0.272727272727273,0.272727272727273,0.0909090909090908,-0.636363636363636,-0.363636363636364,-0.363636363636364,0.909090909090909,0.0909090909090908,0.727272727272727,1,-0.181818181818182,0.363636363636364,-1,-0.363636363636364,0,0.454545454545455,0.636363636363636,-0.0909090909090909,0.818181818181818],"y":[1,-1,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,-0.333333333333333,-1,-1,-1,0,0,0,0,0.666666666666667,-0.666666666666667,-0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333]},"edges":{"from":["reg1","reg1","reg2","reg2","random_rows","\"report.Rmd\"","coef_regression2_small","large","large","large","small","small","small","report","simulate","simulate","regression1_small","regression1_small","regression1_large","regression1_large","regression2_small","regression2_small","regression2_large","regression2_large"],"to":["regression1_small","regression1_large","regression2_small","regression2_large","simulate","report","report","report","regression1_large","regression2_large","report","regression1_small","regression2_small","\"report.md\"","large","small","summ_regression1_small","coef_regression1_small","summ_regression1_large","coef_regression1_large","coef_regression2_small","summ_regression2_small","summ_regression2_large","coef_regression2_large"],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"smooth":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"layout":{"hierarchical":{"enabled":true,"direction":"LR"}},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"navigationButtons":true}},"groups":null,"width":"100%","height":"500px","idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)"},"main":{"text":"Dependency graph","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":false,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":true,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["Outdated","Imported","Object","Function","File"],"color":["#000000","#1874CD","#888888","#888888","#888888"],"shape":["dot","dot","dot","triangle","square"],"font.color":["black","black","black","black","black"],"font.size":[20,20,20,20,20],"id":[2,5,7,8,9]},"nodesToDataframe":true},"igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
<p>You can also check the dependencies of individual targets and imported functions.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">deps_code</span>(reg2)
## $globals
## [1] &quot;lm&quot;

<span class="kw">deps_code</span>(my_plan<span class="op">$</span>command[<span class="dv">1</span>]) <span class="co"># Files like report.Rmd are single-quoted.</span>
## $knitr_in
## [1] &quot;\&quot;report.Rmd\&quot;&quot;
## 
## $file_out
## [1] &quot;\&quot;report.md\&quot;&quot;
## 
## $readd
## [1] &quot;small&quot;                  &quot;coef_regression2_small&quot;
## 
## $globals
## [1] &quot;knit&quot;
## 
## $loadd
## [1] &quot;large&quot;

<span class="kw">deps_code</span>(my_plan<span class="op">$</span>command[<span class="kw">nrow</span>(my_plan)])
## $globals
## [1] &quot;suppressWarnings&quot;  &quot;summary&quot;           &quot;regression2_large&quot;</code></pre>
<p>List all the reproducibly-tracked objects and files.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tracked</span>(config)
##  [1] &quot;\&quot;report.md\&quot;&quot;          &quot;\&quot;report.Rmd\&quot;&quot;        
##  [3] &quot;coef_regression1_large&quot; &quot;coef_regression1_small&quot;
##  [5] &quot;coef_regression2_large&quot; &quot;coef_regression2_small&quot;
##  [7] &quot;large&quot;                  &quot;random_rows&quot;           
##  [9] &quot;reg1&quot;                   &quot;reg2&quot;                  
## [11] &quot;regression1_large&quot;      &quot;regression1_small&quot;     
## [13] &quot;regression2_large&quot;      &quot;regression2_small&quot;     
## [15] &quot;report&quot;                 &quot;simulate&quot;              
## [17] &quot;small&quot;                  &quot;summ_regression1_large&quot;
## [19] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;
## [21] &quot;summ_regression2_small&quot;</code></pre>
<p>Check for circular reasoning, missing input files, and other pitfalls.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">check_plan</span>(my_plan)</code></pre>
</div>
<div id="generate-the-workflow-plan" class="section level2">
<h2><span class="header-section-number">5.6</span> Generate the workflow plan</h2>
<p>The workflow plan data frame <code>my_plan</code> would be a pain to write by hand, so <code>drake</code> has functions to help you. Here are the commands to generate the bootstrapped datasets.</p>
<pre class="sourceCode r"><code class="sourceCode r">my_datasets &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(
  <span class="dt">small =</span> <span class="kw">simulate</span>(<span class="dv">48</span>),
  <span class="dt">large =</span> <span class="kw">simulate</span>(<span class="dv">64</span>))
my_datasets
## # A tibble: 2 x 2
##   target command     
##   &lt;chr&gt;  &lt;chr&gt;       
## 1 small  simulate(48)
## 2 large  simulate(64)</code></pre>
<p>For multiple replicates:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">expand_plan</span>(my_datasets, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;rep1&quot;</span>, <span class="st">&quot;rep2&quot;</span>))
## # A tibble: 4 x 2
##   target     command     
##   &lt;chr&gt;      &lt;chr&gt;       
## 1 small_rep1 simulate(48)
## 2 small_rep2 simulate(48)
## 3 large_rep1 simulate(64)
## 4 large_rep2 simulate(64)</code></pre>
<p>Here is a template for applying our regression models to our bootstrapped datasets.</p>
<pre class="sourceCode r"><code class="sourceCode r">methods &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(
  <span class="dt">regression1 =</span> <span class="kw">reg1</span>(dataset__),
  <span class="dt">regression2 =</span> <span class="kw">reg2</span>(dataset__))
methods
## # A tibble: 2 x 2
##   target      command        
##   &lt;chr&gt;       &lt;chr&gt;          
## 1 regression1 reg1(dataset__)
## 2 regression2 reg2(dataset__)</code></pre>
<p>We evaluate the <code>dataset__</code> wildcard to generate all the regression commands we need.</p>
<pre class="sourceCode r"><code class="sourceCode r">my_analyses &lt;-<span class="st"> </span><span class="kw">evaluate_plan</span>(
  methods, <span class="dt">wildcard =</span> <span class="st">&quot;dataset__&quot;</span>,
  <span class="dt">values =</span> my_datasets<span class="op">$</span>target
)
my_analyses
## # A tibble: 4 x 2
##   target            command    
##   &lt;chr&gt;             &lt;chr&gt;      
## 1 regression1_small reg1(small)
## 2 regression1_large reg1(large)
## 3 regression2_small reg2(small)
## 4 regression2_large reg2(large)</code></pre>
<p>Next, we summarize each analysis of each dataset. We calculate descriptive statistics on the residuals, and we collect the regression coefficients and their p-values.</p>
<pre class="sourceCode r"><code class="sourceCode r">summary_types &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(
  <span class="dt">summ =</span> <span class="kw">suppressWarnings</span>(<span class="kw">summary</span>(analysis__<span class="op">$</span>residuals)),
  <span class="dt">coef =</span> <span class="kw">suppressWarnings</span>(<span class="kw">summary</span>(analysis__))<span class="op">$</span>coefficients
)
summary_types
## # A tibble: 2 x 2
##   target command                                           
##   &lt;chr&gt;  &lt;chr&gt;                                             
## 1 summ   suppressWarnings(summary(analysis__$residuals))   
## 2 coef   suppressWarnings(summary(analysis__))$coefficients

my_summaries &lt;-<span class="st"> </span><span class="kw">evaluate_plan</span>(
  summary_types,
  <span class="dt">wildcard =</span> <span class="st">&quot;analysis__&quot;</span>,
  <span class="dt">values =</span> my_analyses<span class="op">$</span>target
)
my_summaries
## # A tibble: 8 x 2
##   target                command                                            
##   &lt;chr&gt;                 &lt;chr&gt;                                              
## 1 summ_regression1_sma… suppressWarnings(summary(regression1_small$residua…
## 2 summ_regression1_lar… suppressWarnings(summary(regression1_large$residua…
## 3 summ_regression2_sma… suppressWarnings(summary(regression2_small$residua…
## 4 summ_regression2_lar… suppressWarnings(summary(regression2_large$residua…
## 5 coef_regression1_sma… suppressWarnings(summary(regression1_small))$coeff…
## 6 coef_regression1_lar… suppressWarnings(summary(regression1_large))$coeff…
## 7 coef_regression2_sma… suppressWarnings(summary(regression2_small))$coeff…
## 8 coef_regression2_lar… suppressWarnings(summary(regression2_large))$coeff…</code></pre>
<p>For your <code>knitr</code> reports, use <code>knitr_in()</code> in your commands so that <code>report.Rmd</code> is a dependency and targets loaded with <code>loadd()</code> and <code>readd()</code> in active code chunks are also dependencies. Use <code>file_out()</code> to tell <code>drake</code> that the target is a file output. If the file is an output, you do not need to name the target. The target name will be the name of the output file in quotes.</p>
<pre class="sourceCode r"><code class="sourceCode r">report &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(
  <span class="dt">report =</span> <span class="kw">knit</span>(<span class="kw">knitr_in</span>(<span class="st">&quot;report.Rmd&quot;</span>), <span class="kw">file_out</span>(<span class="st">&quot;report.md&quot;</span>), <span class="dt">quiet =</span> <span class="ot">TRUE</span>)
)
report
## # A tibble: 1 x 2
##   target command                                                           
##   &lt;chr&gt;  &lt;chr&gt;                                                             
## 1 report &quot;knit(knitr_in(\&quot;report.Rmd\&quot;), file_out(\&quot;report.md\&quot;), quiet = …</code></pre>
<p>Finally, consolidate your workflow using <code>rbind()</code>. Row order does not matter.</p>
<pre class="sourceCode r"><code class="sourceCode r">my_plan &lt;-<span class="st"> </span><span class="kw">rbind</span>(report, my_datasets, my_analyses, my_summaries)
my_plan
## # A tibble: 15 x 2
##    target             command                                              
##    &lt;chr&gt;              &lt;chr&gt;                                                
##  1 report             &quot;knit(knitr_in(\&quot;report.Rmd\&quot;), file_out(\&quot;report.md…
##  2 small              simulate(48)                                         
##  3 large              simulate(64)                                         
##  4 regression1_small  reg1(small)                                          
##  5 regression1_large  reg1(large)                                          
##  6 regression2_small  reg2(small)                                          
##  7 regression2_large  reg2(large)                                          
##  8 summ_regression1_… suppressWarnings(summary(regression1_small$residuals…
##  9 summ_regression1_… suppressWarnings(summary(regression1_large$residuals…
## 10 summ_regression2_… suppressWarnings(summary(regression2_small$residuals…
## 11 summ_regression2_… suppressWarnings(summary(regression2_large$residuals…
## 12 coef_regression1_… suppressWarnings(summary(regression1_small))$coeffic…
## 13 coef_regression1_… suppressWarnings(summary(regression1_large))$coeffic…
## 14 coef_regression2_… suppressWarnings(summary(regression2_small))$coeffic…
## 15 coef_regression2_… suppressWarnings(summary(regression2_large))$coeffic…</code></pre>
</div>
<div id="run-the-workflow" class="section level2">
<h2><span class="header-section-number">5.7</span> Run the workflow</h2>
<p>You may want to check for outdated or missing targets/imports first.</p>
<pre class="sourceCode r"><code class="sourceCode r">config &lt;-<span class="st"> </span><span class="kw">drake_config</span>(my_plan, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
<span class="kw">outdated</span>(config) <span class="co"># Targets that need to be (re)built.</span>
##  [1] &quot;coef_regression1_large&quot; &quot;coef_regression1_small&quot;
##  [3] &quot;coef_regression2_large&quot; &quot;coef_regression2_small&quot;
##  [5] &quot;large&quot;                  &quot;regression1_large&quot;     
##  [7] &quot;regression1_small&quot;      &quot;regression2_large&quot;     
##  [9] &quot;regression2_small&quot;      &quot;report&quot;                
## [11] &quot;small&quot;                  &quot;summ_regression1_large&quot;
## [13] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;
## [15] &quot;summ_regression2_small&quot;

<span class="kw">missed</span>(config) <span class="co"># Checks your workspace.</span>
## character(0)</code></pre>
<p>Then just <code>make(my_plan)</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">make</span>(my_plan)
## target large
## target small
## target regression1_large
## target regression2_large
## target regression1_small
## target regression2_small
## target summ_regression1_large
## target coef_regression1_large
## target summ_regression2_large
## target coef_regression2_large
## target summ_regression1_small
## target coef_regression1_small
## target coef_regression2_small
## target summ_regression2_small
## target report</code></pre>
<p>For the <code>reg2()</code> model on the small dataset, the p-value on <code>x2</code> is so small that there may be an association between weight and fuel efficiency after all.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">readd</span>(coef_regression2_small)
##               Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept) 27.8369441 1.07966324 25.782988 5.443436e-29
## x2          -0.6359335 0.07138918 -8.907981 1.408597e-11</code></pre>
<p>The non-file dependencies of your last target are already loaded in your workspace.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ls</span>()
##  [1] &quot;combos&quot;             &quot;config&quot;             &quot;create_plot&quot;       
##  [4] &quot;data_plan&quot;          &quot;fit_gsp_model&quot;      &quot;get_logs&quot;          
##  [7] &quot;get_rmspe&quot;          &quot;hist&quot;               &quot;latest_log_date&quot;   
## [10] &quot;make_my_plot&quot;       &quot;make_my_table&quot;      &quot;methods&quot;           
## [13] &quot;model_plan&quot;         &quot;my_analyses&quot;        &quot;my_datasets&quot;       
## [16] &quot;my_plan&quot;            &quot;my_summaries&quot;       &quot;output_plan&quot;       
## [19] &quot;output_types&quot;       &quot;package_list&quot;       &quot;plan&quot;              
## [22] &quot;plot_rmspe&quot;         &quot;predictors&quot;         &quot;Produc&quot;            
## [25] &quot;random_rows&quot;        &quot;reg1&quot;               &quot;reg2&quot;              
## [28] &quot;report_plan&quot;        &quot;results&quot;            &quot;rmspe_args&quot;        
## [31] &quot;rmspe_plan&quot;         &quot;rmspe_results_plan&quot; &quot;simulate&quot;          
## [34] &quot;summary_types&quot;      &quot;url&quot;                &quot;whole_plan&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">outdated</span>(config) <span class="co"># Everything is up to date.</span>
## character(0)

<span class="kw">build_times</span>(<span class="dt">digits =</span> <span class="dv">4</span>) <span class="co"># How long did it take to make each target?</span>
## # A tibble: 21 x 5
##    item                   type   elapsed        user          system       
##  * &lt;chr&gt;                  &lt;chr&gt;  &lt;S4: Duration&gt; &lt;S4: Duratio&gt; &lt;S4: Duratio&gt;
##  1 &quot;\&quot;report.md\&quot;&quot;        target 0.087s         0.088s        0s           
##  2 &quot;\&quot;report.Rmd\&quot;&quot;       import 0.001s         0.004s        0s           
##  3 coef_regression1_large target 0.005s         0.008s        0s           
##  4 coef_regression1_small target 0.005s         0.004s        0s           
##  5 coef_regression2_large target 0.006s         0.004s        0s           
##  6 coef_regression2_small target 0.004s         0.004s        0s           
##  7 large                  target 0.006s         0.004s        0.004s       
##  8 random_rows            import 0.002s         0s            0s           
##  9 reg1                   import 0.002s         0s            0s           
## 10 reg2                   import 0.002s         0.004s        0s           
## # ... with 11 more rows</code></pre>
<p>See also <code>predict_runtime()</code> and <code>rate_limiting_times()</code>.</p>
<p>In the new graph, the black nodes from before are now green.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Hover, click, drag, zoom, and explore.</span>
<span class="kw">vis_drake_graph</span>(config, <span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>, <span class="dt">height =</span> <span class="st">&quot;500px&quot;</span>)</code></pre>
<div id="htmlwidget-86e259a3bc4931fa8aec" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-86e259a3bc4931fa8aec">{"x":{"nodes":{"id":["\"report.md\"","\"report.Rmd\"","coef_regression1_large","coef_regression1_small","coef_regression2_large","coef_regression2_small","large","random_rows","reg1","reg2","regression1_large","regression1_small","regression2_large","regression2_small","report","simulate","small","summ_regression1_large","summ_regression1_small","summ_regression2_large","summ_regression2_small"],"label":["\"report.md\"\n0.002s","\"report.Rmd\"\n0.002s","coef_regression1_large\n0.005s","coef_regression1_small\n0.005s","coef_regression2_large\n0.006s","coef_regression2_small\n0.004s","large\n0.006s","random_rows\n0.002s","reg1\n0.001s","reg2\n0.001s","regression1_large\n0.006s","regression1_small\n0.009s","regression2_large\n0.007s","regression2_small\n0.01s","report\n0.092s","simulate\n0.002s","small\n0.015s","summ_regression1_large\n0.005s","summ_regression1_small\n0.005s","summ_regression2_large\n0.006s","summ_regression2_small\n0.005s"],"command":["knit(knitr_in(\"report.Rmd\"), file_out(\"report.md\"), quiet = TRUE)",null,"suppressWarnings(summary(regression1_large))$coefficients","suppressWarnings(summary(regression1_small))$coefficients","suppressWarnings(summary(regression2_large))$coefficients","suppressWarnings(summary(regression2_small))$coefficients","simulate(64)",null,null,null,"reg1(large)","reg1(small)","reg2(large)","reg2(small)","knit(knitr_in(\"report.Rmd\"), file_out(\"report.md\"), quiet = TRUE)",null,"simulate(48)","suppressWarnings(summary(regression1_large$residuals))","suppressWarnings(summary(regression1_small$residuals))","suppressWarnings(summary(regression2_large$residuals))","suppressWarnings(summary(regression2_small$residuals))"],"status":["up to date","imported","up to date","up to date","up to date","up to date","up to date","imported","imported","imported","up to date","up to date","up to date","up to date","up to date","imported","up to date","up to date","up to date","up to date","up to date"],"type":["object","file","object","object","object","object","object","function","function","function","object","object","object","object","object","function","object","object","object","object","object"],"font.size":[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],"color":["#228B22","#1874CD","#228B22","#228B22","#228B22","#228B22","#228B22","#1874CD","#1874CD","#1874CD","#228B22","#228B22","#228B22","#228B22","#228B22","#1874CD","#228B22","#228B22","#228B22","#228B22","#228B22"],"shape":["square","square","dot","dot","dot","dot","dot","triangle","triangle","triangle","dot","dot","dot","dot","dot","triangle","dot","dot","dot","dot","dot"],"level":[7,1,5,5,5,5,3,1,1,1,4,4,4,4,6,2,3,5,5,5,5],"title":["knit(knitr_in(\"report.Rmd\"),&nbsp;file_out(\"report....","---<br>title: \"Final results report for the mtcars ex...<br>author: You<br>output: html_document<br>---<br><br># The weight and fuel efficiency of cars<br><br>Is there an association between the weight and...<br>...","suppressWarnings(summary(regression1_large))$c...","suppressWarnings(summary(regression1_small))$c...","suppressWarnings(summary(regression2_large))$c...","suppressWarnings(summary(regression2_small))$c...","simulate(64)","function&nbsp;(data,&nbsp;n)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;data[sample.int(n&nbsp;=&nbsp;nrow(data),&nbsp;size&nbsp;=&nbsp;n,&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br>}","function&nbsp;(d)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;lm(y&nbsp;~&nbsp;+x,&nbsp;data&nbsp;=&nbsp;d)<br>}","function&nbsp;(d)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;d$x2&nbsp;<-&nbsp;d$x^2<br>&nbsp;&nbsp;&nbsp;&nbsp;lm(y&nbsp;~&nbsp;x2,&nbsp;data&nbsp;=&nbsp;d)<br>}","reg1(large)","reg1(small)","reg2(large)","reg2(small)","knit(knitr_in(\"report.Rmd\"),&nbsp;file_out(\"report....","function&nbsp;(n)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;<-&nbsp;random_rows(data&nbsp;=&nbsp;mtcars,&nbsp;n&nbsp;=&nbsp;n)<br>&nbsp;&nbsp;&nbsp;&nbsp;data.frame(x&nbsp;=&nbsp;data$wt,&nbsp;y&nbsp;=&nbsp;data$mpg)<br>}","simulate(48)","suppressWarnings(summary(regression1_large$res...","suppressWarnings(summary(regression1_small$res...","suppressWarnings(summary(regression2_large$res...","suppressWarnings(summary(regression2_small$res..."],"x":[-1,-0.545454545454545,-0.272727272727273,0.272727272727273,0.0909090909090908,-0.636363636363636,-0.363636363636364,-0.363636363636364,0.909090909090909,0.0909090909090908,0.727272727272727,1,-0.181818181818182,0.363636363636364,-1,-0.363636363636364,0,0.454545454545455,0.636363636363636,-0.0909090909090909,0.818181818181818],"y":[1,-1,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,-0.333333333333333,-1,-1,-1,0,0,0,0,0.666666666666667,-0.666666666666667,-0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333]},"edges":{"from":["random_rows","reg1","reg1","reg2","reg2","\"report.Rmd\"","coef_regression2_small","large","large","large","small","small","small","report","simulate","simulate","regression1_small","regression1_small","regression1_large","regression1_large","regression2_small","regression2_small","regression2_large","regression2_large"],"to":["simulate","regression1_small","regression1_large","regression2_small","regression2_large","report","report","report","regression1_large","regression2_large","report","regression1_small","regression2_small","\"report.md\"","large","small","summ_regression1_small","coef_regression1_small","summ_regression1_large","coef_regression1_large","coef_regression2_small","summ_regression2_small","summ_regression2_large","coef_regression2_large"],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"smooth":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"layout":{"hierarchical":{"enabled":true,"direction":"LR"}},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"navigationButtons":true}},"groups":null,"width":"100%","height":"500px","idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)"},"main":{"text":"Dependency graph","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":false,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":true,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["Up to date","Imported","Object","Function","File"],"color":["#228B22","#1874CD","#888888","#888888","#888888"],"shape":["dot","dot","dot","triangle","square"],"font.color":["black","black","black","black","black"],"font.size":[20,20,20,20,20],"id":[1,5,7,8,9]},"nodesToDataframe":true},"igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
<p>Optionally, get <a href="http://datastorm-open.github.io/visNetwork/">visNetwork</a> nodes and edges so you can make your own plot with <code>visNetwork()</code> or <code>render_drake_graph()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">drake_graph_info</span>(config)</code></pre>
<p>Use <code>readd()</code> and <code>loadd()</code> to load targets into your workspace. (They are cached in the hidden <code>.drake/</code> folder using <a href="https://CRAN.R-project.org/package=storr">storr</a>). There are many more functions for interacting with the cache.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">readd</span>(coef_regression2_large)
##               Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept) 27.7764504 0.85871209  32.34664 1.569624e-40
## x2          -0.7056179 0.06942808 -10.16329 7.950479e-15

<span class="kw">loadd</span>(small)

<span class="kw">head</span>(small)
##       x    y
## 1 5.424 10.4
## 2 3.440 17.8
## 3 3.440 19.2
## 4 3.170 15.8
## 5 3.730 17.3
## 6 3.845 19.2

<span class="kw">rm</span>(small)
<span class="kw">cached</span>(small, large)
## small large 
##  TRUE  TRUE

<span class="kw">cached</span>()
##  [1] &quot;\&quot;report.md\&quot;&quot;          &quot;\&quot;report.Rmd\&quot;&quot;        
##  [3] &quot;coef_regression1_large&quot; &quot;coef_regression1_small&quot;
##  [5] &quot;coef_regression2_large&quot; &quot;coef_regression2_small&quot;
##  [7] &quot;large&quot;                  &quot;random_rows&quot;           
##  [9] &quot;reg1&quot;                   &quot;reg2&quot;                  
## [11] &quot;regression1_large&quot;      &quot;regression1_small&quot;     
## [13] &quot;regression2_large&quot;      &quot;regression2_small&quot;     
## [15] &quot;report&quot;                 &quot;simulate&quot;              
## [17] &quot;small&quot;                  &quot;summ_regression1_large&quot;
## [19] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;
## [21] &quot;summ_regression2_small&quot;

<span class="kw">built</span>()
##  [1] &quot;coef_regression1_large&quot; &quot;coef_regression1_small&quot;
##  [3] &quot;coef_regression2_large&quot; &quot;coef_regression2_small&quot;
##  [5] &quot;large&quot;                  &quot;regression1_large&quot;     
##  [7] &quot;regression1_small&quot;      &quot;regression2_large&quot;     
##  [9] &quot;regression2_small&quot;      &quot;report&quot;                
## [11] &quot;small&quot;                  &quot;summ_regression1_large&quot;
## [13] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;
## [15] &quot;summ_regression2_small&quot;

<span class="kw">imported</span>()
## [1] &quot;\&quot;report.md\&quot;&quot;  &quot;\&quot;report.Rmd\&quot;&quot; &quot;random_rows&quot;    &quot;reg1&quot;          
## [5] &quot;reg2&quot;           &quot;simulate&quot;

<span class="kw">head</span>(<span class="kw">read_drake_plan</span>())
## # A tibble: 6 x 2
##   target          command                                                  
##   &lt;chr&gt;           &lt;chr&gt;                                                    
## 1 report          &quot;knit(knitr_in(\&quot;report.Rmd\&quot;), file_out(\&quot;report.md\&quot;),…
## 2 small           simulate(48)                                             
## 3 large           simulate(64)                                             
## 4 regression1_sm… reg1(small)                                              
## 5 regression1_la… reg1(large)                                              
## 6 regression2_sm… reg2(small)

<span class="kw">head</span>(<span class="kw">progress</span>()) <span class="co"># See also in_progress()</span>
## $method
## NULL
## 
## $url
## NULL
## 
## $headers
## NULL
## 
## $fields
## NULL
## 
## $options
## $options$noprogress
## [1] FALSE
## 
## $options$progressfunction
## function (down, up) 
## {
##     if (type == &quot;down&quot;) {
##         total &lt;- down[[1]]
##         now &lt;- down[[2]]
##     }
##     else {
##         total &lt;- up[[1]]
##         now &lt;- up[[2]]
##     }
##     if (total == 0 &amp;&amp; now == 0) {
##         bar &lt;&lt;- NULL
##     }
##     else if (total == 0) {
##         cat(&quot;\rDownloading: &quot;, bytes(now, digits = 2), &quot;     &quot;, 
##             sep = &quot;&quot;, file = con)
##         utils::flush.console()
##     }
##     else {
##         if (is.null(bar)) {
##             bar &lt;&lt;- utils::txtProgressBar(max = total, style = 3, 
##                 file = con)
##         }
##         utils::setTxtProgressBar(bar, now)
##         if (now == total) 
##             close(bar)
##     }
##     TRUE
## }
## &lt;bytecode: 0xc1b3788&gt;
## &lt;environment: 0xc173288&gt;
## 
## 
## $auth_token
## NULL

<span class="kw">progress</span>(large)
## Error in match.arg(type): object &#39;large&#39; not found

<span class="co"># drake_session() # sessionInfo() of the last make() # nolint</span></code></pre>
<p>The next time you run <code>make(my_plan)</code>, nothing will build because <code>drake</code> knows everything is already up to date.</p>
<pre class="sourceCode r"><code class="sourceCode r">config &lt;-<span class="st"> </span><span class="kw">make</span>(my_plan) <span class="co"># Will use config later. See also drake_config().</span>
## All targets are already up to date.</code></pre>
<p>But if you change one of your functions, commands, or other dependencies, drake will update the affected targets. Suppose we change the quadratic term to a cubic term in <code>reg2()</code>. We might want to do this if we suspect a cubic relationship between tons and miles per gallon.</p>
<pre class="sourceCode r"><code class="sourceCode r">reg2 &lt;-<span class="st"> </span><span class="cf">function</span>(d) {
  d<span class="op">$</span>x3 &lt;-<span class="st"> </span>d<span class="op">$</span>x <span class="op">^</span><span class="st"> </span><span class="dv">3</span>
  <span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x3, <span class="dt">data =</span> d)
}</code></pre>
<p>The targets that depend on <code>reg2()</code> need to be rebuilt.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">outdated</span>(config)
## [1] &quot;coef_regression2_large&quot; &quot;coef_regression2_small&quot;
## [3] &quot;regression2_large&quot;      &quot;regression2_small&quot;     
## [5] &quot;report&quot;                 &quot;summ_regression2_large&quot;
## [7] &quot;summ_regression2_small&quot;</code></pre>
<p><strong>Advanced</strong>: To get a rough idea of why a target is out of date, you can use <code>dependency_profile()</code>. It will tell you if any of the following changed since the last <code>make()</code>:</p>
<ul>
<li>The command in the workflow plan data frame.</li>
<li>At least one non-file dependency. (For this, the imports have to be up to date and cached, either with <code>make()</code>, <code>make(skip_targets = TRUE)</code>, <code>outdated()</code>, or similar.)</li>
<li>At least one input file declared with <code>file_in()</code> or <code>knitr_in()</code>.</li>
<li>At least one output file declared with <code>file_out()</code>.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dependency_profile</span>(<span class="dt">target =</span> regression2_small, <span class="dt">config =</span> config)
## # A tibble: 4 x 4
##   hash     changed old_hash         new_hash        
##   &lt;chr&gt;    &lt;lgl&gt;   &lt;chr&gt;            &lt;chr&gt;           
## 1 command  FALSE   db5d8703de0d0cc0 db5d8703de0d0cc0
## 2 depend   TRUE    092c0d29540462b9 e591488c25e813fa
## 3 file_in  FALSE   ef46db3751d8e999 ef46db3751d8e999
## 4 file_out FALSE   ef46db3751d8e999 ef46db3751d8e999</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Hover, click, drag, zoom, and explore.</span>
<span class="kw">vis_drake_graph</span>(config, <span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>, <span class="dt">height =</span> <span class="st">&quot;500px&quot;</span>)</code></pre>
<div id="htmlwidget-3f5f98c0b8782d1c9daa" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-3f5f98c0b8782d1c9daa">{"x":{"nodes":{"id":["\"report.md\"","\"report.Rmd\"","coef_regression1_large","coef_regression1_small","coef_regression2_large","coef_regression2_small","large","random_rows","reg1","reg2","regression1_large","regression1_small","regression2_large","regression2_small","report","simulate","small","summ_regression1_large","summ_regression1_small","summ_regression2_large","summ_regression2_small"],"label":["\"report.md\"\n0.002s","\"report.Rmd\"\n0.002s","coef_regression1_large\n0.005s","coef_regression1_small\n0.005s","coef_regression2_large\n0.006s","coef_regression2_small\n0.004s","large\n0.006s","random_rows\n0.003s","reg1\n0.002s","reg2\n0.002s","regression1_large\n0.006s","regression1_small\n0.009s","regression2_large\n0.007s","regression2_small\n0.01s","report\n0.092s","simulate\n0.002s","small\n0.015s","summ_regression1_large\n0.005s","summ_regression1_small\n0.005s","summ_regression2_large\n0.006s","summ_regression2_small\n0.005s"],"command":["knit(knitr_in(\"report.Rmd\"), file_out(\"report.md\"), quiet = TRUE)",null,"suppressWarnings(summary(regression1_large))$coefficients","suppressWarnings(summary(regression1_small))$coefficients","suppressWarnings(summary(regression2_large))$coefficients","suppressWarnings(summary(regression2_small))$coefficients","simulate(64)",null,null,null,"reg1(large)","reg1(small)","reg2(large)","reg2(small)","knit(knitr_in(\"report.Rmd\"), file_out(\"report.md\"), quiet = TRUE)",null,"simulate(48)","suppressWarnings(summary(regression1_large$residuals))","suppressWarnings(summary(regression1_small$residuals))","suppressWarnings(summary(regression2_large$residuals))","suppressWarnings(summary(regression2_small$residuals))"],"status":["outdated","imported","up to date","up to date","outdated","outdated","up to date","imported","imported","imported","up to date","up to date","outdated","outdated","outdated","imported","up to date","up to date","up to date","outdated","outdated"],"type":["object","file","object","object","object","object","object","function","function","function","object","object","object","object","object","function","object","object","object","object","object"],"font.size":[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],"color":["#000000","#1874CD","#228B22","#228B22","#000000","#000000","#228B22","#1874CD","#1874CD","#1874CD","#228B22","#228B22","#000000","#000000","#000000","#1874CD","#228B22","#228B22","#228B22","#000000","#000000"],"shape":["square","square","dot","dot","dot","dot","dot","triangle","triangle","triangle","dot","dot","dot","dot","dot","triangle","dot","dot","dot","dot","dot"],"level":[7,1,5,5,5,5,3,1,1,1,4,4,4,4,6,2,3,5,5,5,5],"title":["knit(knitr_in(\"report.Rmd\"),&nbsp;file_out(\"report....","---<br>title: \"Final results report for the mtcars ex...<br>author: You<br>output: html_document<br>---<br><br># The weight and fuel efficiency of cars<br><br>Is there an association between the weight and...<br>...","suppressWarnings(summary(regression1_large))$c...","suppressWarnings(summary(regression1_small))$c...","suppressWarnings(summary(regression2_large))$c...","suppressWarnings(summary(regression2_small))$c...","simulate(64)","function&nbsp;(data,&nbsp;n)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;data[sample.int(n&nbsp;=&nbsp;nrow(data),&nbsp;size&nbsp;=&nbsp;n,&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br>}","function&nbsp;(d)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;lm(y&nbsp;~&nbsp;+x,&nbsp;data&nbsp;=&nbsp;d)<br>}","function&nbsp;(d)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;d$x3&nbsp;<-&nbsp;d$x^3<br>&nbsp;&nbsp;&nbsp;&nbsp;lm(y&nbsp;~&nbsp;x3,&nbsp;data&nbsp;=&nbsp;d)<br>}","reg1(large)","reg1(small)","reg2(large)","reg2(small)","knit(knitr_in(\"report.Rmd\"),&nbsp;file_out(\"report....","function&nbsp;(n)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;<-&nbsp;random_rows(data&nbsp;=&nbsp;mtcars,&nbsp;n&nbsp;=&nbsp;n)<br>&nbsp;&nbsp;&nbsp;&nbsp;data.frame(x&nbsp;=&nbsp;data$wt,&nbsp;y&nbsp;=&nbsp;data$mpg)<br>}","simulate(48)","suppressWarnings(summary(regression1_large$res...","suppressWarnings(summary(regression1_small$res...","suppressWarnings(summary(regression2_large$res...","suppressWarnings(summary(regression2_small$res..."],"x":[-1,-0.545454545454545,-0.272727272727273,0.272727272727273,0.0909090909090908,-0.636363636363636,-0.363636363636364,-0.363636363636364,0.909090909090909,0.0909090909090908,0.727272727272727,1,-0.181818181818182,0.363636363636364,-1,-0.363636363636364,0,0.454545454545455,0.636363636363636,-0.0909090909090909,0.818181818181818],"y":[1,-1,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,-0.333333333333333,-1,-1,-1,0,0,0,0,0.666666666666667,-0.666666666666667,-0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333]},"edges":{"from":["random_rows","reg1","reg1","reg2","reg2","\"report.Rmd\"","coef_regression2_small","large","large","large","small","small","small","report","simulate","simulate","regression1_small","regression1_small","regression1_large","regression1_large","regression2_small","regression2_small","regression2_large","regression2_large"],"to":["simulate","regression1_small","regression1_large","regression2_small","regression2_large","report","report","report","regression1_large","regression2_large","report","regression1_small","regression2_small","\"report.md\"","large","small","summ_regression1_small","coef_regression1_small","summ_regression1_large","coef_regression1_large","coef_regression2_small","summ_regression2_small","summ_regression2_large","coef_regression2_large"],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"smooth":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"layout":{"hierarchical":{"enabled":true,"direction":"LR"}},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"navigationButtons":true}},"groups":null,"width":"100%","height":"500px","idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)"},"main":{"text":"Dependency graph","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":false,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":true,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["Up to date","Outdated","Imported","Object","Function","File"],"color":["#228B22","#000000","#1874CD","#888888","#888888","#888888"],"shape":["dot","dot","dot","dot","triangle","square"],"font.color":["black","black","black","black","black","black"],"font.size":[20,20,20,20,20,20],"id":[1,2,5,7,8,9]},"nodesToDataframe":true},"igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
<p>The next <code>make()</code> will rebuild the targets depending on <code>reg2()</code> and leave everything else alone.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">make</span>(my_plan)
## target regression2_large
## target regression2_small
## target summ_regression2_large
## target coef_regression2_large
## target coef_regression2_small
## target summ_regression2_small
## target report</code></pre>
<p>Trivial changes to whitespace and comments are totally ignored.</p>
<pre class="sourceCode r"><code class="sourceCode r">reg2 &lt;-<span class="st"> </span><span class="cf">function</span>(d) {
  d<span class="op">$</span>x3 &lt;-<span class="st"> </span>d<span class="op">$</span>x <span class="op">^</span><span class="st"> </span><span class="dv">3</span>
    <span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x3, <span class="dt">data =</span> d) <span class="co"># I indented here.</span>
}
<span class="kw">outdated</span>(config) <span class="co"># Everything is up to date.</span>
## character(0)</code></pre>
<p>drake cares about nested functions too: nontrivial changes to <code>random_rows()</code> will propagate to <code>simulate()</code> and all the downstream targets.</p>
<pre class="sourceCode r"><code class="sourceCode r">random_rows &lt;-<span class="st"> </span><span class="cf">function</span>(data, n){
  n &lt;-<span class="st"> </span>n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
  data[<span class="kw">sample.int</span>(<span class="dt">n =</span> <span class="kw">nrow</span>(data), <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>), ]
}

<span class="kw">outdated</span>(config)
##  [1] &quot;coef_regression1_large&quot; &quot;coef_regression1_small&quot;
##  [3] &quot;coef_regression2_large&quot; &quot;coef_regression2_small&quot;
##  [5] &quot;large&quot;                  &quot;regression1_large&quot;     
##  [7] &quot;regression1_small&quot;      &quot;regression2_large&quot;     
##  [9] &quot;regression2_small&quot;      &quot;report&quot;                
## [11] &quot;small&quot;                  &quot;summ_regression1_large&quot;
## [13] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;
## [15] &quot;summ_regression2_small&quot;

<span class="kw">make</span>(my_plan)
## target large
## target small
## target regression1_large
## target regression2_large
## target regression1_small
## target regression2_small
## target summ_regression1_large
## target coef_regression1_large
## target summ_regression2_large
## target coef_regression2_large
## target summ_regression1_small
## target coef_regression1_small
## target coef_regression2_small
## target summ_regression2_small
## target report</code></pre>
<p>Need to add new work on the fly? Just append rows to the workflow plan. If the rest of your workflow is up to date, only the new work is run.</p>
<pre class="sourceCode r"><code class="sourceCode r">new_simulation &lt;-<span class="st"> </span><span class="cf">function</span>(n){
  <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">rnorm</span>(n), <span class="dt">y =</span> <span class="kw">rnorm</span>(n))
}

additions &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(
  <span class="dt">new_data =</span> <span class="kw">new_simulation</span>(<span class="dv">36</span>) <span class="op">+</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">10</span>))
additions
## # A tibble: 1 x 2
##   target   command                      
##   &lt;chr&gt;    &lt;chr&gt;                        
## 1 new_data new_simulation(36) + sqrt(10)

my_plan &lt;-<span class="st"> </span><span class="kw">rbind</span>(my_plan, additions)
my_plan
## # A tibble: 16 x 2
##    target             command                                              
##    &lt;chr&gt;              &lt;chr&gt;                                                
##  1 report             &quot;knit(knitr_in(\&quot;report.Rmd\&quot;), file_out(\&quot;report.md…
##  2 small              simulate(48)                                         
##  3 large              simulate(64)                                         
##  4 regression1_small  reg1(small)                                          
##  5 regression1_large  reg1(large)                                          
##  6 regression2_small  reg2(small)                                          
##  7 regression2_large  reg2(large)                                          
##  8 summ_regression1_… suppressWarnings(summary(regression1_small$residuals…
##  9 summ_regression1_… suppressWarnings(summary(regression1_large$residuals…
## 10 summ_regression2_… suppressWarnings(summary(regression2_small$residuals…
## 11 summ_regression2_… suppressWarnings(summary(regression2_large$residuals…
## 12 coef_regression1_… suppressWarnings(summary(regression1_small))$coeffic…
## 13 coef_regression1_… suppressWarnings(summary(regression1_large))$coeffic…
## 14 coef_regression2_… suppressWarnings(summary(regression2_small))$coeffic…
## 15 coef_regression2_… suppressWarnings(summary(regression2_large))$coeffic…
## 16 new_data           new_simulation(36) + sqrt(10)

<span class="kw">make</span>(my_plan)
## target new_data</code></pre>
<p>If you ever need to erase your work, use <code>clean()</code>. The next <code>make()</code> will rebuild any cleaned targets, so be careful. You may notice that by default, the size of the cache does not go down very much. To purge old data, you could use <code>clean(garbage_collection = TRUE, purge = TRUE)</code>. To do garbage collection without removing any important targets, use <code>drake_gc()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Uncaches individual targets and imported objects.</span>
<span class="kw">clean</span>(small, reg1, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
<span class="kw">clean</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) <span class="co"># Cleans all targets out of the cache.</span>
<span class="kw">drake_gc</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) <span class="co"># Just garbage collection.</span>
<span class="kw">clean</span>(<span class="dt">destroy =</span> <span class="ot">TRUE</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>) <span class="co"># removes the cache entirely</span></code></pre>

</div>
</div>



</div>
<div style = "background: #1C356D; color: white; padding: 10px 10px 10px 25px; font-size: 1em; width: 100%;">
  Copyright Eli Lilly and Company
</div>
            </section>

          </div>
        </div>
      </div>
<a href="gsp.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plans.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
