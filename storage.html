<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 15 Storage | The drake R Package User Manual</title>
  <meta name="description" content="In-depth walkthroughs and examples of drake, an R package for reproducible computation at scale." />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 15 Storage | The drake R Package User Manual" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://ropenscilabs.github.io/drake-manual" />
  <meta property="og:image" content="https://ropenscilabs.github.io/drake-manual/images/logo.png" />
  <meta property="og:description" content="In-depth walkthroughs and examples of drake, an R package for reproducible computation at scale." />
  <meta name="github-repo" content="ropenscilabs/drake-manual" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 Storage | The drake R Package User Manual" />
  
  <meta name="twitter:description" content="In-depth walkthroughs and examples of drake, an R package for reproducible computation at scale." />
  <meta name="twitter:image" content="https://ropenscilabs.github.io/drake-manual/images/logo.png" />

<meta name="author" content="Will Landau, Kirill MÃ¼ller, Alex Axthelm, Jasper Clarkberg, Lorenz Walthert, Ellis Hughes, Matthew Mark Strasiotto" />
<meta name="author" content="Copyright Eli Lilly and Company" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="images/apple-touch-icon.png" />
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="memory.html"/>
<link rel="next" href="visuals.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.8/visNetwork.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/sankey-1/sankey.js"></script>
<script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150843595-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-150843595-1');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="https://ropensci.github.io/dev_guide/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The drake R Package User Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#short-version"><i class="fa fa-check"></i><b>1.1</b> Short version</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#long-version"><i class="fa fa-check"></i><b>1.2</b> Long version</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#the-drake-r-package"><i class="fa fa-check"></i><b>1.3</b> The drake R package</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.4</b> Installation</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#why-drake"><i class="fa fa-check"></i><b>1.5</b> Why drake?</a><ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#what-gets-done-stays-done."><i class="fa fa-check"></i><b>1.5.1</b> What gets done stays done.</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#reproducibility-with-confidence"><i class="fa fa-check"></i><b>1.5.2</b> Reproducibility with confidence</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#scale-up-and-out."><i class="fa fa-check"></i><b>1.5.3</b> Scale up and out.</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#with-docker"><i class="fa fa-check"></i><b>1.6</b> With Docker</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#documentation"><i class="fa fa-check"></i><b>1.7</b> Documentation</a><ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#frequently-asked-questions"><i class="fa fa-check"></i><b>1.7.1</b> Frequently asked questions</a></li>
<li class="chapter" data-level="1.7.2" data-path="index.html"><a href="index.html#function-reference"><i class="fa fa-check"></i><b>1.7.2</b> Function reference</a></li>
<li class="chapter" data-level="1.7.3" data-path="index.html"><a href="index.html#tutorials"><i class="fa fa-check"></i><b>1.7.3</b> Tutorials</a></li>
<li class="chapter" data-level="1.7.4" data-path="index.html"><a href="index.html#examples"><i class="fa fa-check"></i><b>1.7.4</b> Examples</a></li>
<li class="chapter" data-level="1.7.5" data-path="index.html"><a href="index.html#presentations"><i class="fa fa-check"></i><b>1.7.5</b> Presentations</a></li>
<li class="chapter" data-level="1.7.6" data-path="index.html"><a href="index.html#context-and-history"><i class="fa fa-check"></i><b>1.7.6</b> Context and history</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#help-and-troubleshooting"><i class="fa fa-check"></i><b>1.8</b> Help and troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="similar-work.html"><a href="similar-work.html"><i class="fa fa-check"></i><b>2</b> Similar work</a><ul>
<li class="chapter" data-level="2.1" data-path="similar-work.html"><a href="similar-work.html#pipeline-tools"><i class="fa fa-check"></i><b>2.1</b> Pipeline tools</a><ul>
<li class="chapter" data-level="2.1.1" data-path="similar-work.html"><a href="similar-work.html#gnu-make"><i class="fa fa-check"></i><b>2.1.1</b> GNU Make</a></li>
<li class="chapter" data-level="2.1.2" data-path="similar-work.html"><a href="similar-work.html#remake"><i class="fa fa-check"></i><b>2.1.2</b> Remake</a></li>
<li class="chapter" data-level="2.1.3" data-path="similar-work.html"><a href="similar-work.html#factuals-drake"><i class="fa fa-check"></i><b>2.1.3</b> Factualâs Drake</a></li>
<li class="chapter" data-level="2.1.4" data-path="similar-work.html"><a href="similar-work.html#other-pipeline-tools"><i class="fa fa-check"></i><b>2.1.4</b> Other pipeline tools</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="similar-work.html"><a href="similar-work.html#memoization"><i class="fa fa-check"></i><b>2.2</b> Memoization</a></li>
<li class="chapter" data-level="2.3" data-path="similar-work.html"><a href="similar-work.html#literate-programming"><i class="fa fa-check"></i><b>2.3</b> Literate programming</a><ul>
<li class="chapter" data-level="2.3.1" data-path="similar-work.html"><a href="similar-work.html#knitr-and-r-markdown"><i class="fa fa-check"></i><b>2.3.1</b> knitr and R Markdown</a></li>
<li class="chapter" data-level="2.3.2" data-path="similar-work.html"><a href="similar-work.html#version-control"><i class="fa fa-check"></i><b>2.3.2</b> Version control</a></li>
<li class="chapter" data-level="2.3.3" data-path="similar-work.html"><a href="similar-work.html#containerization-and-r-package-environments"><i class="fa fa-check"></i><b>2.3.3</b> Containerization and R package environments</a></li>
<li class="chapter" data-level="2.3.4" data-path="similar-work.html"><a href="similar-work.html#workflowr"><i class="fa fa-check"></i><b>2.3.4</b> workflowr</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="similar-work.html"><a href="similar-work.html#acknowledgements"><i class="fa fa-check"></i><b>2.4</b> Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>I Getting started</b></span></li>
<li class="chapter" data-level="3" data-path="walkthrough.html"><a href="walkthrough.html"><i class="fa fa-check"></i><b>3</b> Walkthrough</a><ul>
<li class="chapter" data-level="3.1" data-path="walkthrough.html"><a href="walkthrough.html#set-the-stage."><i class="fa fa-check"></i><b>3.1</b> Set the stage.</a></li>
<li class="chapter" data-level="3.2" data-path="walkthrough.html"><a href="walkthrough.html#make-your-results."><i class="fa fa-check"></i><b>3.2</b> Make your results.</a></li>
<li class="chapter" data-level="3.3" data-path="walkthrough.html"><a href="walkthrough.html#go-back-and-fix-things."><i class="fa fa-check"></i><b>3.3</b> Go back and fix things.</a></li>
<li class="chapter" data-level="3.4" data-path="walkthrough.html"><a href="walkthrough.html#history-and-provenance"><i class="fa fa-check"></i><b>3.4</b> History and provenance</a></li>
<li class="chapter" data-level="3.5" data-path="walkthrough.html"><a href="walkthrough.html#reproducible-data-recovery-and-renaming"><i class="fa fa-check"></i><b>3.5</b> Reproducible data recovery and renaming</a><ul>
<li class="chapter" data-level="3.5.1" data-path="walkthrough.html"><a href="walkthrough.html#undoing-clean"><i class="fa fa-check"></i><b>3.5.1</b> Undoing <code>clean()</code></a></li>
<li class="chapter" data-level="3.5.2" data-path="walkthrough.html"><a href="walkthrough.html#renaming"><i class="fa fa-check"></i><b>3.5.2</b> Renaming</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="walkthrough.html"><a href="walkthrough.html#try-the-code-yourself"><i class="fa fa-check"></i><b>3.6</b> Try the code yourself!</a></li>
<li class="chapter" data-level="3.7" data-path="walkthrough.html"><a href="walkthrough.html#thanks"><i class="fa fa-check"></i><b>3.7</b> Thanks</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plans.html"><a href="plans.html"><i class="fa fa-check"></i><b>4</b> <code>drake</code> plans</a><ul>
<li class="chapter" data-level="4.1" data-path="plans.html"><a href="plans.html#functions"><i class="fa fa-check"></i><b>4.1</b> Functions</a></li>
<li class="chapter" data-level="4.2" data-path="plans.html"><a href="plans.html#intro-to-plans"><i class="fa fa-check"></i><b>4.2</b> Intro to plans</a></li>
<li class="chapter" data-level="4.3" data-path="plans.html"><a href="plans.html#how-to-choose-good-targets"><i class="fa fa-check"></i><b>4.3</b> How to choose good targets</a></li>
<li class="chapter" data-level="4.4" data-path="plans.html"><a href="plans.html#special-data-formats-for-targets"><i class="fa fa-check"></i><b>4.4</b> Special data formats for targets</a></li>
<li class="chapter" data-level="4.5" data-path="plans.html"><a href="plans.html#special-columns"><i class="fa fa-check"></i><b>4.5</b> Special columns</a></li>
<li class="chapter" data-level="4.6" data-path="plans.html"><a href="plans.html#external-files"><i class="fa fa-check"></i><b>4.6</b> External files</a><ul>
<li class="chapter" data-level="4.6.1" data-path="plans.html"><a href="plans.html#urls"><i class="fa fa-check"></i><b>4.6.1</b> URLs</a></li>
<li class="chapter" data-level="4.6.2" data-path="plans.html"><a href="plans.html#limitations-of-file-tracking"><i class="fa fa-check"></i><b>4.6.2</b> Limitations of file tracking</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="plans.html"><a href="plans.html#large-plans"><i class="fa fa-check"></i><b>4.7</b> Large plans</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dynamic.html"><a href="dynamic.html"><i class="fa fa-check"></i><b>5</b> Dynamic branching</a><ul>
<li class="chapter" data-level="5.1" data-path="dynamic.html"><a href="dynamic.html#motivation"><i class="fa fa-check"></i><b>5.1</b> Motivation</a></li>
<li class="chapter" data-level="5.2" data-path="dynamic.html"><a href="dynamic.html#which-kind-of-branching-should-i-use"><i class="fa fa-check"></i><b>5.2</b> Which kind of branching should I use?</a></li>
<li class="chapter" data-level="5.3" data-path="dynamic.html"><a href="dynamic.html#dynamic-targets"><i class="fa fa-check"></i><b>5.3</b> Dynamic targets</a></li>
<li class="chapter" data-level="5.4" data-path="dynamic.html"><a href="dynamic.html#map"><i class="fa fa-check"></i><b>5.4</b> map()</a></li>
<li class="chapter" data-level="5.5" data-path="dynamic.html"><a href="dynamic.html#cross"><i class="fa fa-check"></i><b>5.5</b> cross()</a></li>
<li class="chapter" data-level="5.6" data-path="dynamic.html"><a href="dynamic.html#combine"><i class="fa fa-check"></i><b>5.6</b> <code>combine()</code></a></li>
<li class="chapter" data-level="5.7" data-path="dynamic.html"><a href="dynamic.html#max_expand"><i class="fa fa-check"></i><b>5.7</b> max_expand</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="static.html"><a href="static.html"><i class="fa fa-check"></i><b>6</b> Static branching</a><ul>
<li class="chapter" data-level="6.0.1" data-path="static.html"><a href="static.html#how-to-create-large-plans"><i class="fa fa-check"></i><b>6.0.1</b> How to create large plans</a></li>
<li class="chapter" data-level="6.0.2" data-path="static.html"><a href="static.html#start-small"><i class="fa fa-check"></i><b>6.0.2</b> Start small</a></li>
<li class="chapter" data-level="6.0.3" data-path="static.html"><a href="static.html#the-types-of-transformations"><i class="fa fa-check"></i><b>6.0.3</b> The types of transformations</a></li>
<li class="chapter" data-level="6.0.4" data-path="static.html"><a href="static.html#grouping-variables"><i class="fa fa-check"></i><b>6.0.4</b> Grouping variables</a></li>
<li class="chapter" data-level="6.0.5" data-path="static.html"><a href="static.html#tags"><i class="fa fa-check"></i><b>6.0.5</b> Tags</a></li>
<li class="chapter" data-level="6.0.6" data-path="static.html"><a href="static.html#target-names"><i class="fa fa-check"></i><b>6.0.6</b> Target names</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="projects.html"><a href="projects.html"><i class="fa fa-check"></i><b>7</b> <code>drake</code> projects</a><ul>
<li class="chapter" data-level="7.1" data-path="projects.html"><a href="projects.html#code-files"><i class="fa fa-check"></i><b>7.1</b> Code files</a></li>
<li class="chapter" data-level="7.2" data-path="projects.html"><a href="projects.html#safer-interactivity"><i class="fa fa-check"></i><b>7.2</b> Safer interactivity</a><ul>
<li class="chapter" data-level="7.2.1" data-path="projects.html"><a href="projects.html#motivation-1"><i class="fa fa-check"></i><b>7.2.1</b> Motivation</a></li>
<li class="chapter" data-level="7.2.2" data-path="projects.html"><a href="projects.html#usage"><i class="fa fa-check"></i><b>7.2.2</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="projects.html"><a href="projects.html#script-file-pitfalls"><i class="fa fa-check"></i><b>7.3</b> Script file pitfalls</a></li>
<li class="chapter" data-level="7.4" data-path="projects.html"><a href="projects.html#workflows-as-r-packages"><i class="fa fa-check"></i><b>7.4</b> Workflows as R packages</a></li>
<li class="chapter" data-level="7.5" data-path="projects.html"><a href="projects.html#other-tools"><i class="fa fa-check"></i><b>7.5</b> Other tools</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="scripts.html"><a href="scripts.html"><i class="fa fa-check"></i><b>8</b> Script-based workflows</a><ul>
<li class="chapter" data-level="8.1" data-path="scripts.html"><a href="scripts.html#function-oriented-workflows"><i class="fa fa-check"></i><b>8.1</b> Function-oriented workflows</a></li>
<li class="chapter" data-level="8.2" data-path="scripts.html"><a href="scripts.html#traditional-and-legacy-workflows"><i class="fa fa-check"></i><b>8.2</b> Traditional and legacy workflows</a></li>
<li class="chapter" data-level="8.3" data-path="scripts.html"><a href="scripts.html#overcoming-technical-debt"><i class="fa fa-check"></i><b>8.3</b> Overcoming Technical Debt</a></li>
<li class="chapter" data-level="8.4" data-path="scripts.html"><a href="scripts.html#dependencies"><i class="fa fa-check"></i><b>8.4</b> Dependencies</a></li>
<li class="chapter" data-level="8.5" data-path="scripts.html"><a href="scripts.html#building-the-connections"><i class="fa fa-check"></i><b>8.5</b> Building the connections</a></li>
<li class="chapter" data-level="8.6" data-path="scripts.html"><a href="scripts.html#run-the-workflow"><i class="fa fa-check"></i><b>8.6</b> Run the workflow</a></li>
<li class="chapter" data-level="8.7" data-path="scripts.html"><a href="scripts.html#keeping-the-results-up-to-date"><i class="fa fa-check"></i><b>8.7</b> Keeping the results up to date</a></li>
<li class="chapter" data-level="8.8" data-path="scripts.html"><a href="scripts.html#final-thoughts"><i class="fa fa-check"></i><b>8.8</b> Final thoughts</a></li>
</ul></li>
<li class="part"><span><b>II Examples</b></span></li>
<li class="chapter" data-level="9" data-path="churn.html"><a href="churn.html"><i class="fa fa-check"></i><b>9</b> Customer churn and deep learning</a><ul>
<li class="chapter" data-level="9.1" data-path="churn.html"><a href="churn.html#packages"><i class="fa fa-check"></i><b>9.1</b> Packages</a></li>
<li class="chapter" data-level="9.2" data-path="churn.html"><a href="churn.html#functions-1"><i class="fa fa-check"></i><b>9.2</b> Functions</a></li>
<li class="chapter" data-level="9.3" data-path="churn.html"><a href="churn.html#plan"><i class="fa fa-check"></i><b>9.3</b> Plan</a></li>
<li class="chapter" data-level="9.4" data-path="churn.html"><a href="churn.html#dependency-graph"><i class="fa fa-check"></i><b>9.4</b> Dependency graph</a></li>
<li class="chapter" data-level="9.5" data-path="churn.html"><a href="churn.html#run-the-models"><i class="fa fa-check"></i><b>9.5</b> Run the models</a></li>
<li class="chapter" data-level="9.6" data-path="churn.html"><a href="churn.html#inspect-the-results"><i class="fa fa-check"></i><b>9.6</b> Inspect the results</a></li>
<li class="chapter" data-level="9.7" data-path="churn.html"><a href="churn.html#add-models"><i class="fa fa-check"></i><b>9.7</b> Add models</a></li>
<li class="chapter" data-level="9.8" data-path="churn.html"><a href="churn.html#inspect-the-results-again"><i class="fa fa-check"></i><b>9.8</b> Inspect the results again</a></li>
<li class="chapter" data-level="9.9" data-path="churn.html"><a href="churn.html#update-your-code"><i class="fa fa-check"></i><b>9.9</b> Update your code</a></li>
<li class="chapter" data-level="9.10" data-path="churn.html"><a href="churn.html#history-and-provenance-1"><i class="fa fa-check"></i><b>9.10</b> History and provenance</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="churn.html"><a href="churn.html#packages"><i class="fa fa-check"></i><b>10</b> An analysis of R package download trends</a><ul>
<li class="chapter" data-level="10.1" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>10.1</b> Get the code.</a></li>
<li class="chapter" data-level="10.2" data-path="packages.html"><a href="packages.html#overview"><i class="fa fa-check"></i><b>10.2</b> Overview</a></li>
<li class="chapter" data-level="10.3" data-path="packages.html"><a href="packages.html#analysis"><i class="fa fa-check"></i><b>10.3</b> Analysis</a></li>
<li class="chapter" data-level="10.4" data-path="packages.html"><a href="packages.html#other-ways-to-trigger-downloads"><i class="fa fa-check"></i><b>10.4</b> Other ways to trigger downloads</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="gsp.html"><a href="gsp.html"><i class="fa fa-check"></i><b>11</b> Finding the best model of gross state product</a><ul>
<li class="chapter" data-level="11.1" data-path="gsp.html"><a href="gsp.html#get-the-code.-1"><i class="fa fa-check"></i><b>11.1</b> Get the code.</a></li>
<li class="chapter" data-level="11.2" data-path="gsp.html"><a href="gsp.html#objective-and-methods"><i class="fa fa-check"></i><b>11.2</b> Objective and methods</a></li>
<li class="chapter" data-level="11.3" data-path="gsp.html"><a href="gsp.html#data"><i class="fa fa-check"></i><b>11.3</b> Data</a></li>
<li class="chapter" data-level="11.4" data-path="gsp.html"><a href="gsp.html#analysis-1"><i class="fa fa-check"></i><b>11.4</b> Analysis</a></li>
<li class="chapter" data-level="11.5" data-path="gsp.html"><a href="gsp.html#results"><i class="fa fa-check"></i><b>11.5</b> Results</a></li>
<li class="chapter" data-level="11.6" data-path="gsp.html"><a href="gsp.html#comparison-with-gnu-make"><i class="fa fa-check"></i><b>11.6</b> Comparison with GNU Make</a></li>
<li class="chapter" data-level="11.7" data-path="gsp.html"><a href="gsp.html#references"><i class="fa fa-check"></i><b>11.7</b> References</a></li>
</ul></li>
<li class="part"><span><b>III Resource management</b></span></li>
<li class="chapter" data-level="12" data-path="hpc.html"><a href="hpc.html"><i class="fa fa-check"></i><b>12</b> High-performance computing</a><ul>
<li class="chapter" data-level="12.1" data-path="hpc.html"><a href="hpc.html#start-small-1"><i class="fa fa-check"></i><b>12.1</b> Start small</a></li>
<li class="chapter" data-level="12.2" data-path="hpc.html"><a href="hpc.html#let-make-schedule-your-targets."><i class="fa fa-check"></i><b>12.2</b> Let <code>make()</code> schedule your targets.</a></li>
<li class="chapter" data-level="12.3" data-path="hpc.html"><a href="hpc.html#the-master-process"><i class="fa fa-check"></i><b>12.3</b> The master process</a><ul>
<li class="chapter" data-level="12.3.1" data-path="hpc.html"><a href="hpc.html#master-on-a-cluster"><i class="fa fa-check"></i><b>12.3.1</b> Master on a cluster</a></li>
<li class="chapter" data-level="12.3.2" data-path="hpc.html"><a href="hpc.html#local-master"><i class="fa fa-check"></i><b>12.3.2</b> Local master</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="hpc.html"><a href="hpc.html#parallel-backends"><i class="fa fa-check"></i><b>12.4</b> Parallel backends</a></li>
<li class="chapter" data-level="12.5" data-path="hpc.html"><a href="hpc.html#the-clustermq-backend"><i class="fa fa-check"></i><b>12.5</b> The <code>clustermq</code> backend</a><ul>
<li class="chapter" data-level="12.5.1" data-path="hpc.html"><a href="hpc.html#persistent-workers"><i class="fa fa-check"></i><b>12.5.1</b> Persistent workers</a></li>
<li class="chapter" data-level="12.5.2" data-path="hpc.html"><a href="hpc.html#installation-1"><i class="fa fa-check"></i><b>12.5.2</b> Installation</a></li>
<li class="chapter" data-level="12.5.3" data-path="hpc.html"><a href="hpc.html#on-your-local-machine"><i class="fa fa-check"></i><b>12.5.3</b> On your local machine</a></li>
<li class="chapter" data-level="12.5.4" data-path="hpc.html"><a href="hpc.html#on-a-cluster"><i class="fa fa-check"></i><b>12.5.4</b> On a cluster</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="hpc.html"><a href="hpc.html#the-future-backend"><i class="fa fa-check"></i><b>12.6</b> The <code>future</code> backend</a><ul>
<li class="chapter" data-level="12.6.1" data-path="hpc.html"><a href="hpc.html#transient-workers"><i class="fa fa-check"></i><b>12.6.1</b> Transient workers</a></li>
<li class="chapter" data-level="12.6.2" data-path="hpc.html"><a href="hpc.html#installation-2"><i class="fa fa-check"></i><b>12.6.2</b> Installation</a></li>
<li class="chapter" data-level="12.6.3" data-path="hpc.html"><a href="hpc.html#on-your-local-machine-1"><i class="fa fa-check"></i><b>12.6.3</b> On your local machine</a></li>
<li class="chapter" data-level="12.6.4" data-path="hpc.html"><a href="hpc.html#on-a-cluster-1"><i class="fa fa-check"></i><b>12.6.4</b> On a cluster</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="hpc.html"><a href="hpc.html#advanced-options"><i class="fa fa-check"></i><b>12.7</b> Advanced options</a><ul>
<li class="chapter" data-level="12.7.1" data-path="hpc.html"><a href="hpc.html#selectivity"><i class="fa fa-check"></i><b>12.7.1</b> Selectivity</a></li>
<li class="chapter" data-level="12.7.2" data-path="hpc.html"><a href="hpc.html#memory-options"><i class="fa fa-check"></i><b>12.7.2</b> Memory options</a></li>
<li class="chapter" data-level="12.7.3" data-path="hpc.html"><a href="hpc.html#storage-options"><i class="fa fa-check"></i><b>12.7.3</b> Storage options</a></li>
<li class="chapter" data-level="12.7.4" data-path="hpc.html"><a href="hpc.html#the-template-argument-for-persistent-workers"><i class="fa fa-check"></i><b>12.7.4</b> The <code>template</code> argument for persistent workers</a></li>
<li class="chapter" data-level="12.7.5" data-path="hpc.html"><a href="hpc.html#the-resources-column-for-transient-workers"><i class="fa fa-check"></i><b>12.7.5</b> The <code>resources</code> column for transient workers</a></li>
<li class="chapter" data-level="12.7.6" data-path="hpc.html"><a href="hpc.html#parallel-computing-within-targets"><i class="fa fa-check"></i><b>12.7.6</b> Parallel computing <em>within</em> targets</a></li>
<li class="chapter" data-level="12.7.7" data-path="hpc.html"><a href="hpc.html#custom-job-schedulers"><i class="fa fa-check"></i><b>12.7.7</b> Custom job schedulers</a></li>
<li class="chapter" data-level="12.7.8" data-path="hpc.html"><a href="hpc.html#hasty-mode"><i class="fa fa-check"></i><b>12.7.8</b> Hasty mode</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="time.html"><a href="time.html"><i class="fa fa-check"></i><b>13</b> Time: logging, prediction, and strategy</a><ul>
<li class="chapter" data-level="13.1" data-path="time.html"><a href="time.html#predict-total-runtime"><i class="fa fa-check"></i><b>13.1</b> Predict total runtime</a></li>
<li class="chapter" data-level="13.2" data-path="time.html"><a href="time.html#strategize-your-high-performance-computing"><i class="fa fa-check"></i><b>13.2</b> Strategize your high-performance computing</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="memory.html"><a href="memory.html"><i class="fa fa-check"></i><b>14</b> Memory management</a><ul>
<li class="chapter" data-level="14.1" data-path="memory.html"><a href="memory.html#garbage-collection-and-custom-files"><i class="fa fa-check"></i><b>14.1</b> Garbage collection and custom files</a></li>
<li class="chapter" data-level="14.2" data-path="memory.html"><a href="memory.html#memory-strategies"><i class="fa fa-check"></i><b>14.2</b> Memory strategies</a></li>
<li class="chapter" data-level="14.3" data-path="memory.html"><a href="memory.html#data-splitting"><i class="fa fa-check"></i><b>14.3</b> Data splitting</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="storage.html"><a href="storage.html"><i class="fa fa-check"></i><b>15</b> Storage</a><ul>
<li class="chapter" data-level="15.1" data-path="storage.html"><a href="storage.html#special-data-formats-for-targets-1"><i class="fa fa-check"></i><b>15.1</b> Special data formats for targets</a></li>
<li class="chapter" data-level="15.2" data-path="storage.html"><a href="storage.html#cache-management"><i class="fa fa-check"></i><b>15.2</b> Cache management</a></li>
<li class="chapter" data-level="15.3" data-path="storage.html"><a href="storage.html#cache-formats"><i class="fa fa-check"></i><b>15.3</b> Cache formats</a><ul>
<li class="chapter" data-level="15.3.1" data-path="storage.html"><a href="storage.html#rds-caches"><i class="fa fa-check"></i><b>15.3.1</b> RDS caches</a></li>
<li class="chapter" data-level="15.3.2" data-path="storage.html"><a href="storage.html#database-caches"><i class="fa fa-check"></i><b>15.3.2</b> Database caches</a></li>
<li class="chapter" data-level="15.3.3" data-path="storage.html"><a href="storage.html#environment-caches"><i class="fa fa-check"></i><b>15.3.3</b> Environment caches</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="storage.html"><a href="storage.html#hash-algorithms"><i class="fa fa-check"></i><b>15.4</b> Hash algorithms</a></li>
</ul></li>
<li class="part"><span><b>IV Extra features</b></span></li>
<li class="chapter" data-level="16" data-path="visuals.html"><a href="visuals.html"><i class="fa fa-check"></i><b>16</b> Visualization with drake</a><ul>
<li class="chapter" data-level="16.1" data-path="visuals.html"><a href="visuals.html#plotting-plans"><i class="fa fa-check"></i><b>16.1</b> Plotting plans</a><ul>
<li class="chapter" data-level="16.1.1" data-path="visuals.html"><a href="visuals.html#vis_drake_graph"><i class="fa fa-check"></i><b>16.1.1</b> <code>vis_drake_graph()</code></a></li>
<li class="chapter" data-level="16.1.2" data-path="visuals.html"><a href="visuals.html#sankey_drake_graph"><i class="fa fa-check"></i><b>16.1.2</b> <code>sankey_drake_graph()</code></a></li>
<li class="chapter" data-level="16.1.3" data-path="visuals.html"><a href="visuals.html#drake_ggraph"><i class="fa fa-check"></i><b>16.1.3</b> <code>drake_ggraph()</code></a></li>
<li class="chapter" data-level="16.1.4" data-path="visuals.html"><a href="visuals.html#text_drake_graph"><i class="fa fa-check"></i><b>16.1.4</b> <code>text_drake_graph()</code></a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="visuals.html"><a href="visuals.html#underlying-graph-data-node-and-edge-data-frames"><i class="fa fa-check"></i><b>16.2</b> Underlying graph data: node and edge data frames</a></li>
<li class="chapter" data-level="16.3" data-path="visuals.html"><a href="visuals.html#visualizing-target-status"><i class="fa fa-check"></i><b>16.3</b> Visualizing target status</a></li>
<li class="chapter" data-level="16.4" data-path="visuals.html"><a href="visuals.html#subgraphs"><i class="fa fa-check"></i><b>16.4</b> Subgraphs</a></li>
<li class="chapter" data-level="16.5" data-path="visuals.html"><a href="visuals.html#control-the-vis_drake_graph-legend."><i class="fa fa-check"></i><b>16.5</b> Control the <code>vis_drake_graph()</code> legend.</a></li>
<li class="chapter" data-level="16.6" data-path="visuals.html"><a href="visuals.html#clusters"><i class="fa fa-check"></i><b>16.6</b> Clusters</a></li>
<li class="chapter" data-level="16.7" data-path="visuals.html"><a href="visuals.html#output-files"><i class="fa fa-check"></i><b>16.7</b> Output files</a></li>
<li class="chapter" data-level="16.8" data-path="visuals.html"><a href="visuals.html#node-selection"><i class="fa fa-check"></i><b>16.8</b> Node Selection</a><ul>
<li class="chapter" data-level="16.8.1" data-path="visuals.html"><a href="visuals.html#perform-the-default-action-on-select"><i class="fa fa-check"></i><b>16.8.1</b> Perform the default action on select</a></li>
<li class="chapter" data-level="16.8.2" data-path="visuals.html"><a href="visuals.html#perform-no-action-on-select"><i class="fa fa-check"></i><b>16.8.2</b> Perform no action on select</a></li>
<li class="chapter" data-level="16.8.3" data-path="visuals.html"><a href="visuals.html#customize-the-onselect-event-behaviour"><i class="fa fa-check"></i><b>16.8.3</b> Customize the onSelect event behaviour</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>17</b> Debugging and testing drake projects</a><ul>
<li class="chapter" data-level="17.0.1" data-path="debugging.html"><a href="debugging.html#start-small-2"><i class="fa fa-check"></i><b>17.0.1</b> Start small</a></li>
<li class="chapter" data-level="17.1" data-path="debugging.html"><a href="debugging.html#dependencies-1"><i class="fa fa-check"></i><b>17.1</b> Dependencies</a><ul>
<li class="chapter" data-level="17.1.1" data-path="debugging.html"><a href="debugging.html#visualize-your-dependency-graph."><i class="fa fa-check"></i><b>17.1.1</b> Visualize your dependency graph.</a></li>
<li class="chapter" data-level="17.1.2" data-path="debugging.html"><a href="debugging.html#check-specific-dependency-information."><i class="fa fa-check"></i><b>17.1.2</b> Check specific dependency information.</a></li>
<li class="chapter" data-level="17.1.3" data-path="debugging.html"><a href="debugging.html#outdated-targets-and-missing-dependencies"><i class="fa fa-check"></i><b>17.1.3</b> Outdated targets and missing dependencies</a></li>
<li class="chapter" data-level="17.1.4" data-path="debugging.html"><a href="debugging.html#but-why-are-my-targets-out-of-date"><i class="fa fa-check"></i><b>17.1.4</b> But <em>why</em> are my targets out of date?</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="debugging.html"><a href="debugging.html#diagnose-failures."><i class="fa fa-check"></i><b>17.2</b> Diagnose failures.</a></li>
<li class="chapter" data-level="17.3" data-path="debugging.html"><a href="debugging.html#timeouts-and-retries"><i class="fa fa-check"></i><b>17.3</b> Timeouts and retries</a></li>
<li class="chapter" data-level="17.4" data-path="debugging.html"><a href="debugging.html#more-help"><i class="fa fa-check"></i><b>17.4</b> More help</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="triggers.html"><a href="triggers.html"><i class="fa fa-check"></i><b>18</b> Triggers: decision rules for building targets</a><ul>
<li class="chapter" data-level="18.1" data-path="triggers.html"><a href="triggers.html#what-are-triggers"><i class="fa fa-check"></i><b>18.1</b> What are triggers?</a></li>
<li class="chapter" data-level="18.2" data-path="triggers.html"><a href="triggers.html#customization"><i class="fa fa-check"></i><b>18.2</b> Customization</a></li>
<li class="chapter" data-level="18.3" data-path="triggers.html"><a href="triggers.html#alternative-trigger-modes"><i class="fa fa-check"></i><b>18.3</b> Alternative trigger modes</a></li>
<li class="chapter" data-level="18.4" data-path="triggers.html"><a href="triggers.html#consider-hasty-mode"><i class="fa fa-check"></i><b>18.4</b> Consider hasty mode</a></li>
<li class="chapter" data-level="18.5" data-path="triggers.html"><a href="triggers.html#a-more-practical-example"><i class="fa fa-check"></i><b>18.5</b> A more practical example</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>A</b> Frequently-asked questions</a></li>
<li class="chapter" data-level="B" data-path="caution.html"><a href="caution.html"><i class="fa fa-check"></i><b>B</b> Cautionary notes</a><ul>
<li class="chapter" data-level="B.1" data-path="caution.html"><a href="caution.html#workflow-plans"><i class="fa fa-check"></i><b>B.1</b> Workflow plans</a><ul>
<li class="chapter" data-level="B.1.1" data-path="caution.html"><a href="caution.html#externalizing-commands-in-r-script-files"><i class="fa fa-check"></i><b>B.1.1</b> Externalizing commands in R script files</a></li>
<li class="chapter" data-level="B.1.2" data-path="caution.html"><a href="caution.html#commands-are-not-perfectly-flexible."><i class="fa fa-check"></i><b>B.1.2</b> Commands are NOT perfectly flexible.</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="caution.html"><a href="caution.html#execution"><i class="fa fa-check"></i><b>B.2</b> Execution</a><ul>
<li class="chapter" data-level="B.2.1" data-path="caution.html"><a href="caution.html#install-drake-properly."><i class="fa fa-check"></i><b>B.2.1</b> Install <code>drake</code> properly.</a></li>
<li class="chapter" data-level="B.2.2" data-path="caution.html"><a href="caution.html#install-all-your-packages."><i class="fa fa-check"></i><b>B.2.2</b> Install all your packages.</a></li>
<li class="chapter" data-level="B.2.3" data-path="caution.html"><a href="caution.html#a-note-on-tidy-evaluation"><i class="fa fa-check"></i><b>B.2.3</b> A note on tidy evaluation</a></li>
<li class="chapter" data-level="B.2.4" data-path="caution.html"><a href="caution.html#find-and-diagnose-your-errors."><i class="fa fa-check"></i><b>B.2.4</b> Find and diagnose your errors.</a></li>
<li class="chapter" data-level="B.2.5" data-path="caution.html"><a href="caution.html#refresh-the-drake_config-list-early-and-often."><i class="fa fa-check"></i><b>B.2.5</b> Refresh the <code>drake_config()</code> list early and often.</a></li>
<li class="chapter" data-level="B.2.6" data-path="caution.html"><a href="caution.html#workflows-as-r-packages."><i class="fa fa-check"></i><b>B.2.6</b> Workflows as R packages.</a></li>
<li class="chapter" data-level="B.2.7" data-path="caution.html"><a href="caution.html#the-lazy_load-flag-does-not-work-with-parlapply-parallelism."><i class="fa fa-check"></i><b>B.2.7</b> The <code>lazy_load</code> flag does not work with <code>&quot;parLapply&quot;</code> parallelism.</a></li>
<li class="chapter" data-level="B.2.8" data-path="caution.html"><a href="caution.html#timeouts-may-be-unreliable."><i class="fa fa-check"></i><b>B.2.8</b> Timeouts may be unreliable.</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="caution.html"><a href="caution.html#dependencies-2"><i class="fa fa-check"></i><b>B.3</b> Dependencies</a><ul>
<li class="chapter" data-level="B.3.1" data-path="caution.html"><a href="caution.html#objects-that-contain-functions-may-rebuild-too-often"><i class="fa fa-check"></i><b>B.3.1</b> Objects that contain functions may rebuild too often</a></li>
<li class="chapter" data-level="B.3.2" data-path="caution.html"><a href="caution.html#dependencies-are-not-tracked-in-some-edge-cases."><i class="fa fa-check"></i><b>B.3.2</b> Dependencies are not tracked in some edge cases.</a></li>
<li class="chapter" data-level="B.3.3" data-path="caution.html"><a href="caution.html#dependencies-of-knitr-reports"><i class="fa fa-check"></i><b>B.3.3</b> Dependencies of <code>knitr</code> reports</a></li>
<li class="chapter" data-level="B.3.4" data-path="caution.html"><a href="caution.html#s3-and-generic-methods"><i class="fa fa-check"></i><b>B.3.4</b> S3 and generic methods</a></li>
<li class="chapter" data-level="B.3.5" data-path="caution.html"><a href="caution.html#file-outputs-in-imported-functions."><i class="fa fa-check"></i><b>B.3.5</b> File outputs in imported functions.</a></li>
<li class="chapter" data-level="B.3.6" data-path="caution.html"><a href="caution.html#functions-produced-by-vectorize"><i class="fa fa-check"></i><b>B.3.6</b> Functions produced by <code>Vectorize()</code></a></li>
<li class="chapter" data-level="B.3.7" data-path="caution.html"><a href="caution.html#compiled-code-is-not-reproducibly-tracked."><i class="fa fa-check"></i><b>B.3.7</b> Compiled code is not reproducibly tracked.</a></li>
<li class="chapter" data-level="B.3.8" data-path="caution.html"><a href="caution.html#directories-folders-are-not-reproducibly-tracked."><i class="fa fa-check"></i><b>B.3.8</b> Directories (folders) are not reproducibly tracked.</a></li>
<li class="chapter" data-level="B.3.9" data-path="caution.html"><a href="caution.html#packages-are-not-tracked-as-dependencies."><i class="fa fa-check"></i><b>B.3.9</b> Packages are not tracked as dependencies.</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="caution.html"><a href="caution.html#high-performance-computing"><i class="fa fa-check"></i><b>B.4</b> High-performance computing</a><ul>
<li class="chapter" data-level="B.4.1" data-path="caution.html"><a href="caution.html#calling-mclapply-within-targets"><i class="fa fa-check"></i><b>B.4.1</b> Calling <code>mclapply()</code> <em>within</em> targets</a></li>
<li class="chapter" data-level="B.4.2" data-path="caution.html"><a href="caution.html#zombie-processes"><i class="fa fa-check"></i><b>B.4.2</b> Zombie processes</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="caution.html"><a href="caution.html#storage-1"><i class="fa fa-check"></i><b>B.5</b> Storage</a><ul>
<li class="chapter" data-level="B.5.1" data-path="caution.html"><a href="caution.html#projects-hosted-on-dropbox-and-similar-platforms"><i class="fa fa-check"></i><b>B.5.1</b> Projects hosted on Dropbox and similar platforms</a></li>
<li class="chapter" data-level="B.5.2" data-path="caution.html"><a href="caution.html#cache-customization-is-limited"><i class="fa fa-check"></i><b>B.5.2</b> Cache customization is limited</a></li>
<li class="chapter" data-level="B.5.3" data-path="caution.html"><a href="caution.html#runtime-predictions"><i class="fa fa-check"></i><b>B.5.3</b> Runtime predictions</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The drake R Package User Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="storage" class="section level1">
<h1><span class="header-section-number">Chapter 15</span> Storage</h1>
<div id="special-data-formats-for-targets-1" class="section level2">
<h2><span class="header-section-number">15.1</span> Special data formats for targets</h2>
<p><code>drake</code> supports custom formats for large unwiedly targets. For example, the <code>&quot;fst&quot;</code> format uses the <a href="https://github.com/fstpackage/fst"><code>fst</code></a> package to save targets faster. Simply enclose the command and the format together with the <code>target()</code> function.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" data-line-number="1"><span class="kw">library</span>(drake)</a>
<a class="sourceLine" id="cb224-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="fl">1e8</span> <span class="co"># Each target is 1.6 GB in memory.</span></a>
<a class="sourceLine" id="cb224-3" data-line-number="3">plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(</a>
<a class="sourceLine" id="cb224-4" data-line-number="4">  <span class="dt">data_fst =</span> <span class="kw">target</span>(</a>
<a class="sourceLine" id="cb224-5" data-line-number="5">    <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">runif</span>(n), <span class="dt">y =</span> <span class="kw">runif</span>(n)),</a>
<a class="sourceLine" id="cb224-6" data-line-number="6">    <span class="dt">format =</span> <span class="st">&quot;fst&quot;</span></a>
<a class="sourceLine" id="cb224-7" data-line-number="7">  ),</a>
<a class="sourceLine" id="cb224-8" data-line-number="8">  <span class="dt">data_old =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">runif</span>(n), <span class="dt">y =</span> <span class="kw">runif</span>(n))</a>
<a class="sourceLine" id="cb224-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb224-10" data-line-number="10"><span class="kw">make</span>(plan)</a>
<a class="sourceLine" id="cb224-11" data-line-number="11"><span class="co">#&gt; target data_fst</span></a>
<a class="sourceLine" id="cb224-12" data-line-number="12"><span class="co">#&gt; target data_old</span></a>
<a class="sourceLine" id="cb224-13" data-line-number="13"><span class="kw">build_times</span>(<span class="dt">type =</span> <span class="st">&quot;build&quot;</span>)</a>
<a class="sourceLine" id="cb224-14" data-line-number="14"><span class="co">#&gt; # A tibble: 2 x 4</span></a>
<a class="sourceLine" id="cb224-15" data-line-number="15"><span class="co">#&gt;   target   elapsed              user                 system    </span></a>
<a class="sourceLine" id="cb224-16" data-line-number="16"><span class="co">#&gt;   &lt;chr&gt;    &lt;Duration&gt;           &lt;Duration&gt;           &lt;Duration&gt;</span></a>
<a class="sourceLine" id="cb224-17" data-line-number="17"><span class="co">#&gt; 1 data_fst 13.93s               37.562s              7.954s    </span></a>
<a class="sourceLine" id="cb224-18" data-line-number="18"><span class="co">#&gt; 2 data_old 184s (~3.07 minutes) 177s (~2.95 minutes) 4.157s</span></a></code></pre></div>
<p>Other available formats:</p>
<ul>
<li><code>&quot;fst_dt&quot;</code>: like <code>&quot;fst&quot;</code>, but for <a href="https://github.com/Rdatatable/data.table"><code>data.table</code></a> objects.</li>
<li><code>&quot;diskframe&quot;</code>: for larger-than-memory targets. Uses the <a href="https://github.com/xiaodaigh/disk.frame"><code>disk.frame</code></a> package.</li>
<li><code>&quot;keras&quot;</code>: for <a href="https://github.com/rstudio/keras"><code>keras</code></a> models. See <a href="https://wlandau.github.io/learndrake">these slides</a> for an example.</li>
<li><code>&quot;rds&quot;</code>: for any target compatible with <code>saveRDS()</code>. This format is basically the same as <code>drake</code>âs default format except that it consumes less memory during the storage process.</li>
</ul>
</div>
<div id="cache-management" class="section level2">
<h2><span class="header-section-number">15.2</span> Cache management</h2>
<p>When you run <code>make()</code>, <code>drake</code> stores your targets in a cache.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" data-line-number="1"><span class="kw">library</span>(drake)</a>
<a class="sourceLine" id="cb225-2" data-line-number="2"><span class="kw">load_mtcars_example</span>() <span class="co"># from https://github.com/wlandau/drake-examples/tree/master/mtcars</span></a>
<a class="sourceLine" id="cb225-3" data-line-number="3"><span class="kw">make</span>(my_plan, <span class="dt">verbose =</span> 0L)</a></code></pre></div>
<p>The default cache is a hidden <code>.drake</code> folder.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" data-line-number="1"><span class="kw">find_cache</span>()</a>
<a class="sourceLine" id="cb226-2" data-line-number="2">### [1] &quot;/home/you/project/.drake&quot;</a></code></pre></div>
<p><code>drake</code> uses the <a href="https://github.com/richfitz/storr">storr</a> package to create and modify caches.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" data-line-number="1"><span class="kw">library</span>(storr)</a>
<a class="sourceLine" id="cb227-2" data-line-number="2">cache &lt;-<span class="st"> </span><span class="kw">storr_rds</span>(<span class="st">&quot;.drake&quot;</span>)</a>
<a class="sourceLine" id="cb227-3" data-line-number="3"></a>
<a class="sourceLine" id="cb227-4" data-line-number="4"><span class="kw">head</span>(cache<span class="op">$</span><span class="kw">list</span>())</a>
<a class="sourceLine" id="cb227-5" data-line-number="5"><span class="co">#&gt; [1] &quot;coef_regression1_large&quot;       &quot;coef_regression1_small&quot;      </span></a>
<a class="sourceLine" id="cb227-6" data-line-number="6"><span class="co">#&gt; [3] &quot;coef_regression2_large&quot;       &quot;coef_regression2_small&quot;      </span></a>
<a class="sourceLine" id="cb227-7" data-line-number="7"><span class="co">#&gt; [5] &quot;large&quot;                        &quot;n-MRQXIYLTMV2HGOR2NV2GGYLSOM&quot;</span></a>
<a class="sourceLine" id="cb227-8" data-line-number="8"></a>
<a class="sourceLine" id="cb227-9" data-line-number="9"><span class="kw">head</span>(cache<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;small&quot;</span>))</a>
<a class="sourceLine" id="cb227-10" data-line-number="10"><span class="co">#&gt;       x    y</span></a>
<a class="sourceLine" id="cb227-11" data-line-number="11"><span class="co">#&gt; 1 3.780 15.2</span></a>
<a class="sourceLine" id="cb227-12" data-line-number="12"><span class="co">#&gt; 2 3.440 17.8</span></a>
<a class="sourceLine" id="cb227-13" data-line-number="13"><span class="co">#&gt; 3 3.215 21.4</span></a>
<a class="sourceLine" id="cb227-14" data-line-number="14"><span class="co">#&gt; 4 3.440 19.2</span></a>
<a class="sourceLine" id="cb227-15" data-line-number="15"><span class="co">#&gt; 5 2.770 19.7</span></a>
<a class="sourceLine" id="cb227-16" data-line-number="16"><span class="co">#&gt; 6 2.465 21.5</span></a></code></pre></div>
<p><code>drake</code> has its own interface on top of <a href="https://github.com/richfitz/storr">storr</a> to make it easier to work with the default <code>.drake/</code> cache. The <code>loadd()</code>, <code>readd()</code>, and <code>cached()</code> functions explore saved targets.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" data-line-number="1"><span class="kw">head</span>(<span class="kw">cached</span>())</a>
<a class="sourceLine" id="cb228-2" data-line-number="2"><span class="co">#&gt; [1] &quot;coef_regression1_large&quot; &quot;coef_regression1_small&quot;</span></a>
<a class="sourceLine" id="cb228-3" data-line-number="3"><span class="co">#&gt; [3] &quot;coef_regression2_large&quot; &quot;coef_regression2_small&quot;</span></a>
<a class="sourceLine" id="cb228-4" data-line-number="4"><span class="co">#&gt; [5] &quot;large&quot;                  &quot;regression1_large&quot;</span></a>
<a class="sourceLine" id="cb228-5" data-line-number="5"></a>
<a class="sourceLine" id="cb228-6" data-line-number="6"><span class="kw">head</span>(<span class="kw">readd</span>(small))</a>
<a class="sourceLine" id="cb228-7" data-line-number="7"><span class="co">#&gt;       x    y</span></a>
<a class="sourceLine" id="cb228-8" data-line-number="8"><span class="co">#&gt; 1 3.780 15.2</span></a>
<a class="sourceLine" id="cb228-9" data-line-number="9"><span class="co">#&gt; 2 3.440 17.8</span></a>
<a class="sourceLine" id="cb228-10" data-line-number="10"><span class="co">#&gt; 3 3.215 21.4</span></a>
<a class="sourceLine" id="cb228-11" data-line-number="11"><span class="co">#&gt; 4 3.440 19.2</span></a>
<a class="sourceLine" id="cb228-12" data-line-number="12"><span class="co">#&gt; 5 2.770 19.7</span></a>
<a class="sourceLine" id="cb228-13" data-line-number="13"><span class="co">#&gt; 6 2.465 21.5</span></a>
<a class="sourceLine" id="cb228-14" data-line-number="14"></a>
<a class="sourceLine" id="cb228-15" data-line-number="15"><span class="kw">loadd</span>(large)</a>
<a class="sourceLine" id="cb228-16" data-line-number="16"></a>
<a class="sourceLine" id="cb228-17" data-line-number="17"><span class="kw">head</span>(large)</a>
<a class="sourceLine" id="cb228-18" data-line-number="18"><span class="co">#&gt;       x    y</span></a>
<a class="sourceLine" id="cb228-19" data-line-number="19"><span class="co">#&gt; 1 2.140 26.0</span></a>
<a class="sourceLine" id="cb228-20" data-line-number="20"><span class="co">#&gt; 2 3.730 17.3</span></a>
<a class="sourceLine" id="cb228-21" data-line-number="21"><span class="co">#&gt; 3 1.935 27.3</span></a>
<a class="sourceLine" id="cb228-22" data-line-number="22"><span class="co">#&gt; 4 2.780 21.4</span></a>
<a class="sourceLine" id="cb228-23" data-line-number="23"><span class="co">#&gt; 5 2.320 22.8</span></a>
<a class="sourceLine" id="cb228-24" data-line-number="24"><span class="co">#&gt; 6 2.780 21.4</span></a>
<a class="sourceLine" id="cb228-25" data-line-number="25"></a>
<a class="sourceLine" id="cb228-26" data-line-number="26"><span class="kw">rm</span>(large) <span class="co"># Does not remove `large` from the cache.</span></a></code></pre></div>
<p>Functions <code>drake_cache()</code>, <code>storr::storr_rds()</code>, and <code>new_cache()</code> recover and create caches. (<code>drake_cache()</code> is only supported in <code>drake</code> version 7.4.0 and above.)</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" data-line-number="1">cache &lt;-<span class="st"> </span><span class="kw">drake_cache</span>()</a>
<a class="sourceLine" id="cb229-2" data-line-number="2">cache<span class="op">$</span>driver<span class="op">$</span>path</a>
<a class="sourceLine" id="cb229-3" data-line-number="3"><span class="co">#&gt; [1] &quot;/tmp/Rtmpqo6VRt/file30507cc25499/.drake&quot;</span></a>
<a class="sourceLine" id="cb229-4" data-line-number="4"></a>
<a class="sourceLine" id="cb229-5" data-line-number="5">cache &lt;-<span class="st"> </span><span class="kw">drake_cache</span>(<span class="dt">path =</span> <span class="st">&quot;.drake&quot;</span>) <span class="co"># File path to drake&#39;s cache.</span></a>
<a class="sourceLine" id="cb229-6" data-line-number="6">cache<span class="op">$</span>driver<span class="op">$</span>path</a>
<a class="sourceLine" id="cb229-7" data-line-number="7"><span class="co">#&gt; [1] &quot;/tmp/Rtmpqo6VRt/file30507cc25499/.drake&quot;</span></a>
<a class="sourceLine" id="cb229-8" data-line-number="8"></a>
<a class="sourceLine" id="cb229-9" data-line-number="9">cache &lt;-<span class="st"> </span>storr<span class="op">::</span><span class="kw">storr_rds</span>(<span class="dt">path =</span> <span class="st">&quot;.drake&quot;</span>)</a>
<a class="sourceLine" id="cb229-10" data-line-number="10">cache<span class="op">$</span>driver<span class="op">$</span>path</a>
<a class="sourceLine" id="cb229-11" data-line-number="11"><span class="co">#&gt; [1] &quot;/tmp/Rtmpqo6VRt/file30507cc25499/.drake&quot;</span></a>
<a class="sourceLine" id="cb229-12" data-line-number="12"></a>
<a class="sourceLine" id="cb229-13" data-line-number="13">cache2 &lt;-<span class="st"> </span><span class="kw">new_cache</span>(<span class="st">&quot;my_new_cache&quot;</span>)</a>
<a class="sourceLine" id="cb229-14" data-line-number="14">cache2<span class="op">$</span>driver<span class="op">$</span>path</a>
<a class="sourceLine" id="cb229-15" data-line-number="15"><span class="co">#&gt; [1] &quot;/tmp/Rtmpqo6VRt/file30507cc25499/my_new_cache&quot;</span></a></code></pre></div>
<p>You can supply your own cache to <code>make()</code> and similar functions.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" data-line-number="1">cache2<span class="op">$</span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb230-2" data-line-number="2"><span class="co">#&gt; character(0)</span></a>
<a class="sourceLine" id="cb230-3" data-line-number="3"></a>
<a class="sourceLine" id="cb230-4" data-line-number="4">plan2 &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="kw">sqrt</span>(x))</a>
<a class="sourceLine" id="cb230-5" data-line-number="5"><span class="kw">make</span>(plan2, <span class="dt">cache =</span> cache2)</a>
<a class="sourceLine" id="cb230-6" data-line-number="6"><span class="co">#&gt; target x</span></a>
<a class="sourceLine" id="cb230-7" data-line-number="7"><span class="co">#&gt; target y</span></a>
<a class="sourceLine" id="cb230-8" data-line-number="8"></a>
<a class="sourceLine" id="cb230-9" data-line-number="9">cache2<span class="op">$</span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb230-10" data-line-number="10"><span class="co">#&gt; [1] &quot;x&quot; &quot;y&quot;</span></a>
<a class="sourceLine" id="cb230-11" data-line-number="11"></a>
<a class="sourceLine" id="cb230-12" data-line-number="12">config &lt;-<span class="st"> </span><span class="kw">drake_config</span>(<span class="dt">plan =</span> plan2, <span class="dt">cache =</span> cache2)</a>
<a class="sourceLine" id="cb230-13" data-line-number="13"><span class="kw">vis_drake_graph</span>(config)</a></code></pre></div>
<div id="htmlwidget-44eed51e93cee206fe24" style="width:576px;height:576px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-44eed51e93cee206fe24">{"x":{"nodes":{"id":["x","y"],"imported":[false,false],"label":["x\n0.004s","y\n0.004s"],"status":["up to date","up to date"],"type":["object","object"],"font.size":[20,20],"color":["#228B22","#228B22"],"shape":["dot","dot"],"level":[1,2],"x":[-1,1],"y":[0,0]},"edges":{"from":["x"],"to":["y"],"arrows":["to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"interaction":{"navigationButtons":true},"layout":{"hierarchical":{"enabled":true,"direction":"LR"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)"},"main":{"text":"Dependency graph","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":false,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":true,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["Up to date","Object"],"color":["#228B22","#888888"],"shape":["dot","dot"],"font.color":["black","black"],"font.size":[20,20],"id":[1,7]},"nodesToDataframe":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
<p>Destroy caches to remove them from your file system.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" data-line-number="1">cache<span class="op">$</span><span class="kw">destroy</span>()</a>
<a class="sourceLine" id="cb231-2" data-line-number="2">cache2<span class="op">$</span><span class="kw">destroy</span>()</a></code></pre></div>
</div>
<div id="cache-formats" class="section level2">
<h2><span class="header-section-number">15.3</span> Cache formats</h2>
<div id="rds-caches" class="section level3">
<h3><span class="header-section-number">15.3.1</span> RDS caches</h3>
<p>By default, <code>drake</code> uses <code>storr_rds()</code> caches because they allow <code>make(jobs = 4)</code> to safely store multiple targets in parallel. To achieve this thread safety, however, <a href="https://github.com/richfitz/storr"><code>storr</code></a> splits up the data into a pool of tiny cryptically-named files.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" data-line-number="1"><span class="kw">make</span>(my_plan, <span class="dt">verbose =</span> 0L)</a>
<a class="sourceLine" id="cb232-2" data-line-number="2"><span class="kw">head</span>(<span class="kw">list.files</span>(<span class="st">&quot;.drake/data&quot;</span>))</a>
<a class="sourceLine" id="cb232-3" data-line-number="3"><span class="co">#&gt; [1] &quot;01334604535d9c73.rds&quot; &quot;03576eaeae27d5c6.rds&quot; &quot;03a31e2707a82c3a.rds&quot;</span></a>
<a class="sourceLine" id="cb232-4" data-line-number="4"><span class="co">#&gt; [4] &quot;05a7f2b39dc113d0.rds&quot; &quot;08ab38c38f6d8ffd.rds&quot; &quot;0e4abbd0ac546e0e.rds&quot;</span></a>
<a class="sourceLine" id="cb232-5" data-line-number="5"><span class="kw">head</span>(<span class="kw">list.files</span>(<span class="st">&quot;.drake/keys/objects&quot;</span>))</a>
<a class="sourceLine" id="cb232-6" data-line-number="6"><span class="co">#&gt; [1] &quot;coef_regression1_large&quot;       &quot;coef_regression1_small&quot;      </span></a>
<a class="sourceLine" id="cb232-7" data-line-number="7"><span class="co">#&gt; [3] &quot;coef_regression2_large&quot;       &quot;coef_regression2_small&quot;      </span></a>
<a class="sourceLine" id="cb232-8" data-line-number="8"><span class="co">#&gt; [5] &quot;large&quot;                        &quot;n-MRQXIYLTMV2HGOR2NV2GGYLSOM&quot;</span></a></code></pre></div>
<p>This makes RDS caches difficult to share with collaborators and put under version control. For the sake of portability, you may wish to work with database cashes as the next section describes.</p>
<p>Alternatively, you can track changes in a cache log with fingerprints of all your targets.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb233-1" data-line-number="1"><span class="kw">drake_cache_log</span>()</a>
<a class="sourceLine" id="cb233-2" data-line-number="2"><span class="co">#&gt; # A tibble: 22 x 3</span></a>
<a class="sourceLine" id="cb233-3" data-line-number="3"><span class="co">#&gt;    hash             type   name                  </span></a>
<a class="sourceLine" id="cb233-4" data-line-number="4"><span class="co">#&gt;    &lt;chr&gt;            &lt;chr&gt;  &lt;chr&gt;                 </span></a>
<a class="sourceLine" id="cb233-5" data-line-number="5"><span class="co">#&gt;  1 ecb4739b594986b9 target coef_regression1_large</span></a>
<a class="sourceLine" id="cb233-6" data-line-number="6"><span class="co">#&gt;  2 599bea898e306775 target coef_regression1_small</span></a>
<a class="sourceLine" id="cb233-7" data-line-number="7"><span class="co">#&gt;  3 44bfee4c258a76d7 target coef_regression2_large</span></a>
<a class="sourceLine" id="cb233-8" data-line-number="8"><span class="co">#&gt;  4 b5502b9c62933484 target coef_regression2_small</span></a>
<a class="sourceLine" id="cb233-9" data-line-number="9"><span class="co">#&gt;  5 d87293dd4d012762 target large                 </span></a>
<a class="sourceLine" id="cb233-10" data-line-number="10"><span class="co">#&gt;  6 f4b89e63bc92af79 import datasets::mtcars      </span></a>
<a class="sourceLine" id="cb233-11" data-line-number="11"><span class="co">#&gt;  7 1a0869b7fe7a1e57 import file report.Rmd       </span></a>
<a class="sourceLine" id="cb233-12" data-line-number="12"><span class="co">#&gt;  8 6153acbb3f1070de target file report.md        </span></a>
<a class="sourceLine" id="cb233-13" data-line-number="13"><span class="co">#&gt;  9 db84c9f752635a13 import random_rows           </span></a>
<a class="sourceLine" id="cb233-14" data-line-number="14"><span class="co">#&gt; 10 21935c86f12692e2 import reg1                  </span></a>
<a class="sourceLine" id="cb233-15" data-line-number="15"><span class="co">#&gt; # â¦ with 12 more rows</span></a>
<a class="sourceLine" id="cb233-16" data-line-number="16"><span class="kw">make</span>(my_plan, <span class="dt">verbose =</span> 0L, <span class="dt">cache_log_file =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb233-17" data-line-number="17"><span class="kw">read_csv</span>(<span class="st">&quot;drake_cache.csv&quot;</span>, <span class="dt">col_types =</span> <span class="kw">cols</span>())</a>
<a class="sourceLine" id="cb233-18" data-line-number="18"><span class="co">#&gt; # A tibble: 22 x 3</span></a>
<a class="sourceLine" id="cb233-19" data-line-number="19"><span class="co">#&gt;    hash             type   name                  </span></a>
<a class="sourceLine" id="cb233-20" data-line-number="20"><span class="co">#&gt;    &lt;chr&gt;            &lt;chr&gt;  &lt;chr&gt;                 </span></a>
<a class="sourceLine" id="cb233-21" data-line-number="21"><span class="co">#&gt;  1 ecb4739b594986b9 target coef_regression1_large</span></a>
<a class="sourceLine" id="cb233-22" data-line-number="22"><span class="co">#&gt;  2 599bea898e306775 target coef_regression1_small</span></a>
<a class="sourceLine" id="cb233-23" data-line-number="23"><span class="co">#&gt;  3 44bfee4c258a76d7 target coef_regression2_large</span></a>
<a class="sourceLine" id="cb233-24" data-line-number="24"><span class="co">#&gt;  4 b5502b9c62933484 target coef_regression2_small</span></a>
<a class="sourceLine" id="cb233-25" data-line-number="25"><span class="co">#&gt;  5 d87293dd4d012762 target large                 </span></a>
<a class="sourceLine" id="cb233-26" data-line-number="26"><span class="co">#&gt;  6 f4b89e63bc92af79 import datasets::mtcars      </span></a>
<a class="sourceLine" id="cb233-27" data-line-number="27"><span class="co">#&gt;  7 1a0869b7fe7a1e57 import file report.Rmd       </span></a>
<a class="sourceLine" id="cb233-28" data-line-number="28"><span class="co">#&gt;  8 6153acbb3f1070de target file report.md        </span></a>
<a class="sourceLine" id="cb233-29" data-line-number="29"><span class="co">#&gt;  9 db84c9f752635a13 import random_rows           </span></a>
<a class="sourceLine" id="cb233-30" data-line-number="30"><span class="co">#&gt; 10 21935c86f12692e2 import reg1                  </span></a>
<a class="sourceLine" id="cb233-31" data-line-number="31"><span class="co">#&gt; # â¦ with 12 more rows</span></a></code></pre></div>
<p>Use the <code>cache_log_file</code> argument of <code>make()</code> to refresh the cache log file every time you run <code>make()</code>. Then, if you put this file under version control (e.g.Â with git/GitHub) then the commit history will tell you how your data objects change over time.</p>
</div>
<div id="database-caches" class="section level3">
<h3><span class="header-section-number">15.3.2</span> Database caches</h3>
<p>It is possible use a single SQLite database file as the cache.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" data-line-number="1">mydb &lt;-<span class="st"> </span>DBI<span class="op">::</span><span class="kw">dbConnect</span>(RSQLite<span class="op">::</span><span class="kw">SQLite</span>(), <span class="st">&quot;database-file.sqlite&quot;</span>)</a>
<a class="sourceLine" id="cb234-2" data-line-number="2">cache &lt;-<span class="st"> </span>storr<span class="op">::</span><span class="kw">storr_dbi</span>(<span class="st">&quot;datatable&quot;</span>, <span class="st">&quot;keystable&quot;</span>, mydb)</a>
<a class="sourceLine" id="cb234-3" data-line-number="3"><span class="kw">make</span>(my_plan, <span class="dt">cache =</span> cache, <span class="dt">verbose =</span> 0L)</a>
<a class="sourceLine" id="cb234-4" data-line-number="4"><span class="kw">loadd</span>(small, <span class="dt">cache =</span> cache)</a>
<a class="sourceLine" id="cb234-5" data-line-number="5"><span class="kw">head</span>(small)</a>
<a class="sourceLine" id="cb234-6" data-line-number="6"><span class="co">#&gt;       x    y</span></a>
<a class="sourceLine" id="cb234-7" data-line-number="7"><span class="co">#&gt; 1 3.780 15.2</span></a>
<a class="sourceLine" id="cb234-8" data-line-number="8"><span class="co">#&gt; 2 3.440 17.8</span></a>
<a class="sourceLine" id="cb234-9" data-line-number="9"><span class="co">#&gt; 3 3.215 21.4</span></a>
<a class="sourceLine" id="cb234-10" data-line-number="10"><span class="co">#&gt; 4 3.440 19.2</span></a>
<a class="sourceLine" id="cb234-11" data-line-number="11"><span class="co">#&gt; 5 2.770 19.7</span></a>
<a class="sourceLine" id="cb234-12" data-line-number="12"><span class="co">#&gt; 6 2.465 21.5</span></a></code></pre></div>
<p>But be careful: for safe parallel computing (<code>jobs</code> &gt; 1) there are additional requirements for <code>make()</code>:</p>
<ol style="list-style-type: decimal">
<li>Select either <code>parallelism = &quot;clustermq&quot;</code> or <code>parallelism = &quot;future&quot;</code>.</li>
<li>Select <code>caching = &quot;master&quot;</code> to ensure that only the master process touches the cache.</li>
</ol>
<p>For a more complete demonstration, please see <a href="https://github.com/wlandau/drake-examples/tree/master/dbi">this example code</a>, which you can download with <code>drake_example(&quot;dbi&quot;)</code>.</p>
</div>
<div id="environment-caches" class="section level3">
<h3><span class="header-section-number">15.3.3</span> Environment caches</h3>
<p>Environment caches live in computer memory, not your file system, so they are a nice way to run small and fast experiments. However, unless you save the cache manually, all your data will be lost when you quit your R session. And for large projects, you may not be able to fit all your data in memory anyway.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb235-1" data-line-number="1">cache &lt;-<span class="st"> </span><span class="kw">storr_environment</span>()</a>
<a class="sourceLine" id="cb235-2" data-line-number="2"><span class="kw">make</span>(my_plan, <span class="dt">cache =</span> cache)</a></code></pre></div>
</div>
</div>
<div id="hash-algorithms" class="section level2">
<h2><span class="header-section-number">15.4</span> Hash algorithms</h2>
<p><a href="https://github.com/richfitz/storr">storr</a> caches use <a href="https://en.wikipedia.org/wiki/Hash_function">hash functions</a> to keep track of stored objects. A hash function is just a way to fingerprint data. The idea is to represent an arbitrary chunks of data using (nearly) unique strings of fixed size.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" data-line-number="1"><span class="kw">library</span>(digest) <span class="co"># package for hashing objects and files</span></a>
<a class="sourceLine" id="cb236-2" data-line-number="2">smaller_data &lt;-<span class="st"> </span><span class="dv">12</span></a>
<a class="sourceLine" id="cb236-3" data-line-number="3">larger_data &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb236-4" data-line-number="4"></a>
<a class="sourceLine" id="cb236-5" data-line-number="5"><span class="kw">digest</span>(smaller_data) <span class="co"># compute the hash</span></a>
<a class="sourceLine" id="cb236-6" data-line-number="6"><span class="co">#&gt; [1] &quot;23c80a31c0713176016e6e18d76a5f31&quot;</span></a>
<a class="sourceLine" id="cb236-7" data-line-number="7"></a>
<a class="sourceLine" id="cb236-8" data-line-number="8"><span class="kw">digest</span>(larger_data)</a>
<a class="sourceLine" id="cb236-9" data-line-number="9"><span class="co">#&gt; [1] &quot;b03c1a142bc71a1b8afed7d23ce60f9f&quot;</span></a></code></pre></div>
<p>The <code>digest</code> package (used by both <code>drake</code> and <code>storr</code>) supports a wide variety of hash functions. Some generate larger hash keys, some are slower to compute, and others are more prone to âcollisionsâ (where two different data objects are given the same hash key). The <code>digest</code> package supports a variety of hash algorithms.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb237-1" data-line-number="1"><span class="kw">digest</span>(larger_data, <span class="dt">algo =</span> <span class="st">&quot;sha512&quot;</span>)</a>
<a class="sourceLine" id="cb237-2" data-line-number="2"><span class="co">#&gt; [1] &quot;cca91831466b966d82ae4440dea3be3a1b5555f6189563eb3d8b1a83c8c70d68daae9a35f62a00a96fefa241a26ce5c183a7f8a8d584bbbe023acb4b254080e9&quot;</span></a>
<a class="sourceLine" id="cb237-3" data-line-number="3"></a>
<a class="sourceLine" id="cb237-4" data-line-number="4"><span class="kw">digest</span>(larger_data, <span class="dt">algo =</span> <span class="st">&quot;md5&quot;</span>)</a>
<a class="sourceLine" id="cb237-5" data-line-number="5"><span class="co">#&gt; [1] &quot;b03c1a142bc71a1b8afed7d23ce60f9f&quot;</span></a>
<a class="sourceLine" id="cb237-6" data-line-number="6"></a>
<a class="sourceLine" id="cb237-7" data-line-number="7"><span class="kw">digest</span>(larger_data, <span class="dt">algo =</span> <span class="st">&quot;xxhash64&quot;</span>)</a>
<a class="sourceLine" id="cb237-8" data-line-number="8"><span class="co">#&gt; [1] &quot;ec927d1d9050ae96&quot;</span></a>
<a class="sourceLine" id="cb237-9" data-line-number="9"></a>
<a class="sourceLine" id="cb237-10" data-line-number="10"><span class="kw">digest</span>(larger_data, <span class="dt">algo =</span> <span class="st">&quot;murmur32&quot;</span>)</a>
<a class="sourceLine" id="cb237-11" data-line-number="11"><span class="co">#&gt; [1] &quot;6faecd4e&quot;</span></a></code></pre></div>
<p>For <code>drake</code>, the default hash algorithm is <code>xxhash64</code>. You can choose different hash functions with the <code>hash_algorithm</code> argument to <code>new_cache()</code>, <code>storr_rds()</code>, and similar functions. (For <code>drake</code> version 6.2.1 and earlier, see the <code>long_hash_algo</code> and <code>short_hash_algo</code> arguments.)</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" data-line-number="1">cache3 &lt;-<span class="st"> </span><span class="kw">new_cache</span>(<span class="st">&quot;cache_3_path&quot;</span>, <span class="dt">hash_algorithm =</span> <span class="st">&quot;murmur32&quot;</span>)</a>
<a class="sourceLine" id="cb238-2" data-line-number="2">cache4 &lt;-<span class="st"> </span><span class="kw">storr_rds</span>(<span class="st">&quot;cache_4_path&quot;</span>, <span class="dt">hash_algorithm =</span> <span class="st">&quot;crc32&quot;</span>)</a></code></pre></div>

</div>
</div>



</div>
<div style = "background: #1C356D; color: white; padding: 10px 10px 10px 25px; font-size: 1em; width: 100%;">
  Copyright Eli Lilly and Company
</div>
            </section>

          </div>
        </div>
      </div>
<a href="memory.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="visuals.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ropenscilabs/drake-manual/edit/master/storage.Rmd",
"text": "Edit this chapter"
},
"history": {
"link": "https://github.com/ropenscilabs/drake-manual/commits/master/storage.Rmd",
"text": "Chapter edit history"
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
