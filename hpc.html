<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 10 High-performance computing | The drake R Package User Manual</title>
  <meta name="description" content="Chapter 10 High-performance computing | The drake R Package User Manual">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 10 High-performance computing | The drake R Package User Manual" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 High-performance computing | The drake R Package User Manual" />
  
  
  

<meta name="author" content="Will Landau, Kirill Müller, Alex Axthelm, Jasper Clarkberg, Lorenz Walthert">
<meta name="author" content="Copyright Eli Lilly and Company">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="debug.html">
<link rel="next" href="triggers.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.5/visNetwork.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/sankey-1/sankey.js"></script>
<script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-drake-r-package"><i class="fa fa-check"></i><b>1.1</b> The drake R package</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#why-drake"><i class="fa fa-check"></i><b>1.3</b> Why drake?</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#what-gets-done-stays-done."><i class="fa fa-check"></i><b>1.3.1</b> What gets done stays done.</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#reproducibility-with-confidence"><i class="fa fa-check"></i><b>1.3.2</b> Reproducibility with confidence</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#aggressively-scale-up."><i class="fa fa-check"></i><b>1.3.3</b> Aggressively scale up.</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#documentation"><i class="fa fa-check"></i><b>1.4</b> Documentation</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#cheat-sheet"><i class="fa fa-check"></i><b>1.4.1</b> Cheat sheet</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#frequently-asked-questions"><i class="fa fa-check"></i><b>1.4.2</b> Frequently asked questions</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#function-reference"><i class="fa fa-check"></i><b>1.4.3</b> Function reference</a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#tutorials"><i class="fa fa-check"></i><b>1.4.4</b> Tutorials</a></li>
<li class="chapter" data-level="1.4.5" data-path="index.html"><a href="index.html#examples"><i class="fa fa-check"></i><b>1.4.5</b> Examples</a></li>
<li class="chapter" data-level="1.4.6" data-path="index.html"><a href="index.html#presentations"><i class="fa fa-check"></i><b>1.4.6</b> Presentations</a></li>
<li class="chapter" data-level="1.4.7" data-path="index.html"><a href="index.html#real-example-projects"><i class="fa fa-check"></i><b>1.4.7</b> Real example projects</a></li>
<li class="chapter" data-level="1.4.8" data-path="index.html"><a href="index.html#context-and-history"><i class="fa fa-check"></i><b>1.4.8</b> Context and history</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#help-and-troubleshooting"><i class="fa fa-check"></i><b>1.5</b> Help and troubleshooting</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#similar-work"><i class="fa fa-check"></i><b>1.6</b> Similar work</a><ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#gnu-make"><i class="fa fa-check"></i><b>1.6.1</b> GNU Make</a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#remake"><i class="fa fa-check"></i><b>1.6.2</b> Remake</a></li>
<li class="chapter" data-level="1.6.3" data-path="index.html"><a href="index.html#memoise"><i class="fa fa-check"></i><b>1.6.3</b> Memoise</a></li>
<li class="chapter" data-level="1.6.4" data-path="index.html"><a href="index.html#knitr-and-r-markdown"><i class="fa fa-check"></i><b>1.6.4</b> Knitr and R Markdown</a></li>
<li class="chapter" data-level="1.6.5" data-path="index.html"><a href="index.html#factuals-drake"><i class="fa fa-check"></i><b>1.6.5</b> Factual’s Drake</a></li>
<li class="chapter" data-level="1.6.6" data-path="index.html"><a href="index.html#other-pipeline-toolkits"><i class="fa fa-check"></i><b>1.6.6</b> Other pipeline toolkits</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.7</b> Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>I Examples</b></span></li>
<li class="chapter" data-level="2" data-path="main.html"><a href="main.html"><i class="fa fa-check"></i><b>2</b> The main example</a><ul>
<li class="chapter" data-level="2.1" data-path="main.html"><a href="main.html#set-the-stage."><i class="fa fa-check"></i><b>2.1</b> Set the stage.</a></li>
<li class="chapter" data-level="2.2" data-path="main.html"><a href="main.html#make-your-results."><i class="fa fa-check"></i><b>2.2</b> Make your results.</a></li>
<li class="chapter" data-level="2.3" data-path="main.html"><a href="main.html#go-back-and-fix-things."><i class="fa fa-check"></i><b>2.3</b> Go back and fix things.</a></li>
<li class="chapter" data-level="2.4" data-path="main.html"><a href="main.html#try-it-yourself"><i class="fa fa-check"></i><b>2.4</b> Try it yourself!</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>3</b> An analysis of R package download trends</a><ul>
<li class="chapter" data-level="3.1" data-path="packages.html"><a href="packages.html#get-the-code."><i class="fa fa-check"></i><b>3.1</b> Get the code.</a></li>
<li class="chapter" data-level="3.2" data-path="packages.html"><a href="packages.html#overview"><i class="fa fa-check"></i><b>3.2</b> Overview</a></li>
<li class="chapter" data-level="3.3" data-path="packages.html"><a href="packages.html#analysis"><i class="fa fa-check"></i><b>3.3</b> Analysis</a></li>
<li class="chapter" data-level="3.4" data-path="packages.html"><a href="packages.html#other-ways-to-trigger-downloads"><i class="fa fa-check"></i><b>3.4</b> Other ways to trigger downloads</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="gsp.html"><a href="gsp.html"><i class="fa fa-check"></i><b>4</b> Finding the best model of gross state product</a><ul>
<li class="chapter" data-level="4.1" data-path="gsp.html"><a href="gsp.html#get-the-code.-1"><i class="fa fa-check"></i><b>4.1</b> Get the code.</a></li>
<li class="chapter" data-level="4.2" data-path="gsp.html"><a href="gsp.html#objective-and-methods"><i class="fa fa-check"></i><b>4.2</b> Objective and methods</a></li>
<li class="chapter" data-level="4.3" data-path="gsp.html"><a href="gsp.html#data"><i class="fa fa-check"></i><b>4.3</b> Data</a></li>
<li class="chapter" data-level="4.4" data-path="gsp.html"><a href="gsp.html#analysis-1"><i class="fa fa-check"></i><b>4.4</b> Analysis</a></li>
<li class="chapter" data-level="4.5" data-path="gsp.html"><a href="gsp.html#results"><i class="fa fa-check"></i><b>4.5</b> Results</a></li>
<li class="chapter" data-level="4.6" data-path="gsp.html"><a href="gsp.html#comparison-with-gnu-make"><i class="fa fa-check"></i><b>4.6</b> Comparison with GNU Make</a></li>
<li class="chapter" data-level="4.7" data-path="gsp.html"><a href="gsp.html#references"><i class="fa fa-check"></i><b>4.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mtcars.html"><a href="mtcars.html"><i class="fa fa-check"></i><b>5</b> The mtcars example and <code>drake</code> plan generation</a><ul>
<li class="chapter" data-level="5.1" data-path="mtcars.html"><a href="mtcars.html#get-the-code.-2"><i class="fa fa-check"></i><b>5.1</b> Get the code.</a></li>
<li class="chapter" data-level="5.2" data-path="mtcars.html"><a href="mtcars.html#quick-examples"><i class="fa fa-check"></i><b>5.2</b> Quick examples</a></li>
<li class="chapter" data-level="5.3" data-path="mtcars.html"><a href="mtcars.html#the-motivation-of-the-mtcars-example"><i class="fa fa-check"></i><b>5.3</b> The motivation of the mtcars example</a></li>
<li class="chapter" data-level="5.4" data-path="mtcars.html"><a href="mtcars.html#set-up-the-mtcars-example"><i class="fa fa-check"></i><b>5.4</b> Set up the mtcars example</a></li>
<li class="chapter" data-level="5.5" data-path="mtcars.html"><a href="mtcars.html#the-drake-plan"><i class="fa fa-check"></i><b>5.5</b> The <code>drake</code> plan</a></li>
<li class="chapter" data-level="5.6" data-path="mtcars.html"><a href="mtcars.html#generate-the-plan"><i class="fa fa-check"></i><b>5.6</b> Generate the plan</a><ul>
<li class="chapter" data-level="5.6.1" data-path="mtcars.html"><a href="mtcars.html#the-easy-way"><i class="fa fa-check"></i><b>5.6.1</b> The easy way</a></li>
<li class="chapter" data-level="5.6.2" data-path="mtcars.html"><a href="mtcars.html#the-old-way"><i class="fa fa-check"></i><b>5.6.2</b> The old way</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="mtcars.html"><a href="mtcars.html#run-the-workflow"><i class="fa fa-check"></i><b>5.7</b> Run the workflow</a></li>
</ul></li>
<li class="part"><span><b>II Functionality</b></span></li>
<li class="chapter" data-level="6" data-path="plans.html"><a href="plans.html"><i class="fa fa-check"></i><b>6</b> <code>drake</code> plans</a><ul>
<li class="chapter" data-level="6.1" data-path="plans.html"><a href="plans.html#what-is-a-drake-plan"><i class="fa fa-check"></i><b>6.1</b> What is a <code>drake</code> plan?</a></li>
<li class="chapter" data-level="6.2" data-path="plans.html"><a href="plans.html#plans-are-similar-to-r-scripts."><i class="fa fa-check"></i><b>6.2</b> Plans are similar to R scripts.</a></li>
<li class="chapter" data-level="6.3" data-path="plans.html"><a href="plans.html#so-why-do-we-use-plans"><i class="fa fa-check"></i><b>6.3</b> So why do we use plans?</a><ul>
<li class="chapter" data-level="6.3.1" data-path="plans.html"><a href="plans.html#plans-chop-up-the-work-into-pieces."><i class="fa fa-check"></i><b>6.3.1</b> Plans chop up the work into pieces.</a></li>
<li class="chapter" data-level="6.3.2" data-path="plans.html"><a href="plans.html#drake-uses-plans-to-schedule-you-work."><i class="fa fa-check"></i><b>6.3.2</b> <code>drake</code> uses plans to schedule you work.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="plans.html"><a href="plans.html#special-custom-columns-in-your-plan."><i class="fa fa-check"></i><b>6.4</b> Special custom columns in your plan.</a></li>
<li class="chapter" data-level="6.5" data-path="plans.html"><a href="plans.html#large-plans"><i class="fa fa-check"></i><b>6.5</b> Large plans</a><ul>
<li class="chapter" data-level="6.5.1" data-path="plans.html"><a href="plans.html#how-to-create-large-plans"><i class="fa fa-check"></i><b>6.5.1</b> How to create large plans</a></li>
<li class="chapter" data-level="6.5.2" data-path="plans.html"><a href="plans.html#the-types-of-transformations"><i class="fa fa-check"></i><b>6.5.2</b> The types of transformations</a></li>
<li class="chapter" data-level="6.5.3" data-path="plans.html"><a href="plans.html#grouping-variables"><i class="fa fa-check"></i><b>6.5.3</b> Grouping variables</a></li>
<li class="chapter" data-level="6.5.4" data-path="plans.html"><a href="plans.html#tags"><i class="fa fa-check"></i><b>6.5.4</b> Tags</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="plans.html"><a href="plans.html#create-large-plans-the-old-way"><i class="fa fa-check"></i><b>6.6</b> Create large plans the <em>old</em> way</a><ul>
<li class="chapter" data-level="6.6.1" data-path="plans.html"><a href="plans.html#map_plan"><i class="fa fa-check"></i><b>6.6.1</b> <code>map_plan()</code></a></li>
<li class="chapter" data-level="6.6.2" data-path="plans.html"><a href="plans.html#wildcard-templating"><i class="fa fa-check"></i><b>6.6.2</b> Wildcard templating</a></li>
<li class="chapter" data-level="6.6.3" data-path="plans.html"><a href="plans.html#wildcard-clusters"><i class="fa fa-check"></i><b>6.6.3</b> Wildcard clusters</a></li>
<li class="chapter" data-level="6.6.4" data-path="plans.html"><a href="plans.html#non-wildcard-functions"><i class="fa fa-check"></i><b>6.6.4</b> Non-wildcard functions</a></li>
<li class="chapter" data-level="6.6.5" data-path="plans.html"><a href="plans.html#custom-metaprogramming"><i class="fa fa-check"></i><b>6.6.5</b> Custom metaprogramming</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="organize.html"><a href="organize.html"><i class="fa fa-check"></i><b>7</b> How to organize the files of drake projects</a><ul>
<li class="chapter" data-level="7.1" data-path="organize.html"><a href="organize.html#examples-1"><i class="fa fa-check"></i><b>7.1</b> Examples</a></li>
<li class="chapter" data-level="7.2" data-path="organize.html"><a href="organize.html#where-do-you-put-your-code"><i class="fa fa-check"></i><b>7.2</b> Where do you put your code?</a></li>
<li class="chapter" data-level="7.3" data-path="organize.html"><a href="organize.html#your-commands-are-code-chunks-not-r-scripts"><i class="fa fa-check"></i><b>7.3</b> Your commands are code chunks, not R scripts</a></li>
<li class="chapter" data-level="7.4" data-path="organize.html"><a href="organize.html#workflows-as-r-packages"><i class="fa fa-check"></i><b>7.4</b> Workflows as R packages</a><ul>
<li class="chapter" data-level="7.4.1" data-path="organize.html"><a href="organize.html#advantages-of-putting-workflows-in-r-packages"><i class="fa fa-check"></i><b>7.4.1</b> Advantages of putting workflows in R packages</a></li>
<li class="chapter" data-level="7.4.2" data-path="organize.html"><a href="organize.html#the-problem"><i class="fa fa-check"></i><b>7.4.2</b> The problem</a></li>
<li class="chapter" data-level="7.4.3" data-path="organize.html"><a href="organize.html#the-solution"><i class="fa fa-check"></i><b>7.4.3</b> The solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="vis.html"><a href="vis.html"><i class="fa fa-check"></i><b>8</b> Visualization with drake</a><ul>
<li class="chapter" data-level="8.0.1" data-path="vis.html"><a href="vis.html#vis_drake_graph"><i class="fa fa-check"></i><b>8.0.1</b> <code>vis_drake_graph()</code></a></li>
<li class="chapter" data-level="8.0.2" data-path="vis.html"><a href="vis.html#sankey_drake_graph"><i class="fa fa-check"></i><b>8.0.2</b> <code>sankey_drake_graph()</code></a></li>
<li class="chapter" data-level="8.0.3" data-path="vis.html"><a href="vis.html#drake_ggraph"><i class="fa fa-check"></i><b>8.0.3</b> <code>drake_ggraph()</code></a></li>
<li class="chapter" data-level="8.1" data-path="vis.html"><a href="vis.html#underlying-graph-data-node-and-edge-data-frames"><i class="fa fa-check"></i><b>8.1</b> Underlying graph data: node and edge data frames</a></li>
<li class="chapter" data-level="8.2" data-path="vis.html"><a href="vis.html#visualizing-target-status"><i class="fa fa-check"></i><b>8.2</b> Visualizing target status</a></li>
<li class="chapter" data-level="8.3" data-path="vis.html"><a href="vis.html#subgraphs"><i class="fa fa-check"></i><b>8.3</b> Subgraphs</a></li>
<li class="chapter" data-level="8.4" data-path="vis.html"><a href="vis.html#control-the-vis_drake_graph-legend."><i class="fa fa-check"></i><b>8.4</b> Control the <code>vis_drake_graph()</code> legend.</a></li>
<li class="chapter" data-level="8.5" data-path="vis.html"><a href="vis.html#clusters"><i class="fa fa-check"></i><b>8.5</b> Clusters</a></li>
<li class="chapter" data-level="8.6" data-path="vis.html"><a href="vis.html#output-files"><i class="fa fa-check"></i><b>8.6</b> Output files</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="debug.html"><a href="debug.html"><i class="fa fa-check"></i><b>9</b> Debugging and testing drake projects</a><ul>
<li class="chapter" data-level="9.1" data-path="debug.html"><a href="debug.html#dependencies"><i class="fa fa-check"></i><b>9.1</b> Dependencies</a><ul>
<li class="chapter" data-level="9.1.1" data-path="debug.html"><a href="debug.html#visualize-your-dependency-graph."><i class="fa fa-check"></i><b>9.1.1</b> Visualize your dependency graph.</a></li>
<li class="chapter" data-level="9.1.2" data-path="debug.html"><a href="debug.html#check-specific-dependency-information."><i class="fa fa-check"></i><b>9.1.2</b> Check specific dependency information.</a></li>
<li class="chapter" data-level="9.1.3" data-path="debug.html"><a href="debug.html#outdated-targets-and-missing-dependencies"><i class="fa fa-check"></i><b>9.1.3</b> Outdated targets and missing dependencies</a></li>
<li class="chapter" data-level="9.1.4" data-path="debug.html"><a href="debug.html#but-why-are-my-targets-out-of-date"><i class="fa fa-check"></i><b>9.1.4</b> But <em>why</em> are my targets out of date?</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="debug.html"><a href="debug.html#diagnose-failures."><i class="fa fa-check"></i><b>9.2</b> Diagnose failures.</a></li>
<li class="chapter" data-level="9.3" data-path="debug.html"><a href="debug.html#timeouts-and-retries"><i class="fa fa-check"></i><b>9.3</b> Timeouts and retries</a></li>
<li class="chapter" data-level="9.4" data-path="debug.html"><a href="debug.html#more-help"><i class="fa fa-check"></i><b>9.4</b> More help</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="hpc.html"><a href="hpc.html"><i class="fa fa-check"></i><b>10</b> High-performance computing</a><ul>
<li class="chapter" data-level="10.1" data-path="hpc.html"><a href="hpc.html#batch-mode-for-long-workflows"><i class="fa fa-check"></i><b>10.1</b> Batch mode for long workflows</a></li>
<li class="chapter" data-level="10.2" data-path="hpc.html"><a href="hpc.html#let-make-schedule-your-targets."><i class="fa fa-check"></i><b>10.2</b> Let <code>make()</code> schedule your targets.</a></li>
<li class="chapter" data-level="10.3" data-path="hpc.html"><a href="hpc.html#parallel-backends"><i class="fa fa-check"></i><b>10.3</b> Parallel backends</a></li>
<li class="chapter" data-level="10.4" data-path="hpc.html"><a href="hpc.html#the-clustermq-backend"><i class="fa fa-check"></i><b>10.4</b> The <code>clustermq</code> backend</a><ul>
<li class="chapter" data-level="10.4.1" data-path="hpc.html"><a href="hpc.html#persistent-workers"><i class="fa fa-check"></i><b>10.4.1</b> Persistent workers</a></li>
<li class="chapter" data-level="10.4.2" data-path="hpc.html"><a href="hpc.html#installation-1"><i class="fa fa-check"></i><b>10.4.2</b> Installation</a></li>
<li class="chapter" data-level="10.4.3" data-path="hpc.html"><a href="hpc.html#on-your-local-machine"><i class="fa fa-check"></i><b>10.4.3</b> On your local machine</a></li>
<li class="chapter" data-level="10.4.4" data-path="hpc.html"><a href="hpc.html#on-a-cluster"><i class="fa fa-check"></i><b>10.4.4</b> On a cluster</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="hpc.html"><a href="hpc.html#the-future-backend"><i class="fa fa-check"></i><b>10.5</b> The <code>future</code> backend</a><ul>
<li class="chapter" data-level="10.5.1" data-path="hpc.html"><a href="hpc.html#transient-workers"><i class="fa fa-check"></i><b>10.5.1</b> Transient workers</a></li>
<li class="chapter" data-level="10.5.2" data-path="hpc.html"><a href="hpc.html#installation-2"><i class="fa fa-check"></i><b>10.5.2</b> Installation</a></li>
<li class="chapter" data-level="10.5.3" data-path="hpc.html"><a href="hpc.html#on-your-local-machine-1"><i class="fa fa-check"></i><b>10.5.3</b> On your local machine</a></li>
<li class="chapter" data-level="10.5.4" data-path="hpc.html"><a href="hpc.html#on-a-cluster-1"><i class="fa fa-check"></i><b>10.5.4</b> On a cluster</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="hpc.html"><a href="hpc.html#advanced-options"><i class="fa fa-check"></i><b>10.6</b> Advanced options</a><ul>
<li class="chapter" data-level="10.6.1" data-path="hpc.html"><a href="hpc.html#memory"><i class="fa fa-check"></i><b>10.6.1</b> Memory</a></li>
<li class="chapter" data-level="10.6.2" data-path="hpc.html"><a href="hpc.html#storage"><i class="fa fa-check"></i><b>10.6.2</b> Storage</a></li>
<li class="chapter" data-level="10.6.3" data-path="hpc.html"><a href="hpc.html#the-template-argument-for-persistent-workers"><i class="fa fa-check"></i><b>10.6.3</b> The <code>template</code> argument for persistent workers</a></li>
<li class="chapter" data-level="10.6.4" data-path="hpc.html"><a href="hpc.html#the-resources-column-for-transient-workers"><i class="fa fa-check"></i><b>10.6.4</b> The <code>resources</code> column for transient workers</a></li>
<li class="chapter" data-level="10.6.5" data-path="hpc.html"><a href="hpc.html#custom-job-schedulers"><i class="fa fa-check"></i><b>10.6.5</b> Custom job schedulers</a></li>
<li class="chapter" data-level="10.6.6" data-path="hpc.html"><a href="hpc.html#parallel-computing-within-targets"><i class="fa fa-check"></i><b>10.6.6</b> Parallel computing <em>within</em> targets</a></li>
<li class="chapter" data-level="10.6.7" data-path="hpc.html"><a href="hpc.html#hasty-mode"><i class="fa fa-check"></i><b>10.6.7</b> Hasty mode</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="triggers.html"><a href="triggers.html"><i class="fa fa-check"></i><b>11</b> Triggers: decision rules for building targets</a><ul>
<li class="chapter" data-level="11.1" data-path="triggers.html"><a href="triggers.html#what-are-triggers"><i class="fa fa-check"></i><b>11.1</b> What are triggers?</a></li>
<li class="chapter" data-level="11.2" data-path="triggers.html"><a href="triggers.html#customization"><i class="fa fa-check"></i><b>11.2</b> Customization</a></li>
<li class="chapter" data-level="11.3" data-path="triggers.html"><a href="triggers.html#alternative-trigger-modes"><i class="fa fa-check"></i><b>11.3</b> Alternative trigger modes</a></li>
<li class="chapter" data-level="11.4" data-path="triggers.html"><a href="triggers.html#consider-hasty-mode"><i class="fa fa-check"></i><b>11.4</b> Consider hasty mode</a></li>
<li class="chapter" data-level="11.5" data-path="triggers.html"><a href="triggers.html#a-more-practical-example"><i class="fa fa-check"></i><b>11.5</b> A more practical example</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="time.html"><a href="time.html"><i class="fa fa-check"></i><b>12</b> Time: logging, prediction, and strategy</a><ul>
<li class="chapter" data-level="12.1" data-path="time.html"><a href="time.html#predict-total-runtime"><i class="fa fa-check"></i><b>12.1</b> Predict total runtime</a></li>
<li class="chapter" data-level="12.2" data-path="time.html"><a href="time.html#strategize-your-high-performance-computing"><i class="fa fa-check"></i><b>12.2</b> Strategize your high-performance computing</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="store.html"><a href="store.html"><i class="fa fa-check"></i><b>13</b> Storage</a><ul>
<li class="chapter" data-level="13.1" data-path="store.html"><a href="store.html#cache-formats"><i class="fa fa-check"></i><b>13.1</b> Cache formats</a><ul>
<li class="chapter" data-level="13.1.1" data-path="store.html"><a href="store.html#rds-caches"><i class="fa fa-check"></i><b>13.1.1</b> RDS caches</a></li>
<li class="chapter" data-level="13.1.2" data-path="store.html"><a href="store.html#database-caches"><i class="fa fa-check"></i><b>13.1.2</b> Database caches</a></li>
<li class="chapter" data-level="13.1.3" data-path="store.html"><a href="store.html#environment-caches"><i class="fa fa-check"></i><b>13.1.3</b> Environment caches</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="store.html"><a href="store.html#hash-algorithms"><i class="fa fa-check"></i><b>13.2</b> Hash algorithms</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>A</b> Frequently-asked questions</a></li>
<li class="chapter" data-level="B" data-path="caution.html"><a href="caution.html"><i class="fa fa-check"></i><b>B</b> Cautionary notes</a><ul>
<li class="chapter" data-level="B.1" data-path="caution.html"><a href="caution.html#workflow-plans"><i class="fa fa-check"></i><b>B.1</b> Workflow plans</a><ul>
<li class="chapter" data-level="B.1.1" data-path="caution.html"><a href="caution.html#externalizing-commands-in-r-script-files"><i class="fa fa-check"></i><b>B.1.1</b> Externalizing commands in R script files</a></li>
<li class="chapter" data-level="B.1.2" data-path="caution.html"><a href="caution.html#commands-are-not-perfectly-flexible."><i class="fa fa-check"></i><b>B.1.2</b> Commands are NOT perfectly flexible.</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="caution.html"><a href="caution.html#execution"><i class="fa fa-check"></i><b>B.2</b> Execution</a><ul>
<li class="chapter" data-level="B.2.1" data-path="caution.html"><a href="caution.html#install-drake-properly."><i class="fa fa-check"></i><b>B.2.1</b> Install <code>drake</code> properly.</a></li>
<li class="chapter" data-level="B.2.2" data-path="caution.html"><a href="caution.html#install-all-your-packages."><i class="fa fa-check"></i><b>B.2.2</b> Install all your packages.</a></li>
<li class="chapter" data-level="B.2.3" data-path="caution.html"><a href="caution.html#a-note-on-tidy-evaluation"><i class="fa fa-check"></i><b>B.2.3</b> A note on tidy evaluation</a></li>
<li class="chapter" data-level="B.2.4" data-path="caution.html"><a href="caution.html#find-and-diagnose-your-errors."><i class="fa fa-check"></i><b>B.2.4</b> Find and diagnose your errors.</a></li>
<li class="chapter" data-level="B.2.5" data-path="caution.html"><a href="caution.html#refresh-the-drake_config-list-early-and-often."><i class="fa fa-check"></i><b>B.2.5</b> Refresh the <code>drake_config()</code> list early and often.</a></li>
<li class="chapter" data-level="B.2.6" data-path="caution.html"><a href="caution.html#workflows-as-r-packages."><i class="fa fa-check"></i><b>B.2.6</b> Workflows as R packages.</a></li>
<li class="chapter" data-level="B.2.7" data-path="caution.html"><a href="caution.html#the-lazy_load-flag-does-not-work-with-parlapply-parallelism."><i class="fa fa-check"></i><b>B.2.7</b> The <code>lazy_load</code> flag does not work with <code>&quot;parLapply&quot;</code> parallelism.</a></li>
<li class="chapter" data-level="B.2.8" data-path="caution.html"><a href="caution.html#timeouts-may-be-unreliable."><i class="fa fa-check"></i><b>B.2.8</b> Timeouts may be unreliable.</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="caution.html"><a href="caution.html#dependencies-1"><i class="fa fa-check"></i><b>B.3</b> Dependencies</a><ul>
<li class="chapter" data-level="B.3.1" data-path="caution.html"><a href="caution.html#objects-that-contain-functions-may-rebuild-too-often"><i class="fa fa-check"></i><b>B.3.1</b> Objects that contain functions may rebuild too often</a></li>
<li class="chapter" data-level="B.3.2" data-path="caution.html"><a href="caution.html#dependencies-are-not-tracked-in-some-edge-cases."><i class="fa fa-check"></i><b>B.3.2</b> Dependencies are not tracked in some edge cases.</a></li>
<li class="chapter" data-level="B.3.3" data-path="caution.html"><a href="caution.html#dependencies-of-knitr-reports"><i class="fa fa-check"></i><b>B.3.3</b> Dependencies of <code>knitr</code> reports</a></li>
<li class="chapter" data-level="B.3.4" data-path="caution.html"><a href="caution.html#s3-and-generic-methods"><i class="fa fa-check"></i><b>B.3.4</b> S3 and generic methods</a></li>
<li class="chapter" data-level="B.3.5" data-path="caution.html"><a href="caution.html#file-outputs-in-imported-functions."><i class="fa fa-check"></i><b>B.3.5</b> File outputs in imported functions.</a></li>
<li class="chapter" data-level="B.3.6" data-path="caution.html"><a href="caution.html#functions-produced-by-vectorize"><i class="fa fa-check"></i><b>B.3.6</b> Functions produced by <code>Vectorize()</code></a></li>
<li class="chapter" data-level="B.3.7" data-path="caution.html"><a href="caution.html#compiled-code-is-not-reproducibly-tracked."><i class="fa fa-check"></i><b>B.3.7</b> Compiled code is not reproducibly tracked.</a></li>
<li class="chapter" data-level="B.3.8" data-path="caution.html"><a href="caution.html#directories-folders-are-not-reproducibly-tracked."><i class="fa fa-check"></i><b>B.3.8</b> Directories (folders) are not reproducibly tracked.</a></li>
<li class="chapter" data-level="B.3.9" data-path="caution.html"><a href="caution.html#packages-are-not-tracked-as-dependencies."><i class="fa fa-check"></i><b>B.3.9</b> Packages are not tracked as dependencies.</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="caution.html"><a href="caution.html#high-performance-computing"><i class="fa fa-check"></i><b>B.4</b> High-performance computing</a><ul>
<li class="chapter" data-level="B.4.1" data-path="caution.html"><a href="caution.html#calling-mclapply-within-targets"><i class="fa fa-check"></i><b>B.4.1</b> Calling <code>mclapply()</code> <em>within</em> targets</a></li>
<li class="chapter" data-level="B.4.2" data-path="caution.html"><a href="caution.html#zombie-processes"><i class="fa fa-check"></i><b>B.4.2</b> Zombie processes</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="caution.html"><a href="caution.html#storage-1"><i class="fa fa-check"></i><b>B.5</b> Storage</a><ul>
<li class="chapter" data-level="B.5.1" data-path="caution.html"><a href="caution.html#projects-hosted-on-dropbox-and-similar-platforms"><i class="fa fa-check"></i><b>B.5.1</b> Projects hosted on Dropbox and similar platforms</a></li>
<li class="chapter" data-level="B.5.2" data-path="caution.html"><a href="caution.html#cache-customization-is-limited"><i class="fa fa-check"></i><b>B.5.2</b> Cache customization is limited</a></li>
<li class="chapter" data-level="B.5.3" data-path="caution.html"><a href="caution.html#runtime-predictions"><i class="fa fa-check"></i><b>B.5.3</b> Runtime predictions</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The drake R Package User Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hpc" class="section level1">
<h1><span class="header-section-number">Chapter 10</span> High-performance computing</h1>
<p>This chapter provides guidance on time-consuming <code>drake</code> workflows and high-level parallel computation.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(drake)
<span class="kw">load_mtcars_example</span>()
<span class="kw">make</span>(my_plan, <span class="dt">jobs =</span> <span class="dv">2</span>)</code></pre>
<div id="batch-mode-for-long-workflows" class="section level2">
<h2><span class="header-section-number">10.1</span> Batch mode for long workflows</h2>
<p>If you expect <code>make()</code> to take a long time, create a master script for your project (say, <code>drake-work.R</code>) and run it in a persistent background process. The following should work in the Mac/Linux terminal/shell.</p>
<pre><code>nohup nice -19 R CMD BATCH drake_work.R &
</code></pre>
<p>where:</p>
<ul>
<li><code>nohup</code>: Keep the job running even if you log out of the machine.</li>
<li><code>nice -19</code>: This is a low-priority job that should not consume many resources. Other processes should take priority.</li>
<li><code>R CMD BATCH drake_work.R</code>: Run the <code>drake_work.R</code> script in a new R session.</li>
<li><code>&amp;</code>: Run this job in the background so you can do other stuff in the terminal window.</li>
</ul>
</div>
<div id="let-make-schedule-your-targets." class="section level2">
<h2><span class="header-section-number">10.2</span> Let <code>make()</code> schedule your targets.</h2>
<p><code>drake</code> uses your project’s implicit dependency graph to figure out which targets can run in parallel and which ones need to wait for dependencies.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load_mtcars_example</span>()
config &lt;-<span class="st"> </span><span class="kw">drake_config</span>(my_plan)
<span class="kw">vis_drake_graph</span>(config)</code></pre>
<div id="htmlwidget-92df6dc4b24a7010e973" style="width:576px;height:576px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-92df6dc4b24a7010e973">{"x":{"nodes":{"id":["coef_regression1_large","coef_regression1_small","coef_regression2_large","coef_regression2_small","large","n-MRQXIYLTMV2HGOR2NV2GGYLSOM","p-OJSXA33SOQXFE3LE","p-OJSXA33SOQXG2ZA","random_rows","reg1","reg2","regression1_large","regression1_small","regression2_large","regression2_small","report","simulate","small","summ_regression1_large","summ_regression1_small","summ_regression2_large","summ_regression2_small","x2"],"imported":[false,false,false,false,false,true,true,false,true,true,true,false,false,false,false,false,true,false,false,false,false,false,true],"label":["coef_regression1_large","coef_regression1_small","coef_regression2_large","coef_regression2_small","large","datasets::mtcars","file report.Rmd","file report.md","random_rows","reg1","reg2","regression1_large","regression1_small","regression2_large","regression2_small","report","simulate","small","summ_regression1_large","summ_regression1_small","summ_regression2_large","summ_regression2_small","x2"],"command":["suppressWarnings(summary(regression1_large))$coefficients","suppressWarnings(summary(regression1_small))$coefficients","suppressWarnings(summary(regression2_large))$coefficients","suppressWarnings(summary(regression2_small))$coefficients","simulate(64)",null,null,"knit(knitr_in(\"report.Rmd\"), file_out(\"report.md\"), quiet = TRUE)",null,null,null,"reg1(large)","reg1(small)","reg2(large)","reg2(small)","knit(knitr_in(\"report.Rmd\"), file_out(\"report.md\"), quiet = TRUE)",null,"simulate(48)","suppressWarnings(summary(regression1_large$residuals))","suppressWarnings(summary(regression1_small$residuals))","suppressWarnings(summary(regression2_large$residuals))","suppressWarnings(summary(regression2_small$residuals))",null],"status":["outdated","outdated","outdated","outdated","outdated","imported","imported","outdated","imported","imported","imported","outdated","outdated","outdated","outdated","outdated","imported","outdated","outdated","outdated","outdated","outdated","imported"],"type":["object","object","object","object","object","object","file","object","function","function","function","object","object","object","object","object","function","object","object","object","object","object","object"],"font.size":[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],"color":["#000000","#000000","#000000","#000000","#000000","#1874CD","#1874CD","#000000","#1874CD","#1874CD","#1874CD","#000000","#000000","#000000","#000000","#000000","#1874CD","#000000","#000000","#000000","#000000","#000000","#1874CD"],"shape":["dot","dot","dot","dot","dot","dot","square","square","triangle","triangle","triangle","dot","dot","dot","dot","dot","triangle","dot","dot","dot","dot","dot","dot"],"level":[5,5,5,5,3,1,1,7,1,1,2,4,4,4,4,6,2,3,5,5,5,5,1],"title":["suppressWarnings(summary(regression1_large))$c...","suppressWarnings(summary(regression1_small))$c...","suppressWarnings(summary(regression2_large))$c...","suppressWarnings(summary(regression2_small))$c...","simulate(64)","n-MRQXIYLTMV2HGOR2NV2GGYLSOM","---<br>title: \"Final results report for the mtcars ex...<br>author: You<br>output: html_document<br>---<br><br># The weight and fuel efficiency of cars<br><br>Is there an association between the weight and...<br>...","knit(knitr_in(\"report.Rmd\"),&nbsp;file_out(\"report....","function&nbsp;(data,&nbsp;n)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;data[sample.int(n&nbsp;=&nbsp;...","function&nbsp;(d)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;lm(y&nbsp;~&nbsp;+x,&nbsp;data&nbsp;=&nbsp;d)<br>}","function&nbsp;(d)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;d$x2&nbsp;<-&nbsp;d$x^2<br>&nbsp;&nbsp;&nbsp;&nbsp;lm(y&nbsp;~&nbsp;x...","reg1(large)","reg1(small)","reg2(large)","reg2(small)","knit(knitr_in(\"report.Rmd\"),&nbsp;file_out(\"report....","function&nbsp;(n)&nbsp;<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;<-&nbsp;random_rows(data&nbsp;=...","simulate(48)","suppressWarnings(summary(regression1_large$res...","suppressWarnings(summary(regression1_small$res...","suppressWarnings(summary(regression2_large$res...","suppressWarnings(summary(regression2_small$res...","x2"],"x":[0.1,1,0.4,-0.1,-0.9,-0.8,-1,-1,-0.6,-0.2,0.5,-0.1,0.9,0.3,0.6,-1,-0.8,0,-0.5,0.6,-0.3,0.8,0.6],"y":[0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,-0.333333333333333,-1,-1,1,-1,-1,-0.666666666666667,0,0,0,0,0.666666666666667,-0.666666666666667,-0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,-1]},"edges":{"from":["x2","random_rows","n-MRQXIYLTMV2HGOR2NV2GGYLSOM","reg1","reg1","large","large","large","small","small","small","coef_regression2_small","p-OJSXA33SOQXFE3LE","report","simulate","simulate","reg2","reg2","regression1_small","regression1_small","regression1_large","regression1_large","regression2_small","regression2_small","regression2_large","regression2_large"],"to":["reg2","simulate","simulate","regression1_small","regression1_large","report","regression1_large","regression2_large","report","regression1_small","regression2_small","report","report","p-OJSXA33SOQXG2ZA","large","small","regression2_small","regression2_large","summ_regression1_small","coef_regression1_small","summ_regression1_large","coef_regression1_large","coef_regression2_small","summ_regression2_small","summ_regression2_large","coef_regression2_large"],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"smooth":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"layout":{"hierarchical":{"enabled":true,"direction":"LR"}},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"navigationButtons":true}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)"},"main":{"text":"Dependency graph","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":false,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":true,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["Outdated","Imported","Object","Function","File"],"color":["#000000","#1874CD","#888888","#888888","#888888"],"shape":["dot","dot","dot","triangle","square"],"font.color":["black","black","black","black","black"],"font.size":[20,20,20,20,20],"id":[2,5,7,8,9]},"nodesToDataframe":true},"igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
<p>You do not need to not micromanage the timing among targets, and you do not need to run parallel instances of <code>make()</code>. As the next sections describe, <code>drake</code> has built-in parallel and distributed computing support.</p>
</div>
<div id="parallel-backends" class="section level2">
<h2><span class="header-section-number">10.3</span> Parallel backends</h2>
<p>Choose the parallel backend with the <code>parallelism</code> argument and set the <code>jobs</code> argument to scale the work appropriately.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">make</span>(my_plan, <span class="dt">parallelism =</span> <span class="st">&quot;future&quot;</span>, <span class="dt">jobs =</span> <span class="dv">2</span>)</code></pre>
<p>The two primary backends with long term support are <a href="https://github.com/mschubert/clustermq"><code>clustermq</code></a> and <a href="https://github.com/HenrikBengtsson/future"><code>future</code></a>. If you can install <a href="http://zeromq.org">ZeroMQ</a>, the best choice is usually <a href="https://github.com/mschubert/clustermq"><code>clustermq</code></a>. (It is faster than <a href="https://github.com/HenrikBengtsson/future"><code>future</code></a>.) However, <a href="https://github.com/HenrikBengtsson/future"><code>future</code></a> is more accessible: it does not require <a href="http://zeromq.org">ZeroMQ</a>, it supports parallel computing on Windows, it can work with more restrictive wall time limits on clusters, and it <a href="https://github.com/wlandau/drake-examples/tree/master/Docker-psock">can deploy targets to Docker images</a> (<code>drake_example(&quot;Docker-psock&quot;)</code>).</p>
</div>
<div id="the-clustermq-backend" class="section level2">
<h2><span class="header-section-number">10.4</span> The <code>clustermq</code> backend</h2>
<div id="persistent-workers" class="section level3">
<h3><span class="header-section-number">10.4.1</span> Persistent workers</h3>
<p>The <code>make(parallelism = &quot;clustermq&quot;, jobs = 2)</code> launches 2 parallel <em>persistent workers</em>. The master process assigns targets to workers, and the workers simultaneously traverse the dependency graph.</p>
<script src="https://fast.wistia.com/embed/medias/ycczhxwkjw.jsonp" async></script>
<script src="https://fast.wistia.com/assets/external/E-v1.js" async></script>
<div class="wistia_responsive_padding" style="padding:56.21% 0 0 0;position:relative;">
<div class="wistia_responsive_wrapper" style="height:100%;left:0;position:absolute;top:0;width:100%;">
<div class="wistia_embed wistia_async_ycczhxwkjw videoFoam=true" style="height:100%;position:relative;width:100%">
<div class="wistia_swatch" style="height:100%;left:0;opacity:0;overflow:hidden;position:absolute;top:0;transition:opacity 200ms;width:100%;">
<img src="https://fast.wistia.com/embed/medias/ycczhxwkjw/swatch" style="filter:blur(5px);height:100%;object-fit:contain;width:100%;" alt="" onload="this.parentNode.style.opacity=1;" />
</div>
</div>
</div>
</div>
</div>
<div id="installation-1" class="section level3">
<h3><span class="header-section-number">10.4.2</span> Installation</h3>
<p>You must first install <a href="http://zeromq.org/">ZeroMQ</a> (<a href="http://zeromq.org/intro:get-the-software">instructions here</a>) and then install the <a href="https://github.com/mschubert/clustermq"><code>clustermq</code></a> package.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;clustermq&quot;</span>) <span class="co"># CRAN release</span>
<span class="co"># Alternatively, install the GitHub development version.</span>
devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;mschubert/clustermq&quot;</span>, <span class="dt">ref =</span> <span class="st">&quot;develop&quot;</span>)</code></pre>
</div>
<div id="on-your-local-machine" class="section level3">
<h3><span class="header-section-number">10.4.3</span> On your local machine</h3>
<p>To run your targets in parallel over the cores of your local machine, set the global option below and run <code>make()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">clustermq.scheduler =</span> <span class="st">&quot;multicore&quot;</span>)
<span class="kw">make</span>(plan, <span class="dt">parallelism =</span> <span class="st">&quot;clustermq&quot;</span>, <span class="dt">jobs =</span> <span class="dv">2</span>)</code></pre>
</div>
<div id="on-a-cluster" class="section level3">
<h3><span class="header-section-number">10.4.4</span> On a cluster</h3>
<p>Set the <a href="https://github.com/mschubert/clustermq"><code>clustermq</code></a> global options to register your computing resources. For <a href="https://slurm.schedmd.com/slurmd.html">SLURM</a>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">clustermq.scheduler =</span> <span class="st">&quot;slurm&quot;</span>, <span class="dt">clustermq.template =</span> <span class="st">&quot;slurm_clustermq.tmpl&quot;</span>)</code></pre>
<p>Here, <code>slurm_clustermq.tmpl</code> is a <a href="https://github.com/ropensci/drake/tree/master/inst/hpc_template_files">template file</a> with configuration details. Use <code>drake_hpc_template_file()</code> to write one of the available examples.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">drake_hpc_template_file</span>(<span class="st">&quot;slurm_clustermq.tmpl&quot;</span>) <span class="co"># Write the file slurm_clustermq.tmpl.</span></code></pre>
<p>After modifying <code>slurm_clustermq.tmpl</code> by hand to meet your needs, call <code>make()</code> as usual.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">make</span>(plan, <span class="dt">parallelism =</span> <span class="st">&quot;clustermq&quot;</span>, <span class="dt">jobs =</span> <span class="dv">4</span>)</code></pre>
</div>
</div>
<div id="the-future-backend" class="section level2">
<h2><span class="header-section-number">10.5</span> The <code>future</code> backend</h2>
<div id="transient-workers" class="section level3">
<h3><span class="header-section-number">10.5.1</span> Transient workers</h3>
<p><code>make(parallelism = &quot;future&quot;, jobs = 2)</code> launches <em>transient workers</em> to build your targets. When a target is ready to build, the master process creates a fresh worker to build it, and the worker terminates when the target is done. <code>jobs = 2</code> means that at most 2 transient workers are allowed to run at a given time.</p>
<script src="https://fast.wistia.com/embed/medias/340yvlp515.jsonp" async></script>
<script src="https://fast.wistia.com/assets/external/E-v1.js" async></script>
<div class="wistia_responsive_padding" style="padding:56.21% 0 0 0;position:relative;">
<div class="wistia_responsive_wrapper" style="height:100%;left:0;position:absolute;top:0;width:100%;">
<div class="wistia_embed wistia_async_340yvlp515 videoFoam=true" style="height:100%;position:relative;width:100%">
<div class="wistia_swatch" style="height:100%;left:0;opacity:0;overflow:hidden;position:absolute;top:0;transition:opacity 200ms;width:100%;">
<img src="https://fast.wistia.com/embed/medias/340yvlp515/swatch" style="filter:blur(5px);height:100%;object-fit:contain;width:100%;" alt="" onload="this.parentNode.style.opacity=1;" />
</div>
</div>
</div>
</div>
<p><br></p>
</div>
<div id="installation-2" class="section level3">
<h3><span class="header-section-number">10.5.2</span> Installation</h3>
<p>Install the <a href="https://github.com/HenrikBengtsson/future"><code>future</code></a> package.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;future&quot;</span>) <span class="co"># CRAN release</span>
<span class="co"># Alternatively, install the GitHub development version.</span>
devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;HenrikBengtsson/future&quot;</span>, <span class="dt">ref =</span> <span class="st">&quot;develop&quot;</span>)</code></pre>
<p>If you intend to use a cluster, be sure to install the <a href="https://github.com/HenrikBengtsson/future.batchtools"><code>future.batchtools</code></a> package too. The <a href="https://github.com/HenrikBengtsson/future"><code>future</code></a> ecosystem contains even more packages that extend <a href="https://github.com/HenrikBengtsson/future"><code>future</code></a>’s parallel computing functionality, such as <a href="https://github.com/HenrikBengtsson/future.callr"><code>future.callr</code></a>.</p>
</div>
<div id="on-your-local-machine-1" class="section level3">
<h3><span class="header-section-number">10.5.3</span> On your local machine</h3>
<p>First, select a <a href="https://github.com/HenrikBengtsson/future"><code>future</code></a> plan to tell <a href="https://github.com/HenrikBengtsson/future"><code>future</code></a> how to create the workers. See <a href="https://github.com/HenrikBengtsson/future#controlling-how-futures-are-resolved">this table</a> for descriptions of the core options.</p>
<pre class="sourceCode r"><code class="sourceCode r">future<span class="op">::</span><span class="kw">plan</span>(future<span class="op">::</span>multiprocess) </code></pre>
<p>Next, run <code>make()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">make</span>(plan, <span class="dt">parallelism =</span> <span class="st">&quot;future&quot;</span>, <span class="dt">jobs =</span> <span class="dv">2</span>)</code></pre>
</div>
<div id="on-a-cluster-1" class="section level3">
<h3><span class="header-section-number">10.5.4</span> On a cluster</h3>
<p>Install the <a href="https://github.com/HenrikBengtsson/future.batchtools"><code>future.batchtools</code></a> package and use <a href="https://github.com/HenrikBengtsson/future.batchtools#choosing-batchtools-backend">this list</a> to select a <a href="https://github.com/HenrikBengtsson/future"><code>future</code></a> plan that matches your resources. You will also need a compatible <a href="https://github.com/mllg/batchtools/tree/master/inst/templates">template file</a> with configuration details. As with <a href="https://github.com/mschubert/clustermq"><code>clustermq</code></a>, <code>drake</code> can generate some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">drake_hpc_template_file</span>(<span class="st">&quot;slurm_batchtools.tmpl&quot;</span>) <span class="co"># Edit by hand.</span></code></pre>
<p>Next, register the template file with a plan.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(future.batchtools)
future<span class="op">::</span><span class="kw">plan</span>(batchtools_slurm, <span class="dt">template =</span> <span class="st">&quot;slurm_batchtools.tmpl&quot;</span>)</code></pre>
<p>Finally, run <code>make()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">make</span>(plan, <span class="dt">parallelism =</span> <span class="st">&quot;future&quot;</span>, <span class="dt">jobs =</span> <span class="dv">2</span>)</code></pre>
</div>
</div>
<div id="advanced-options" class="section level2">
<h2><span class="header-section-number">10.6</span> Advanced options</h2>
<div id="memory" class="section level3">
<h3><span class="header-section-number">10.6.1</span> Memory</h3>
<p>By default, <code>make()</code> keeps targets in memory during runtime. Some targets are dependencies of other targets downstream, while others may be no longer actually need to be in memory. The <code>memory_strategy</code> argument to <code>make()</code> allows you to choose the tradeoff that best suits your project. Options:</p>
<ul>
<li><code>&quot;speed&quot;</code>: Once a target is loaded in memory, just keep it there. This choice maximizes speed and hogs memory.</li>
<li><code>&quot;memory&quot;</code>: Just before building each new target, unload everything from memory except the target’s direct dependencies. This option conserves memory, but it sacrifices speed because each new target needs to reload any previously unloaded targets from storage.</li>
<li><code>&quot;lookahead&quot;</code>: Just before building each new target, search the dependency graph to find targets that will not be needed for the rest of the current <code>make()</code> session. In this mode, targets are only in memory if they need to be loaded, and we avoid superfluous reads from the cache. However, searching the graph takes time, and it could even double the computational overhead for large projects.</li>
</ul>
</div>
<div id="storage" class="section level3">
<h3><span class="header-section-number">10.6.2</span> Storage</h3>
<p>In <code>make(caching = &quot;master&quot;)</code>, the workers send the targets to the master process, and the master process stores them one by one in the cache. <code>caching = &quot;master&quot;</code> is compatible with all <a href="https://github.com/richfitz/storr"><code>storr</code></a> cache formats, including the more esoteric ones like <code>storr_dbi()</code> and <code>storr_environment()</code>.</p>
<p>In <code>make(caching = &quot;worker&quot;)</code>, the parallel workers are responsible for writing the targets to the cache. Some output-heavy projects can benefit from this form of parallelism. However, it can sometimes add slowness on clusters due to lag from network file systems. And there are additional restrictions:</p>
<ul>
<li>All the workers must have the same file system and the same working directory as the master process.</li>
<li>Only the default <code>storr_rds()</code> cache may be used. Other formats like <code>storr_dbi()</code> and <code>storr_environment()</code> cannot accommodate parallel cache operations.</li>
</ul>
<p>See the <a href="store.html#store">storage chapter</a> for details.</p>
</div>
<div id="the-template-argument-for-persistent-workers" class="section level3">
<h3><span class="header-section-number">10.6.3</span> The <code>template</code> argument for persistent workers</h3>
<p>For more control and flexibility in the <a href="https://github.com/mschubert/clustermq"><code>clustermq</code></a> backend, you can parameterize your template file and use the <code>template</code> argument of <code>make()</code>. For example, suppose you want to programatically set the number of “slots” (basically cores) per job on an <a href="http://gridscheduler.sourceforge.net/htmlman/manuals.html">SGE system</a> (<code>clustermq</code> guide to SGE setup <a href="https://github.com/mschubert/clustermq/wiki/SGE">here</a>). Begin with a parameterized template file <code>sge_clustermq.tmpl</code> with a custom <code>n_slots</code> placeholder.</p>
<pre><code># File: sge_clustermq.tmpl
# Modified from https://github.com/mschubert/clustermq/wiki/SGE
#$ -N {{ job_name }}               # job name
#$ -t 1-{{ n_jobs }}               # submit jobs as array
#$ -j y                            # combine stdout/error in one file
#$ -o {{ log_file | /dev/null }}   # output file
#$ -cwd                            # use pwd as work dir
#$ -V                              # use environment variable
#$ -pe smp {{ n_slots | 1 }}       # request n_slots cores per job
module load R
ulimit -v $(( 1024 * {{ memory | 4096 }} ))
R --no-save --no-restore -e &#39;clustermq:::worker(&quot;{{ master }}&quot;)&#39;</code></pre>
<p>Then when you run <code>make()</code>, use the <code>template</code> argument to set <code>n_slots</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">clustermq.scheduler =</span> <span class="st">&quot;sge&quot;</span>, <span class="dt">clustermq.template =</span> <span class="st">&quot;sge_clustermq.tmpl&quot;</span>)
<span class="kw">library</span>(drake)
<span class="kw">load_mtcars_example</span>()
<span class="kw">make</span>(
  my_plan,
  <span class="dt">parallelism =</span> <span class="st">&quot;clustermq&quot;</span>,
  <span class="dt">jobs =</span> <span class="dv">16</span>,
  <span class="dt">template =</span> <span class="kw">list</span>(<span class="dt">n_slots =</span> <span class="dv">4</span>) <span class="co"># Request 4 cores per persistent worker.</span>
)</code></pre>
<p>Custom placeholders like <code>n_slots</code> are processed with the <a href="https://github.com/Bart6114/infuser"><code>infuser</code></a> package.</p>
</div>
<div id="the-resources-column-for-transient-workers" class="section level3">
<h3><span class="header-section-number">10.6.4</span> The <code>resources</code> column for transient workers</h3>
<p>Different targets may need different resources. For example,</p>
<pre class="sourceCode r"><code class="sourceCode r">plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(
  <span class="dt">data =</span> <span class="kw">download_data</span>(),
  <span class="dt">model =</span> <span class="kw">big_machine_learning_model</span>(data)
)</code></pre>
<p>The <code>model</code> needs a GPU and multiple CPU cores, and the <code>data</code> only needs the bare minimum resources. Declare these requirements in a new list column of the <code>plan</code>. Here, each element is a named list for the <code>resources</code> argument of <code>future::future()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">plan<span class="op">$</span>resources &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="kw">list</span>(<span class="dt">cores =</span> <span class="dv">1</span>, <span class="dt">gpus =</span> <span class="dv">0</span>),
  <span class="kw">list</span>(<span class="dt">cores =</span> <span class="dv">4</span>, <span class="dt">gpus =</span> <span class="dv">1</span>)
)</code></pre>
<p>Next, plug your resources into the <a href="https://CRAN.R-project.org/package=brew"><code>brew</code></a> patterns of your <a href="https://github.com/mllg/batchtools"><code>batchtools</code></a> template file. The following <code>sge_batchtools.tmpl</code> file shows how to do it, but the file itself probably requires modification before it will work with your own machine.</p>
<pre><code>#!/bin/bash
#$ -cwd
#$ -j y
#$ -o &lt;%= log.file %&gt;
#$ -V
#$ -N &lt;%= job.name %&gt;
#$ -pe smp &lt;%= resources[[&quot;cores&quot;]] %&gt; # CPU cores
#$ -l gpu=&lt;%= resources[[&quot;gpus&quot;]] %&gt;   # GPUs.
Rscript -e &#39;batchtools::doJobCollection(&quot;&lt;%= uri %&gt;&quot;)&#39;
exit 0</code></pre>
<p>Finally, register the template file and run your project.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(drake)
<span class="kw">library</span>(future.batchtools)
future<span class="op">::</span><span class="kw">plan</span>(batchtools_sge, <span class="dt">template =</span> <span class="st">&quot;sge_batchtools.tmpl&quot;</span>)
<span class="kw">make</span>(plan, <span class="dt">parallelism =</span> <span class="st">&quot;future&quot;</span>, <span class="dt">jobs =</span> <span class="dv">2</span>)</code></pre>
</div>
<div id="custom-job-schedulers" class="section level3">
<h3><span class="header-section-number">10.6.5</span> Custom job schedulers</h3>
<p>It is possible to supply a custom job scheduler function to the <code>parallelism</code> argument of <code>make()</code>. The <code>backend_future_lapply_staged()</code> function from the <a href="https://github.com/wlandau/drake.future.lapply.staged"><code>drake.future.lapply.staged</code></a> package is an example. You might consider writing your own such function if you wish to</p>
<ol style="list-style-type: decimal">
<li>Experiment with a more efficient job scheduler before proposing a patch to core <code>drake</code>, or</li>
<li>Aggressively optimize <code>drake</code> for your specialized computing resources.</li>
</ol>
<p>This feature is very advanced, and you should only attempt it in production if you really know what you are doing. Use at your own risk.</p>
</div>
<div id="parallel-computing-within-targets" class="section level3">
<h3><span class="header-section-number">10.6.6</span> Parallel computing <em>within</em> targets</h3>
<p>You may wish to invoke parallel computing within individual targets, e.g.</p>
<pre class="sourceCode r"><code class="sourceCode r">plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(
  <span class="dt">a =</span> parallel<span class="op">::</span><span class="kw">mclapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, sqrt, <span class="dt">mc.cores =</span> <span class="dv">4</span>),
  <span class="dt">b =</span> parallel<span class="op">::</span><span class="kw">mclapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, sqrt, <span class="dt">mc.cores =</span> <span class="dv">2</span>)
)</code></pre>
<p>or even</p>
<pre class="sourceCode r"><code class="sourceCode r">plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(
  <span class="dt">a =</span> <span class="kw">target</span>(
    parallel<span class="op">::</span><span class="kw">mclapply</span>(
      <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>,
      sqrt,
      <span class="co"># You can change the # of cores without changing the command.</span>
      <span class="dt">mc.cores =</span> <span class="kw">from_plan</span>(<span class="st">&quot;cores&quot;</span>)
    ),
    <span class="dt">cores =</span> <span class="dv">4</span> <span class="co"># Changes to this number do not invalidate `a`.</span>
  ),
  <span class="dt">b =</span> <span class="kw">target</span>(
    parallel<span class="op">::</span><span class="kw">mclapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, sqrt, <span class="dt">mc.cores =</span> <span class="kw">from_plan</span>(<span class="st">&quot;cores&quot;</span>)),
    <span class="dt">cores =</span> <span class="dv">2</span>
  )
)</code></pre>
<p>Unfortunately, for reasons described <a href="https://github.com/ropensci/drake/issues/675">here</a> and <a href="https://stackoverflow.com/questions/54229295/parallelmclapply-adds-or-removes-bindings-to-the-global-environment-which-o">here</a>, <code>make(plan)</code> will fail in each case. Workarounds:</p>
<ul>
<li>Avoid <code>mclapply()</code>. <a href="https://davisvaughan.github.io/furrr/"><code>furrr::map()</code></a> and <code>parallel::parLapply()</code> are more dependable alternatives anyway. In the case of <a href="https://davisvaughan.github.io/furrr/"><code>furrr</code></a>, invoke <a href="https://github.com/HenrikBengtsson/future.callr"><code>future::plan(future.callr::callr)</code></a> or <code>future::plan(future::multisession)</code> first.</li>
<li>In <code>make()</code>, set the <code>lock_envir</code> argument to <code>FALSE</code>. This approach deactivates important reproducibility guardrails, so use with caution.</li>
<li>In <code>mclapply()</code>, set the <code>mc.set.seed</code> argument to <code>FALSE</code>. If your computations require pseudo-random numbers (<code>rnorm()</code>, <code>runif()</code>, etc.) you will need to manually set a different seed for each parallel process, e.g.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">parallel<span class="op">::</span><span class="kw">mclapply</span>(<span class="dt">X =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">mc.cores =</span> <span class="dv">4</span>, <span class="dt">FUN =</span> <span class="cf">function</span>(i) {
  <span class="kw">set.seed</span>(<span class="kw">sum</span>(.Random.seed) <span class="op">+</span><span class="st"> </span>i)
  <span class="co"># Do some work...</span>
})</code></pre>
</div>
<div id="hasty-mode" class="section level3">
<h3><span class="header-section-number">10.6.7</span> Hasty mode</h3>
<p>The <a href="https://github.com/wlandau/drake.hasty"><code>drake.hasty</code></a> package is a bare-bones spin-off of <code>drake</code>. It sacrifices reproducibility to aggressively boost speed when scheduling and executing your targets. It is not recommended for most serious production use cases, but it can useful for experimentation.</p>

</div>
</div>
</div>
<div style = "background: #1C356D; color: white; padding: 10px 10px 10px 25px; font-size: 1em; width: 100%;">
  Copyright Eli Lilly and Company
</div>
            </section>

          </div>
        </div>
      </div>
<a href="debug.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="triggers.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
